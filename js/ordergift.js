var _0x9ee9df=_0x4e4f;(function(_0x34c81a,_0x2f7417){var _0x5583fc=_0x4e4f,_0x4a71a5=_0x34c81a();while(!![]){try{var _0x11d379=parseInt(_0x5583fc(0x79))/0x1*(-parseInt(_0x5583fc(0x134))/0x2)+-parseInt(_0x5583fc(0x85))/0x3*(-parseInt(_0x5583fc(0x80))/0x4)+parseInt(_0x5583fc(0x141))/0x5+-parseInt(_0x5583fc(0xbe))/0x6*(-parseInt(_0x5583fc(0x9d))/0x7)+-parseInt(_0x5583fc(0x123))/0x8+parseInt(_0x5583fc(0xf2))/0x9*(parseInt(_0x5583fc(0x140))/0xa)+-parseInt(_0x5583fc(0xe1))/0xb;if(_0x11d379===_0x2f7417)break;else _0x4a71a5['push'](_0x4a71a5['shift']());}catch(_0x3eabd1){_0x4a71a5['push'](_0x4a71a5['shift']());}}}(_0x1f9b,0xc63d5));var dateString=new Date()['toLocaleString'](_0x9ee9df(0x15c),{'timeZone':_0x9ee9df(0xfa)}),today=new Date(),dd=String(today['getDate']())['padStart'](0x2,'0'),mm=String(today['getMonth']()+0x1)['padStart'](0x2,'0'),yyyy=today['getFullYear']()+0x21f,gID,gStatus,xMaxGift=0x0,xNewyearLimit=0x16,xOrderLimit=0xfa,xBMStatus=0x0,xSendZoneApprove=0x0,zBM_Address='',zBM_Phone='',zEmpID_Staff1='',zEmpName_Staff1='',zPhone_Staff1='',zEmpID_Staff2='',zEmpName_Staff2='',zPhone_Staff2='',zZoneMemoToBM='';$(document)[_0x9ee9df(0x105)](function(){var _0x241fac=_0x9ee9df;sessionStorage[_0x241fac(0x8c)](_0x241fac(0x162))==null&&(location['href']=_0x241fac(0xa2)),gID=getParameterByName('gid'),gStatus=getParameterByName(_0x241fac(0xcd)),Connect_DB(),dbNewyearData=firebase[_0x241fac(0x145)]()[_0x241fac(0x120)](_0x241fac(0xe0)),dbGiftStock=firebase[_0x241fac(0x145)]()[_0x241fac(0x120)]('Newyear2024_gift'),dbGiftOrder=firebase[_0x241fac(0x145)]()[_0x241fac(0x120)]('Newyear2024_order'),CheckBudget(),GetUserOrder(gID),LoadGiftStock();});function getParameterByName(_0x4cf57f,_0x5932ef){var _0x87e7a0=_0x9ee9df;str='';if(!_0x5932ef)_0x5932ef=window[_0x87e7a0(0xdd)][_0x87e7a0(0xeb)];_0x4cf57f=_0x4cf57f[_0x87e7a0(0x147)](/[\[\]]/g,'\x5c$&');var _0x3b0c3d=new RegExp(_0x87e7a0(0x165)+_0x4cf57f+_0x87e7a0(0x111)),_0x15d532=_0x3b0c3d['exec'](_0x5932ef);if(!_0x15d532)return null;if(!_0x15d532[0x2])return'';return decodeURIComponent(_0x15d532[0x2][_0x87e7a0(0x147)](/\+/g,'\x20'));}function LoadDetail(){var _0x1c7191=_0x9ee9df;dbNewyearData['where'](firebase[_0x1c7191(0x145)]['FieldPath'][_0x1c7191(0x11e)](),'==',gID)['get']()[_0x1c7191(0xc0)](_0x78087a=>{_0x78087a['forEach'](_0xaaf9d9=>{var _0x4f5314=_0x4e4f;xBMStatus=_0xaaf9d9[_0x4f5314(0x95)]()['BMStatus'],zBM_Address=_0xaaf9d9[_0x4f5314(0x95)]()[_0x4f5314(0x119)],zBM_Phone=_0xaaf9d9[_0x4f5314(0x95)]()[_0x4f5314(0x15a)],zEmpID_Staff1=_0xaaf9d9[_0x4f5314(0x95)]()[_0x4f5314(0xac)],zEmpName_Staff1=_0xaaf9d9[_0x4f5314(0x95)]()['EmpName_Staff1'],zPhone_Staff1=_0xaaf9d9['data']()[_0x4f5314(0xa6)],zEmpID_Staff2=_0xaaf9d9[_0x4f5314(0x95)]()['EmpID_Staff2'],zEmpName_Staff2=_0xaaf9d9[_0x4f5314(0x95)]()[_0x4f5314(0x16a)],zPhone_Staff2=_0xaaf9d9[_0x4f5314(0x95)]()['Phone_Staff2'],zZoneMemoToBM=_0xaaf9d9[_0x4f5314(0x95)]()[_0x4f5314(0x9b)];});});}function _0x4e4f(_0x59f38b,_0x1ddc54){var _0x1f9b4d=_0x1f9b();return _0x4e4f=function(_0x4e4fb7,_0x1513ef){_0x4e4fb7=_0x4e4fb7-0x76;var _0x6fe6dc=_0x1f9b4d[_0x4e4fb7];return _0x6fe6dc;},_0x4e4f(_0x59f38b,_0x1ddc54);}var xBMAllocated=0x0,xBMEmpID='',xBMName='',xBranchName='',xZone='',xRH='';function CheckBudget(){var _0x2dd569=_0x9ee9df,_0x5ee0bf='',_0x5d7b78='';_0x5ee0bf+='<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22margin-top:20px;\x20background-color:\x20#fff;\x22>',_0x5ee0bf+=_0x2dd569(0x76),_0x5ee0bf+=_0x2dd569(0xca),dbNewyearData['where'](firebase['firestore']['FieldPath'][_0x2dd569(0x11e)](),'==',gID)[_0x2dd569(0x109)]()['then'](_0x1e4b4b=>{var _0x36ca81=_0x2dd569;_0x1e4b4b[_0x36ca81(0xf5)](_0x5323bc=>{var _0x24432c=_0x36ca81;xBMStatus=_0x5323bc[_0x24432c(0x95)]()[_0x24432c(0x14e)];if(_0x5323bc[_0x24432c(0x95)]()['BMStatus']==0x0)xMsg=_0x24432c(0xe6),_0x5d7b78='<font\x20color=\x27#555555\x27><b>ยังไม่ได้สั่งจอง</b></font>';else{if(_0x5323bc['data']()[_0x24432c(0x14e)]==0x1)xMsg='กำลัง<br>สั่งจอง',_0x5d7b78=_0x24432c(0x15e);else{if(_0x5323bc[_0x24432c(0x95)]()['BMStatus']==0x2)xMsg=_0x24432c(0x161),_0x5d7b78=_0x24432c(0xb8);else{if(_0x5323bc[_0x24432c(0x95)]()[_0x24432c(0x14e)]==0x3)xMsg=_0x24432c(0xb2),_0x5d7b78=_0x24432c(0x9e);else{if(_0x5323bc[_0x24432c(0x95)]()[_0x24432c(0x14e)]==0x8)xMsg=_0x24432c(0xb3),_0x5d7b78=_0x24432c(0xf4);else _0x5323bc['data']()[_0x24432c(0x14e)]==0x9&&(xMsg=_0x24432c(0x8e),_0x5d7b78=_0x24432c(0x12c));}}}}xBMEmpID=_0x5323bc[_0x24432c(0x95)]()['BMEmpID'],xBMName=_0x5323bc[_0x24432c(0x95)]()[_0x24432c(0xa1)],xBranchName=_0x5323bc[_0x24432c(0x95)]()[_0x24432c(0x81)]+'\x20('+_0x5323bc[_0x24432c(0x95)]()[_0x24432c(0xc6)]+')',xZone=_0x5323bc['data']()[_0x24432c(0xe4)],xRH=_0x5323bc[_0x24432c(0x95)]()[_0x24432c(0xbd)],_0x5ee0bf+='<tr>',_0x5ee0bf+=_0x24432c(0xcf),_0x5ee0bf+=_0x24432c(0x90)+_0x5323bc[_0x24432c(0x95)]()['BranchName']+'\x20('+_0x5323bc[_0x24432c(0x95)]()[_0x24432c(0xc6)]+_0x24432c(0x167),_0x5ee0bf+=_0x24432c(0x9f),_0x5ee0bf+=_0x24432c(0x90)+_0x5323bc['data']()[_0x24432c(0xa1)]+_0x24432c(0x16e),_0x5ee0bf+=_0x24432c(0xed),_0x5ee0bf+=_0x24432c(0x90)+_0x5d7b78+_0x24432c(0x16e),_0x5ee0bf+=_0x24432c(0xee),_0x5ee0bf+='<td\x20style=\x22text-align:\x20center;background:#c4d0e2;\x22><b>'+numberWithCommas(_0x5323bc['data']()[_0x24432c(0xab)])+_0x24432c(0xec),_0x5ee0bf+=_0x24432c(0xa4),_0x5ee0bf+=_0x24432c(0x90)+numberWithCommas(_0x5323bc[_0x24432c(0x95)]()[_0x24432c(0x7e)])+'\x20บาท</b></td></tr>',xBMAllocated=_0x5323bc[_0x24432c(0x95)]()['BMAllocated'];}),_0x5ee0bf+=_0x36ca81(0x169),_0x5ee0bf+='<div\x20class=\x22clr\x22></div>',$(_0x36ca81(0x11c))[_0x36ca81(0xa9)](_0x5ee0bf);});}var GetOrderArr=[];function GetUserOrder(_0x5648c8){var _0x5bd5ec=_0x9ee9df,_0x47e696=0x0;dbGiftOrder[_0x5bd5ec(0x10f)](_0x5bd5ec(0x168),'==',_0x5648c8)[_0x5bd5ec(0x109)]()[_0x5bd5ec(0xc0)](_0x538767=>{var _0x3f852d=_0x5bd5ec;_0x538767[_0x3f852d(0xf5)](_0x4424c3=>{var _0x3fb7b1=_0x3f852d;GetOrderArr[_0x3fb7b1(0x154)]({'RefGift':_0x4424c3[_0x3fb7b1(0x95)]()[_0x3fb7b1(0x115)],'StockName':_0x4424c3[_0x3fb7b1(0x95)]()[_0x3fb7b1(0xaf)],'OrderGift':_0x4424c3['data']()[_0x3fb7b1(0xa0)],'ID':_0x4424c3['id']});});});}var xCheckOrder=0x0,xCountRec=0x0,xSumAllPrice=0x0,xSumUnitPrice=0x0,xTotalUnitPrice=0x0,xBalance=0x0;function LoadGiftStock(){var _0x2507bd=_0x9ee9df;LoadDetail();var _0x72a644='',_0x258294=0x0,_0x576024=0x0;xSumAllPrice=0x0,xSumUnitPrice=0x0,xMaxGift=0x0,xCalSell=0x0,_0x72a644+=_0x2507bd(0xb7),_0x72a644+=_0x2507bd(0x76),_0x72a644+=_0x2507bd(0x136),dbGiftStock[_0x2507bd(0x10f)](_0x2507bd(0x132),'==',0x1)[_0x2507bd(0xf7)](_0x2507bd(0xd3),_0x2507bd(0x12d))['orderBy']('StockOrder',_0x2507bd(0x12d))['get']()[_0x2507bd(0xc0)](_0x4d4705=>{var _0x2ae71d=_0x2507bd;_0x4d4705[_0x2ae71d(0xf5)](_0x2734ef=>{var _0x20e2b8=_0x2ae71d;const _0x3a1e38=GetOrderArr[_0x20e2b8(0x13e)](_0x25a6c9=>{var _0x1dffcd=_0x20e2b8;return _0x25a6c9[_0x1dffcd(0x115)]===_0x2734ef['id'];});xResults=0x0,xCheckLine=0x0;_0x3a1e38[0x0]!=undefined&&(xResults=_0x3a1e38[0x0][_0x20e2b8(0xa0)],xCheckOrder=parseFloat(xCheckOrder)+parseFloat(_0x3a1e38[0x0][_0x20e2b8(0xa0)]));_0x72a644+=_0x20e2b8(0x16c)+(_0x258294+0x1)+_0x20e2b8(0x94)+_0x2734ef['id']+_0x20e2b8(0x10a),_0x72a644+=_0x20e2b8(0xcc)+_0x2734ef['id']+_0x20e2b8(0xd4)+_0x2734ef['data']()[_0x20e2b8(0xaf)]+'</b></font></div>',_0x72a644+=_0x20e2b8(0xda),_0x72a644+=_0x20e2b8(0xf3),_0x72a644+=_0x20e2b8(0x135)+_0x258294+'\x22\x20value=\x22'+xResults+_0x20e2b8(0x150);if(_0x2734ef[_0x20e2b8(0x95)]()[_0x20e2b8(0xd5)]==0x1)for(let _0x4b06c2=0x0;_0x4b06c2<xNewyearLimit;_0x4b06c2++){_0x4b06c2==0x0?_0x72a644+=_0x20e2b8(0xba):xResults==_0x4b06c2*0x32?(xCheckLine=0x1,_0x72a644+=_0x20e2b8(0xfd)+_0x4b06c2+_0x20e2b8(0x110)+_0x3a1e38[0x0][_0x20e2b8(0xa0)]+_0x20e2b8(0x126)+_0x3a1e38[0x0][_0x20e2b8(0xa0)]+_0x20e2b8(0x160)):_0x72a644+=_0x20e2b8(0xfd)+_0x4b06c2+_0x20e2b8(0x110)+_0x4b06c2*0x32+'\x22>'+_0x4b06c2*0x32+_0x20e2b8(0x160);}else{if(_0x2734ef[_0x20e2b8(0x95)]()['StockView']==0x2)for(let _0x3b1c75=0x0;_0x3b1c75<xOrderLimit+0x1;_0x3b1c75++){_0x3b1c75==0x0?_0x72a644+=_0x20e2b8(0xba):xResults==_0x3b1c75?(xCheckLine=0x1,_0x72a644+='<option\x20onchange=\x22CalGift('+_0x3b1c75+_0x20e2b8(0x110)+_0x3a1e38[0x0][_0x20e2b8(0xa0)]+'\x22\x20selected>'+_0x3a1e38[0x0][_0x20e2b8(0xa0)]+'\x20ชิ้น</option>'):_0x72a644+=_0x20e2b8(0xfd)+_0x3b1c75+_0x20e2b8(0x110)+_0x3b1c75+'\x22>'+_0x3b1c75+'\x20ชิ้น</option>';}}xCalSell+=xResults*_0x2734ef[_0x20e2b8(0x95)]()[_0x20e2b8(0x13a)],_0x72a644+='</select></div>',_0x72a644+='<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>ราคาต่อชิ้น</div><input\x20type=\x22text\x22\x20id=\x22UnitPrice'+_0x258294+_0x20e2b8(0x164)+_0x2734ef['data']()[_0x20e2b8(0x13a)]+_0x20e2b8(0x108),_0x72a644+=_0x20e2b8(0x153)+_0x258294+_0x20e2b8(0x164)+xResults*_0x2734ef['data']()[_0x20e2b8(0x13a)]+_0x20e2b8(0x133),_0x72a644+=_0x20e2b8(0x130),_0x72a644+=_0x20e2b8(0x138),_0x72a644+='<input\x20type=\x22text\x22\x20id=\x22OrderGiftRefID'+_0x258294+_0x20e2b8(0x164)+_0x2734ef['id']+'\x22\x20hidden>',_0x72a644+=_0x20e2b8(0xbf)+_0x258294+_0x20e2b8(0x164)+_0x2734ef[_0x20e2b8(0x95)]()[_0x20e2b8(0xaf)]+_0x20e2b8(0x170),_0x258294++,xMaxGift++;}),_0x72a644+='</tbody></table></div>',_0x72a644+=_0x2ae71d(0x155),$(_0x2ae71d(0xdb))[_0x2ae71d(0xa9)](_0x72a644),CalGift();});}var xTotalPrice=0x0;function CalGift(){var _0x44fa92=_0x9ee9df,_0x5e32d2=0x0,_0x5407ac='',_0x58a0a5=0x0,_0x16022f=parseFloat(document['getElementById']('UnitPrice0')['value']*document[_0x44fa92(0xd2)](_0x44fa92(0xef))[_0x44fa92(0x139)]),_0x100db8=parseFloat(document[_0x44fa92(0xd2)]('UnitPrice1')[_0x44fa92(0x139)]*document[_0x44fa92(0xd2)]('OrderGiftID1')[_0x44fa92(0x139)]),_0x49f4c6=parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0xc7))[_0x44fa92(0x139)]*document[_0x44fa92(0xd2)](_0x44fa92(0xd6))['value']),_0x5a3d65=parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0x100))['value']*document['getElementById']('OrderGiftID3')[_0x44fa92(0x139)]),_0x2a4f7d=parseFloat(document[_0x44fa92(0xd2)]('UnitPrice4')[_0x44fa92(0x139)]*document[_0x44fa92(0xd2)]('OrderGiftID4')[_0x44fa92(0x139)]),_0x48007d=parseFloat(document[_0x44fa92(0xd2)]('UnitPrice5')[_0x44fa92(0x139)]*document[_0x44fa92(0xd2)](_0x44fa92(0xc1))[_0x44fa92(0x139)]),_0xd5bb3b=parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0xde))[_0x44fa92(0x139)]*document[_0x44fa92(0xd2)]('OrderGiftID6')[_0x44fa92(0x139)]),_0x98ab4d=parseFloat(document[_0x44fa92(0xd2)]('UnitPrice7')['value']*document[_0x44fa92(0xd2)](_0x44fa92(0x87))[_0x44fa92(0x139)]),_0x33a01c=parseFloat(document[_0x44fa92(0xd2)]('UnitPrice8')[_0x44fa92(0x139)]*document[_0x44fa92(0xd2)](_0x44fa92(0x104))[_0x44fa92(0x139)]),_0x44f236=parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0xb4))[_0x44fa92(0x139)]*document[_0x44fa92(0xd2)]('OrderGiftID9')[_0x44fa92(0x139)]),_0x124b45=parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0x127))[_0x44fa92(0x139)]*document['getElementById'](_0x44fa92(0x122))[_0x44fa92(0x139)]),_0x35e057=parseFloat(document[_0x44fa92(0xd2)]('UnitPrice11')['value']*document[_0x44fa92(0xd2)](_0x44fa92(0x82))[_0x44fa92(0x139)]),_0x447ffd=parseFloat(document[_0x44fa92(0xd2)]('UnitPrice12')[_0x44fa92(0x139)]*document[_0x44fa92(0xd2)](_0x44fa92(0x159))['value']),_0x4636e0=parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0xc3))[_0x44fa92(0x139)]*document['getElementById']('OrderGiftID13')['value']),_0x5c44fc=parseFloat(document['getElementById'](_0x44fa92(0x88))[_0x44fa92(0x139)]*document[_0x44fa92(0xd2)](_0x44fa92(0xe9))[_0x44fa92(0x139)]),_0x1f9ede=parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0xf9))['value']*document['getElementById'](_0x44fa92(0x14d))[_0x44fa92(0x139)]),_0x400275=parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0x11b))[_0x44fa92(0x139)]*document[_0x44fa92(0xd2)](_0x44fa92(0x83))[_0x44fa92(0x139)]),_0x3e66c1=parseFloat(document[_0x44fa92(0xd2)]('UnitPrice17')[_0x44fa92(0x139)]*document[_0x44fa92(0xd2)](_0x44fa92(0x89))['value']),_0x3ac9fe=parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0xef))[_0x44fa92(0x139)])+parseFloat(document['getElementById'](_0x44fa92(0x13f))[_0x44fa92(0x139)])+parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0xd6))[_0x44fa92(0x139)])+parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0xc5))['value'])+parseFloat(document[_0x44fa92(0xd2)]('OrderGiftID4')[_0x44fa92(0x139)])+parseFloat(document[_0x44fa92(0xd2)]('OrderGiftID5')['value'])+parseFloat(document['getElementById'](_0x44fa92(0xf0))[_0x44fa92(0x139)]),_0x43f2f7=parseFloat(document['getElementById'](_0x44fa92(0x87))['value'])+parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0x104))['value'])+parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0xfe))['value'])+parseFloat(document[_0x44fa92(0xd2)]('OrderGiftID10')[_0x44fa92(0x139)])+parseFloat(document['getElementById']('OrderGiftID11')['value'])+parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0x159))[_0x44fa92(0x139)])+parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0xb5))[_0x44fa92(0x139)]),_0x462a58=parseFloat(document[_0x44fa92(0xd2)](_0x44fa92(0xe9))[_0x44fa92(0x139)])+parseFloat(document['getElementById'](_0x44fa92(0x14d))[_0x44fa92(0x139)])+parseFloat(document[_0x44fa92(0xd2)]('OrderGiftID16')[_0x44fa92(0x139)])+parseFloat(document[_0x44fa92(0xd2)]('OrderGiftID17')['value']);xTotalUnitPrice=_0x3ac9fe+_0x43f2f7+_0x462a58;var _0x38495c=parseFloat(_0x16022f)+parseFloat(_0x100db8)+parseFloat(_0x49f4c6)+parseFloat(_0x5a3d65)+parseFloat(_0x2a4f7d)+parseFloat(_0x48007d),_0x80bcde=parseFloat(_0xd5bb3b)+parseFloat(_0x98ab4d)+parseFloat(_0x33a01c)+parseFloat(_0x44f236)+parseFloat(_0x124b45)+parseFloat(_0x35e057),_0x4482a3=parseFloat(_0x447ffd)+parseFloat(_0x4636e0)+parseFloat(_0x5c44fc)+parseFloat(_0x1f9ede)+parseFloat(_0x400275)+parseFloat(_0x3e66c1);xTotalPrice=_0x38495c+_0x80bcde+_0x4482a3,xBalance=xBMAllocated-xTotalPrice,$(_0x44fa92(0xe5))['html'](numberWithCommas(_0x16022f)),$(_0x44fa92(0xff))[_0x44fa92(0xa9)](numberWithCommas(_0x100db8)),$(_0x44fa92(0xea))[_0x44fa92(0xa9)](numberWithCommas(_0x49f4c6)),$('#SumUnitPrice3')[_0x44fa92(0xa9)](numberWithCommas(_0x5a3d65)),$(_0x44fa92(0x158))[_0x44fa92(0xa9)](numberWithCommas(_0x2a4f7d)),$(_0x44fa92(0xb9))[_0x44fa92(0xa9)](numberWithCommas(_0x48007d)),$(_0x44fa92(0x16d))[_0x44fa92(0xa9)](numberWithCommas(_0xd5bb3b)),$('#SumUnitPrice7')[_0x44fa92(0xa9)](numberWithCommas(_0x98ab4d)),$(_0x44fa92(0x92))[_0x44fa92(0xa9)](numberWithCommas(_0x33a01c)),$(_0x44fa92(0x128))[_0x44fa92(0xa9)](numberWithCommas(_0x44f236)),$(_0x44fa92(0x113))[_0x44fa92(0xa9)](numberWithCommas(_0x124b45)),$('#SumUnitPrice11')[_0x44fa92(0xa9)](numberWithCommas(_0x35e057)),$('#SumUnitPrice12')[_0x44fa92(0xa9)](numberWithCommas(_0x447ffd)),$(_0x44fa92(0x117))[_0x44fa92(0xa9)](numberWithCommas(_0x4636e0)),$('#SumUnitPrice14')[_0x44fa92(0xa9)](numberWithCommas(_0x5c44fc)),$(_0x44fa92(0xa5))[_0x44fa92(0xa9)](numberWithCommas(_0x1f9ede)),$('#SumUnitPrice16')['html'](numberWithCommas(_0x400275)),$('#SumUnitPrice17')[_0x44fa92(0xa9)](numberWithCommas(_0x3e66c1)),_0x5407ac+='<div\x20class=\x22clr\x22></div>',_0x5407ac+=_0x44fa92(0x15f),_0x5407ac+=_0x44fa92(0x143)+numberWithCommas(xBMAllocated)+_0x44fa92(0x9a),_0x5407ac+=_0x44fa92(0xd9)+numberWithCommas(xTotalPrice)+'\x22\x20style=\x22color:#fff;background:#0056ff;\x22></div></div>';xBalance>=0x0?_0x5407ac+='<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>ยอดงบคงเหลือ</div><input\x20type=\x22text\x22\x20value=\x22'+numberWithCommas(xBalance)+'\x22\x20style=\x22color:#fff;background:#13c33b;\x22></div></div>':_0x5407ac+=_0x44fa92(0x12a)+numberWithCommas(xBalance)+_0x44fa92(0x93);_0x5407ac+=_0x44fa92(0xf6),_0x5407ac+=_0x44fa92(0x155);var _0x5284be=xBMAllocated-xTotalPrice;if(xBMAllocated-xTotalPrice>=0x0){_0x5407ac+=_0x44fa92(0x112);if(xBMStatus==0x0||xBMStatus==0x1)xTotalUnitPrice!=0x0?(xTotalUnitPrice!=0x0&&(_0x5407ac+=_0x44fa92(0xe8)+gID+'\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ยกเลิก<br>รายการสั่งซื้อ</div>'),_0x5407ac+=_0x44fa92(0x152)+gID+_0x44fa92(0x11f)):(_0x5407ac+=_0x44fa92(0x8f),_0x5407ac+=_0x44fa92(0x163));else{if(xBMStatus==0x2)_0x5407ac+=_0x44fa92(0xb6)+gID+_0x44fa92(0xcb),_0x5407ac+='<div\x20class=\x22btn-z1\x22\x20onclick=\x22GotoOrder()\x22\x20style=\x22margin:10px\x2010px\x2020px\x20auto;min-width:100px;\x22>กลับไป<br>หน้าแรก</div>',_0x5407ac+=_0x44fa92(0xc4);else{if(xBMStatus==0x3)xTotalUnitPrice!=0x0&&(_0x5407ac+=_0x44fa92(0x152)+gID+_0x44fa92(0x11f),_0x5407ac+=_0x44fa92(0x10d)+zZoneMemoToBM+'</div>');else xBMStatus==0x9?(_0x5407ac+=_0x44fa92(0xdf)+gID+'\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายการสั่งซื้อ<br>ของขวัญปีใหม่</div>',_0x5407ac+=_0x44fa92(0x14b)):(_0x5407ac+='<div\x20class=\x22btn-z0\x22\x20onclick=\x22ViewOrder(\x27'+gID+'\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายละเอียด<br>รายการสั่งซื้อ</div>',_0x5407ac+='<div\x20style=\x22font-weight:600;\x22>รายการอยู่ระหว่างการขออนุมัติการสั่งจองของขวัญปีใหม่<br></div>');}}_0x5407ac+=_0x44fa92(0xf6);}else alert(_0x44fa92(0x9c)+numberWithCommas(xBMAllocated)+_0x44fa92(0xd8)+numberWithCommas(xTotalPrice)+_0x44fa92(0xe3)+numberWithCommas(_0x5284be)+'\x20บาท\x0aระบบจะไม่อนุญาตให้บันทึกรายการสั่งจอง'),_0x5407ac+=_0x44fa92(0xa8);_0x5407ac+=_0x44fa92(0x125)+xBMName+_0x44fa92(0x78)+xBranchName+_0x44fa92(0x10b),$(_0x44fa92(0xe2))[_0x44fa92(0xa9)](_0x5407ac);}function DisplayGift(_0xa75ec0){var _0x32b0f6=_0x9ee9df,_0x36c41c='';dbGiftStock[_0x32b0f6(0x10f)](firebase[_0x32b0f6(0x145)][_0x32b0f6(0x14c)][_0x32b0f6(0x11e)](),'==',_0xa75ec0)['get']()['then'](_0x76815e=>{var _0x512095=_0x32b0f6;_0x76815e[_0x512095(0xf5)](_0x57e20f=>{var _0x3523d6=_0x512095;_0x36c41c+=_0x3523d6(0x151),_0x36c41c+='<div><img\x20src=\x22'+_0x57e20f[_0x3523d6(0x95)]()['StockImg']+'\x22\x20style=\x22width:100%;margin-top:18px;margin-bottom:\x2010px;\x22></div></center>',_0x36c41c+=_0x3523d6(0x11d)+_0x57e20f['data']()[_0x3523d6(0xaf)]+_0x3523d6(0xf6),_0x36c41c+=_0x3523d6(0x13c)+_0x57e20f[_0x3523d6(0x95)]()['StockDetail']+_0x3523d6(0xf6),_0x36c41c+=_0x3523d6(0xc9)+_0x57e20f[_0x3523d6(0x95)]()[_0x3523d6(0x13a)]+_0x3523d6(0x148),_0x36c41c+='',_0x36c41c+='',_0x36c41c+='<div\x20class=\x22clr\x22></div>',_0x36c41c+='<div\x20class=\x22btn-t2\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:15px\x20auto\x2025px\x20auto;\x22>ปิดหน้าต่างนี้</div>';}),$('#DisplayGift')[_0x512095(0xa9)](_0x36c41c);}),document['getElementById'](_0x32b0f6(0x7f))[_0x32b0f6(0x12b)][_0x32b0f6(0x91)]=_0x32b0f6(0x16f);}function _0x1f9b(){var _0x4ae075=['16XQpdhf','BranchName','OrderGiftID11','OrderGiftID16','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;background:#73a0f4;\x22>สรุปรายการสั่งซื้อ</th>','928077eBnVGf','<center><div\x20class=\x22btn-t1\x22\x20onclick=\x22GotoOrder()\x22>ปิดหน้าต่างนี้</div></center>','OrderGiftID7','UnitPrice14','OrderGiftID17','txtPhone_Staff2','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>ยอดรวมการสั่งซื้อ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>','getItem','<div\x20style=\x22line-height:1.3;\x20text-align:left;\x20font-weight:600;\x22>สาขา\x20:\x20','โซนแจ้ง<br>อนุมัติ','<div\x20class=\x22btn-z0\x22\x20style=\x22margin:10px\x2010px\x2020px\x20auto;min-width:100px;\x22>กรุณาสั่ง<br>ของขวัญปีใหม่</div>','<td\x20style=\x22text-align:\x20center;background:#c4d0e2;\x22><b>','display','#SumUnitPrice8','\x22\x20style=\x22color:#fff;background:#ff0000;\x22></div></div>','<div\x20onclick=\x22DisplayGift(\x27','data','<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;background:#73a0f4;\x22>','id01','disabledbutton','length','\x22\x20style=\x22color:#fff;background:#002d63;\x22></div></div>','ZoneMemoToBM','ขณะนี้คุณได้ทำคำสั่งซื้อของขวัญปีใหม่\x0aจากงบประมาณที่ได้รับ\x20','7lZXlTI','<font\x20color=\x27#ff0000\x27><b>โซนแจ้งทบทวนใหม่</b></font>','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>BM</td>','OrderGift','BMName','index.html','none','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สั่งไปแล้ว</td>','#SumUnitPrice15','Phone_Staff1','doc','<div\x20class=\x22btn-t2\x22\x20onclick=location.href=\x22home.html\x22\x20type=\x22submit\x22\x20style=\x22margin-top:20px;\x22>ไม่บันทึกรายการ</div>','html','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณคงเหลือ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#0056ff;\x22>','BMAllocated','EmpID_Staff1','<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;\x22>','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>','StockName','</tbody></table>','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>โทรศัพท์ผู้จัดการสาขา</div><input\x20type=\x22text\x22\x20id=\x22txtBM_Phone\x22\x20value=\x22','โซนแจ้ง<br>ทบทวน','โซนแจ้ง<br>ยกเลิก','UnitPrice9','OrderGiftID13','<div\x20class=\x22btn-z0\x22\x20onclick=\x22ViewOrder(\x27','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;\x22>','<font\x20color=\x27#0056ff\x27><b>ส่งโซนอนุมัติ</b></font>','#SumUnitPrice5','<option\x20onchange=\x22CalGift(0)\x22\x20value=\x220\x22>รอการสั่ง</option>','</td></tr>','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>รวมยอดการสั่งจองของขวัญ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#31e85b;\x22>','EmpRH','1577586LsDegO','<input\x20type=\x22text\x22\x20id=\x22NameGift','then','OrderGiftID5','gID=','UnitPrice13','<div\x20style=\x22font-weight:600;\x22>รายการอยู่ระหว่างการขออนุมัติจากโซน<br></div>','OrderGiftID3','BranchID','UnitPrice2','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#e831e8;\x22>','<div\x20style=\x22font-weight:400;padding-top:10px;\x22>ราคาขายต่อชิ้น\x20<b>','<th\x20scope=\x22col\x22>รายการ</th><th\x20scope=\x22col\x22>รายละเอียด</th></tr></thead><tbody>','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายละเอียด<br>รายการสั่งซื้อ</div>','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;\x22><div\x20onclick=\x22DisplayGift(\x27','gStatus','log','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สาขา</td>','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;\x20margin-top:20px;\x22>','<th\x20scope=\x22col\x22>รายการ</th><th\x20scope=\x22col\x22>จำนวน</th><th\x20scope=\x22col\x22>ราคา</th></tr></thead><tbody>','getElementById','StockGroup','\x27)\x22><font\x20color=\x22#0056ff\x22><b>','StockView','OrderGiftID2','บันทึกรายการแก้ไขรายการ\x20','\x20บาท\x0aยอดสั่งของขวัญของคุณ\x20','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>จำนวนเงินที่สั่ง</div><input\x20type=\x22text\x22\x20value=\x22','<div\x20style=\x22margin-top:4px;\x22>','#DisplayGroup2','<center><div\x20class=\x22btn-t22a\x22\x20style=\x22margin:30px\x20auto\x2020px\x20auto;\x22><b>รายการสั่งซื้อของขวัญปีใหม่ของสาขา</b></div></center>','location','UnitPrice6','<div\x20class=\x22btn-z9\x22\x20onclick=\x22ViewOrder(\x27','Newyear2024_data','7104361OyCaAf','#TotalGift','\x20บาท\x0aคุณสั่งเกินไปแล้ว\x20','EmpZone','#SumUnitPrice0','คลิก<br>สั่งจอง','OrderGiftID','<div\x20class=\x22btn-z3\x22\x20onclick=\x22DeleteAllOrder(\x27','OrderGiftID14','#SumUnitPrice2','href','\x20บาท</b></td></tr>','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สถานะ</td>','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>งบสั่งจอง</td>','OrderGiftID0','OrderGiftID6','toFixed','42066NDgwXB','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>เลือกจำนวนชิ้น</div>','<font\x20color=\x27#ff0000\x27><b>โซนแจ้งขอยกเลิกการจอง</b></font>','forEach','</div>','orderBy','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกรหัสพนักงาน)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpID_Staff1\x22\x20value=\x22','UnitPrice15','Asia/Jakarta','delete','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>รวมทั้งหมด</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#31e85b;\x22>','<option\x20onchange=\x22CalGift(','OrderGiftID9','#SumUnitPrice1','UnitPrice3','#DisplaySaveGift','#idSendZoneApprove','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>นำส่งรายการสั่งซื้อให้โซนอนุมัติ</div>','OrderGiftID8','ready','#DisplayGift','<br>','\x22\x20readonly></div>','get','\x27)\x22><img\x20src=\x22./img/icon-02.png\x22\x20style=\x22width:20px;\x22></div></th>','</b></div>','txtEmpID_Staff2','<div\x20style=\x22font-weight:600;\x20color:#ff0000;line-height:1.2;\x22><font\x20color=\x22#000000\x22>โซนแจ้งทำการทบทวนการสั่งจองใหม่อีกครั้ง</font><br>','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกชื่อ-นามสกุล)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpName_Staff1\x22\x20value=\x22','where',')\x22\x20value=\x22','(=([^&#]*)|&|#|$)','<div\x20id=\x22ShowSaveData\x22\x20style=\x22display:block;margin-bottom:\x2020px;\x22>','#SumUnitPrice10','</td></tr></tbody></table>','RefGift','txtBM_Phone','#SumUnitPrice13','\x22\x20style=\x22text-align:left;\x22></div>','BM_Address','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกหมายเลขโทรศัพท์)</div><input\x20type=\x22text\x22\x20id=\x22txtPhone_Staff1\x22\x20value=\x22','UnitPrice16','#DisplayBudget','<div\x20style=\x22font-weight:600;\x22>','documentId','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>บันทึกดร๊าฟ<br>รายการสั่งซื้อ</div>','collection','id02','OrderGiftID10','9114008nIdrJU','add','<hr><div\x20style=\x22margin-top:-10px;text-align:left;padding-bottom:\x2010px;line-height:1.3;\x20padding-left:10px;\x22>BM\x20:\x20<b>','\x22\x20selected>','UnitPrice10','#SumUnitPrice9','</th>','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>ยอดงบคงเหลือ</div><input\x20type=\x22text\x22\x20value=\x22','style','<font\x20color=\x27#28c92a\x27><b>โซนอนุมัติเรียบร้อยแล้ว</b></font>','asc','\x27)\x22\x20style=\x22width:56%;margin:-10px\x20auto\x2020px\x20auto;display:none\x22\x20id=\x22idSendZoneApprove\x22>ส่งคำขอ<br>ให้โซนอนุมัติ</div>','update','</td>','</textarea></center></div>','StockStatus','\x22\x20readonly></div></div>','1616878pXLJTc','<select\x20name=\x22OrderGiftID\x22\x20onchange=\x22CalGift()\x22\x20id=\x22OrderGiftID','<th\x20scope=\x22col\x22>No.</th><th\x20scope=\x22col\x22>รายการของขวัญ</th></tr></thead><tbody>','คุณยังกรอกข้อมูลไม่ครบถ้วน','</tr>','value','PointRedeem','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;\x22>','<div\x20style=\x22font-weight:400;\x20text-align:left;\x20padding-top:10px;\x22>','home.html','filter','OrderGiftID1','1570WlyKmc','5856725gZwwGU','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>รายละเอียดเพิ่มเติม</div><div\x20class=\x22clr\x22></div>','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>งบประมาณที่ได้รับ</div><input\x20type=\x22text\x22\x20value=\x22','ระบบได้ทำการบันทึกรายการนี้เรียบร้อยแล้ว\x20หากไม่มีการแก้ไขรายการให้ทำการกดปุ่ม\x20ส่งคำขอให้โซนอนุมัติ\x20ซึ่งจะมีผลให้สาขาไม่สามารถทำการแก้ไขรายการได้แล้ว','firestore','<br>BM\x20:\x20','replace','\x20บาท</b></div>','txtBM_Address','txtPhone_Staff1','<div\x20style=\x22font-weight:600;\x20color:#0056ff;\x22>รายการของท่านได้รับการอนุมัติจากโซน\x20เรียบร้อยแล้ว<br></div>','FieldPath','OrderGiftID15','BMStatus','NameGift','\x22\x20class=\x22form-control\x22>','<center><div\x20class=\x22btn-t3\x22\x20style=\x22margin-top:25px;\x22><b>รายละเอียดของขวัญปีใหม่</b></div>','<div\x20class=\x22btn-z1\x22\x20onclick=\x22SaveOrder(\x27','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>จำนวนเงินที่ใช้</div><div\x20class=\x22box-order\x22\x20id=\x22SumUnitPrice','push','<div\x20class=\x22clr\x22></div>','ระบบได้ทำการลบรายการการสั่งจองของขวัญของคุณเรียบร้อยแล้ว','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกหมายเลขโทรศัพท์)</div><input\x20type=\x22text\x22\x20id=\x22txtPhone_Staff2\x22\x20value=\x22','#SumUnitPrice4','OrderGiftID12','BM_Phone','OrderGiftRefID','en-US','UnitPrice','<font\x20color=\x27#f68b1f\x27><b>อยู่ระหว่างการสั่งจอง</b></font>','</div><div\x20style=\x22margin-top:30px;padding-top:20px;margin-left:3px;\x22>','\x20ชิ้น</option>','ส่งโซน<br>ขออนุมัติ','EmpID_Newyear','<div\x20class=\x22btn-z1\x22\x20onclick=\x22GotoOrder()\x22\x20style=\x22margin:10px\x2010px\x2020px\x20auto;min-width:100px;\x22>กลับไป<br>หน้าแรก</div>','\x22\x20value=\x22','[?&]','txtEmpID_Staff1',')</b></td></tr>','RefID','</tbody></table></div>','EmpName_Staff2','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกรหัสพนักงาน)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpID_Staff2\x22\x20value=\x22','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20center;\x22>','#SumUnitPrice6','</b></td></tr>','block','\x22\x20hidden>','<thead><tr\x20style=\x22text-align:\x20center;background-color:\x20#93a3c1;\x22>','<div\x20class=\x22btn-z0\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>ทำการแก้ไข<br>ใหม่อีกครั้ง</div>','</b><br>Branch\x20:\x20<b>','1qqfeKO','split','\x27)\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>บันทึกดร๊าฟ<br>ก่อนส่งโซน</div>','<div\x20class=\x22btn-z3\x22\x20onclick=\x22SaveToZone(\x27','ShowNav','UseBudget','id03'];_0x1f9b=function(){return _0x4ae075;};return _0x1f9b();}function DeleteAllOrder(_0x46caba){var _0x1ca618=_0x9ee9df;dbGiftOrder[_0x1ca618(0x10f)](_0x1ca618(0x168),'==',_0x46caba)[_0x1ca618(0x109)]()[_0x1ca618(0xc0)](_0x5ef0d2=>{var _0xc41477=_0x1ca618;_0x5ef0d2[_0xc41477(0xf5)](_0x398670=>{var _0x1c1903=_0xc41477;dbGiftOrder[_0x1c1903(0xa7)]()[_0x1c1903(0xfb)](),DeleteRefID(_0x398670['id']);}),console[_0xc41477(0xce)](_0xc41477(0xc2)+gID);var _0x5781e1=0x3e8;setTimeout(function(){dbNewyearData['doc'](gID)['update']({'BMStatus':0x0,'TotalOrders':0x0,'UseBudget':0x0,'BMBalance':0x0});},_0x5781e1);var _0x56edcd=0x7d0;setTimeout(function(){var _0x4215d9=_0xc41477;alert(_0x4215d9(0x156)),location[_0x4215d9(0xeb)]='ordergift.html?gid='+gID;},_0x56edcd);});}function DeleteRefID(_0x368384){var _0x5a3fa9=_0x9ee9df;dbGiftOrder[_0x5a3fa9(0xa7)](_0x368384)[_0x5a3fa9(0xfb)](),console[_0x5a3fa9(0xce)](_0x368384);}function ViewOrder(_0x4d0419){var _0x34e72e=_0x9ee9df,_0xab112='',_0x1198ff=0x0,_0x16bceb=0x0;_0xab112+=_0x34e72e(0xdc),_0xab112+=_0x34e72e(0x8d)+xBranchName+_0x34e72e(0x146)+xBMName+_0x34e72e(0xf6),_0xab112+='<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;margin-top:10px;\x22>',_0xab112+=_0x34e72e(0x76),_0xab112+=_0x34e72e(0xd1),dbGiftOrder[_0x34e72e(0x10f)](_0x34e72e(0x168),'==',_0x4d0419)[_0x34e72e(0xf7)](_0x34e72e(0xaf),_0x34e72e(0x12d))[_0x34e72e(0x109)]()[_0x34e72e(0xc0)](_0x5de46b=>{var _0x2fba69=_0x34e72e;_0x5de46b[_0x2fba69(0xf5)](_0x50d3e2=>{var _0x430864=_0x2fba69;_0x1198ff=_0x1198ff+_0x50d3e2[_0x430864(0x95)]()['OrderGift'],_0x16bceb=_0x16bceb+_0x50d3e2[_0x430864(0x95)]()[_0x430864(0xa0)]*_0x50d3e2['data']()[_0x430864(0x13a)],_0xab112+=_0x430864(0x13b)+_0x50d3e2[_0x430864(0x95)]()[_0x430864(0xaf)]+_0x430864(0x129),_0xab112+='<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;\x22>'+_0x50d3e2[_0x430864(0x95)]()[_0x430864(0xa0)]+_0x430864(0x130),_0xab112+=_0x430864(0xad)+numberWithCommas(_0x50d3e2[_0x430864(0x95)]()['OrderGift']*_0x50d3e2['data']()['PointRedeem'])+_0x430864(0xbb);}),_0xab112+=_0x2fba69(0x84),_0xab112+=_0x2fba69(0x96)+addCommas(_0x1198ff)+_0x2fba69(0x130),_0xab112+=_0x2fba69(0x96)+numberWithCommas(_0x16bceb)+_0x2fba69(0xbb),_0xab112+=_0x2fba69(0xc8)+numberWithCommas(xBMAllocated)+_0x2fba69(0xbb),_0xab112+=_0x2fba69(0x8b)+numberWithCommas(_0x16bceb)+_0x2fba69(0xbb),_0xab112+='<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณคงเหลือ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#0056ff;\x22>'+numberWithCommas(xBMAllocated-_0x16bceb)+_0x2fba69(0xbb),_0xab112+=_0x2fba69(0xb0),_0xab112+='<div\x20class=\x22btn-z0\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>ปิดหน้าต่าง<br>รายการนี้</div>',$(_0x2fba69(0x106))[_0x2fba69(0xa9)](_0xab112);}),document['getElementById'](_0x34e72e(0x7f))[_0x34e72e(0x12b)][_0x34e72e(0x91)]=_0x34e72e(0x16f);}function SaveOrder(){var _0x236037=_0x9ee9df;LoadDetail();var _0x38ee61=0x0,_0x37bf78=0x0,_0x2cfc66='',_0x5642d4=0x0,_0xd3d059='';console[_0x236037(0xce)](xMaxGift);for(let _0x1c7869=0x0;_0x1c7869<xMaxGift;_0x1c7869++){var _0x5f2d8f=document[_0x236037(0xd2)]('OrderGiftID'+_0x1c7869)[_0x236037(0x139)]*document[_0x236037(0xd2)](_0x236037(0x15d)+_0x1c7869)[_0x236037(0x139)];SaveGift(document['getElementById'](_0x236037(0x15b)+_0x1c7869)[_0x236037(0x139)],document[_0x236037(0xd2)](_0x236037(0x15d)+_0x1c7869)[_0x236037(0x139)],document[_0x236037(0xd2)](_0x236037(0xe7)+_0x1c7869)['value'],_0x5f2d8f,document['getElementById'](_0x236037(0x14f)+_0x1c7869)[_0x236037(0x139)]);}}var xSumMoney=0x0;function SaveGift(_0xb22d73,_0x2cb714,_0x2bca26,_0x1e3152,_0x3b95fe){var _0x1217a8=_0x9ee9df;document[_0x1217a8(0xd2)](_0x1217a8(0x7d))[_0x1217a8(0x12b)]['display']=_0x1217a8(0xa3),LoadDetail(),xSumMoney=0x0;var _0x295f77='',_0x510ccf='',_0x8e84cf=0x0;xSumMoney=xSumMoney+xTotalPrice,dbGiftOrder['where']('RefID','==',gID)[_0x1217a8(0x10f)](_0x1217a8(0x115),'==',_0xb22d73)[_0x1217a8(0x109)]()[_0x1217a8(0xc0)](_0x478694=>{var _0x4827e4=_0x1217a8;_0x478694[_0x4827e4(0xf5)](_0x2de963=>{_0x510ccf=_0x2de963['id'],_0x8e84cf=0x1;});if(_0x2bca26==0x0)dbGiftOrder['doc'](_0x510ccf)[_0x4827e4(0xfb)]();else{if(_0x8e84cf==0x1){var _0x7d0a07=parseFloat(_0x2bca26*_0x2cb714);dbGiftOrder[_0x4827e4(0xa7)](_0x510ccf)[_0x4827e4(0x12f)]({'OrderGift':parseFloat(_0x2bca26),'OrderPrice':parseFloat(_0x2bca26*_0x2cb714),'PointRedeem':parseFloat(_0x2cb714)});}else dbGiftOrder[_0x4827e4(0x124)]({'RefID':gID,'RefGift':_0xb22d73,'EmpID':xBMEmpID,'EmpName':xBMName,'EmpBR':xBranchName,'EmpZone':xZone,'EmpRH':xRH,'OrderGift':parseFloat(_0x2bca26),'OrderPrice':parseFloat(_0x2bca26*_0x2cb714),'PointRedeem':parseFloat(_0x2cb714),'StockName':_0x3b95fe});}});var _0xe0054a=0x0,_0x277a5d=0x0;_0x295f77+='<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>บันทึกการสั่งจองของขวัญปีใหม่</div>',_0x295f77+=_0x1217a8(0xd0),_0x295f77+=_0x1217a8(0x76),_0x295f77+=_0x1217a8(0xd1);for(let _0x14a300=0x0;_0x14a300<xMaxGift;_0x14a300++){document[_0x1217a8(0xd2)](_0x1217a8(0xe7)+_0x14a300)[_0x1217a8(0x139)]!=0x0&&(_0x295f77+=_0x1217a8(0x13b)+document[_0x1217a8(0xd2)]('NameGift'+_0x14a300)[_0x1217a8(0x139)]+'</th>',_0x295f77+='<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;\x22>'+document['getElementById']('OrderGiftID'+_0x14a300)[_0x1217a8(0x139)]+_0x1217a8(0x130),_0x295f77+=_0x1217a8(0xad)+numberWithCommas(document['getElementById']('OrderGiftID'+_0x14a300)['value']*document[_0x1217a8(0xd2)](_0x1217a8(0x15d)+_0x14a300)['value'])+'</td></tr>',_0x277a5d++);}_0x295f77+=_0x1217a8(0xbc)+numberWithCommas(xSumMoney)+'</td></tr>',_0x295f77+='<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>'+numberWithCommas(xBMAllocated)+_0x1217a8(0xbb),_0x295f77+=_0x1217a8(0xaa)+numberWithCommas(xBMAllocated-xSumMoney)+'</td></tr></tbody></table>',_0x295f77+=_0x1217a8(0x142),_0x295f77+='<div\x20style=\x22text-align:left;\x20margin:20px\x200\x202px\x205px;\x22>ที่ตั้งสาขา-ที่จัดส่งของขวัญ</div><center><textarea\x20id=\x22txtBM_Address\x22\x20name=\x22BM_Address\x22\x20style=\x22width:98%;\x20height:80px;text-align:left;font-weight:600;\x20color:#000;\x22>'+zBM_Address+_0x1217a8(0x131),_0x295f77+=_0x1217a8(0xb1)+zBM_Phone+'\x22\x20style=\x22text-align:left;\x22></div>',_0x295f77+=_0x1217a8(0xf8)+zEmpID_Staff1+_0x1217a8(0x118),_0x295f77+=_0x1217a8(0x10e)+zEmpName_Staff1+_0x1217a8(0x118),_0x295f77+=_0x1217a8(0x11a)+zPhone_Staff1+_0x1217a8(0x118),_0x295f77+=_0x1217a8(0x16b)+zEmpID_Staff2+_0x1217a8(0x118),_0x295f77+='<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกชื่อ-นามสกุล)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpName_Staff2\x22\x20value=\x22'+zEmpName_Staff2+_0x1217a8(0x118),_0x295f77+=_0x1217a8(0x157)+zPhone_Staff2+'\x22\x20style=\x22text-align:left;\x22></div>',_0x295f77+='<div\x20class=\x22btn-z1\x22\x20onclick=\x22SaveDetail(\x27'+gID+_0x1217a8(0x7b),_0x295f77+=_0x1217a8(0x77),_0x295f77+=_0x1217a8(0x155),_0x295f77+=_0x1217a8(0x7c)+gID+_0x1217a8(0x12e),$(_0x1217a8(0x101))[_0x1217a8(0xa9)](_0x295f77),$(_0x1217a8(0x102))['addClass'](_0x1217a8(0x98));var _0x32e16c=_0x1217a8(0xd7)+dateString+_0x1217a8(0x107),_0x139ac7=0x3e8;setTimeout(function(){var _0x54a0fd=_0x1217a8;dbNewyearData[_0x54a0fd(0xa7)](gID)[_0x54a0fd(0x12f)]({'BMStatus':0x1,'BMBalance':parseFloat(xBMAllocated-xSumMoney),'TotalOrders':parseFloat(_0x277a5d),'TotalOrders':parseFloat(xTotalUnitPrice),'UseBudget':parseFloat(xTotalPrice),'BM_Memo':_0x32e16c});},_0x139ac7),document[_0x1217a8(0xd2)](_0x1217a8(0x97))[_0x1217a8(0x12b)]['display']=_0x1217a8(0x16f);}function SaveToZone(){var _0x344a7d=_0x9ee9df,_0x559919=0x0,_0x3569b2=0x0;dbNewyearData['doc'](gID)[_0x344a7d(0x12f)]({'BMStatus':0x2}),str+=_0x344a7d(0x103),str+='<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;\x20margin-top:20px;\x22>',str+='<thead><tr\x20style=\x22text-align:\x20center;background-color:\x20#93a3c1;\x22>',str+=_0x344a7d(0xd1);for(let _0x14f31e=0x0;_0x14f31e<xMaxGift;_0x14f31e++){document[_0x344a7d(0xd2)]('OrderGiftID'+_0x14f31e)[_0x344a7d(0x139)]!=0x0&&(str+='<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;\x22>'+document[_0x344a7d(0xd2)](_0x344a7d(0x14f)+_0x14f31e)[_0x344a7d(0x139)]+_0x344a7d(0x129),str+=_0x344a7d(0xad)+document[_0x344a7d(0xd2)](_0x344a7d(0xe7)+_0x14f31e)[_0x344a7d(0x139)]+_0x344a7d(0x130),str+=_0x344a7d(0xad)+numberWithCommas(document[_0x344a7d(0xd2)](_0x344a7d(0xe7)+_0x14f31e)['value']*document['getElementById'](_0x344a7d(0x15d)+_0x14f31e)[_0x344a7d(0x139)])+_0x344a7d(0xbb),_0x3569b2++);}str+=_0x344a7d(0xfc)+numberWithCommas(xSumMoney)+_0x344a7d(0xbb),str+=_0x344a7d(0xae)+numberWithCommas(xBMAllocated)+'</td></tr>',str+=_0x344a7d(0xaa)+numberWithCommas(xBMAllocated-xSumMoney)+_0x344a7d(0x114),str+='<div\x20class=\x22txtmsg\x22>ขณะนี้รายการการจัดซื้อของขวัญของสาขา\x20อยู่ระหว่างการอนุมัติโดยโซนที่ดูแลสาขาของท่าน\x20กรุณารอการอนุมัติ</div>',str+=_0x344a7d(0x86),$('#DisplaySaveToZone')[_0x344a7d(0xa9)](str),document[_0x344a7d(0xd2)](_0x344a7d(0x121))[_0x344a7d(0x12b)][_0x344a7d(0x91)]=_0x344a7d(0x16f);}function GotoOrder(){var _0x34a566=_0x9ee9df;location['href']=_0x34a566(0x13d);}function SaveDetail(){var _0x3cd422=_0x9ee9df,_0x15d846=document[_0x3cd422(0xd2)](_0x3cd422(0x149))[_0x3cd422(0x139)],_0x3b4bdb=document['getElementById'](_0x3cd422(0x116))['value'],_0x213daa=document['getElementById'](_0x3cd422(0x166))[_0x3cd422(0x139)],_0x24f327=document[_0x3cd422(0xd2)]('txtEmpName_Staff1')[_0x3cd422(0x139)],_0xd42f16=document[_0x3cd422(0xd2)](_0x3cd422(0x14a))[_0x3cd422(0x139)],_0x1a0e29=document[_0x3cd422(0xd2)](_0x3cd422(0x10c))[_0x3cd422(0x139)],_0x5bc6e3=document[_0x3cd422(0xd2)]('txtEmpName_Staff2')[_0x3cd422(0x139)],_0x39ecd3=document[_0x3cd422(0xd2)](_0x3cd422(0x8a))['value'];_0x15d846==''||_0x3b4bdb==''||_0x213daa==''||_0x24f327==''||_0xd42f16==''||_0x1a0e29==''||_0x5bc6e3==''||_0x39ecd3==''?alert(_0x3cd422(0x137)):(dbNewyearData[_0x3cd422(0xa7)](gID)[_0x3cd422(0x12f)]({'BM_Address':document[_0x3cd422(0xd2)](_0x3cd422(0x149))['value'],'BM_Phone':document['getElementById']('txtBM_Phone')[_0x3cd422(0x139)],'EmpID_Staff1':document[_0x3cd422(0xd2)](_0x3cd422(0x166))[_0x3cd422(0x139)],'EmpName_Staff1':document['getElementById']('txtEmpName_Staff1')['value'],'Phone_Staff1':document[_0x3cd422(0xd2)](_0x3cd422(0x14a))[_0x3cd422(0x139)],'EmpID_Staff2':document[_0x3cd422(0xd2)](_0x3cd422(0x10c))[_0x3cd422(0x139)],'EmpName_Staff2':document[_0x3cd422(0xd2)]('txtEmpName_Staff2')[_0x3cd422(0x139)],'Phone_Staff2':document[_0x3cd422(0xd2)]('txtPhone_Staff2')['value']}),alert(_0x3cd422(0x144)),LoadDetail(),document[_0x3cd422(0xd2)]('idSendZoneApprove')[_0x3cd422(0x12b)][_0x3cd422(0x91)]=_0x3cd422(0x16f));}function addCommas(_0x56e48d){var _0x322db9=_0x9ee9df;_0x56e48d+='',x=_0x56e48d[_0x322db9(0x7a)]('.'),x1=x[0x0],x2=x[_0x322db9(0x99)]>0x1?'.'+x[0x1]:'';var _0x3987c9=/(\d+)(\d{3})/;while(_0x3987c9['test'](x1)){x1=x1['replace'](_0x3987c9,'$1'+','+'$2');}return x1+x2;}function numberWithCommas(_0x428e8f){var _0x16ca63=_0x9ee9df,_0x55e0c6=_0x428e8f,_0x73633=parseFloat(_0x55e0c6)[_0x16ca63(0xf1)](0x2);return formattedString=_0x73633['toString']()['replace'](/\B(?=(\d{3})+(?!\d))/g,',');}function CloseAll(){var _0x47c0ca=_0x9ee9df;document['getElementById'](_0x47c0ca(0x7d))[_0x47c0ca(0x12b)][_0x47c0ca(0x91)]=_0x47c0ca(0x16f),document[_0x47c0ca(0xd2)]('id01')[_0x47c0ca(0x12b)][_0x47c0ca(0x91)]=_0x47c0ca(0xa3),document[_0x47c0ca(0xd2)](_0x47c0ca(0x121))[_0x47c0ca(0x12b)]['display']=_0x47c0ca(0xa3),document[_0x47c0ca(0xd2)](_0x47c0ca(0x7f))[_0x47c0ca(0x12b)][_0x47c0ca(0x91)]='none';}
