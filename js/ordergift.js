var _0x588902=_0xfb3f;(function(_0x1d0b6f,_0x49de48){var _0x8003f8=_0xfb3f,_0x119305=_0x1d0b6f();while(!![]){try{var _0x220e72=-parseInt(_0x8003f8(0x19f))/0x1*(-parseInt(_0x8003f8(0x136))/0x2)+-parseInt(_0x8003f8(0x122))/0x3+parseInt(_0x8003f8(0x163))/0x4+-parseInt(_0x8003f8(0x1bf))/0x5+-parseInt(_0x8003f8(0x15c))/0x6+-parseInt(_0x8003f8(0x1a1))/0x7+parseInt(_0x8003f8(0x172))/0x8;if(_0x220e72===_0x49de48)break;else _0x119305['push'](_0x119305['shift']());}catch(_0x3703c5){_0x119305['push'](_0x119305['shift']());}}}(_0x539d,0x67318));var dateString=new Date()['toLocaleString'](_0x588902(0x197),{'timeZone':_0x588902(0x127)}),today=new Date(),dd=String(today[_0x588902(0x1a9)]())['padStart'](0x2,'0'),mm=String(today['getMonth']()+0x1)['padStart'](0x2,'0'),yyyy=today['getFullYear']()+0x21f,gID,gStatus,xMaxGift=0x0,xNewyearLimit=0x16,xOrderLimit=0x64,xBMStatus=0x0,xSendZoneApprove=0x0,zBM_Address='',zBM_Phone='',zEmpID_Staff1='',zEmpName_Staff1='',zPhone_Staff1='',zEmpID_Staff2='',zEmpName_Staff2='',zPhone_Staff2='',zZoneMemoToBM='';$(document)[_0x588902(0x109)](function(){var _0x583c7a=_0x588902;sessionStorage['getItem'](_0x583c7a(0x158))==null&&(location[_0x583c7a(0x168)]='index.html'),gID=getParameterByName('gid'),gStatus=getParameterByName(_0x583c7a(0x12b)),Connect_DB(),dbNewyearData=firebase[_0x583c7a(0x10d)]()[_0x583c7a(0x10a)]('Newyear2024_data'),dbGiftStock=firebase[_0x583c7a(0x10d)]()[_0x583c7a(0x10a)](_0x583c7a(0x11d)),dbGiftOrder=firebase[_0x583c7a(0x10d)]()[_0x583c7a(0x10a)](_0x583c7a(0x1ae)),CheckBudget(),GetUserOrder(gID),LoadGiftStock();});function getParameterByName(_0x2c316a,_0x4eb6d5){var _0xb7bc26=_0x588902;str='';if(!_0x4eb6d5)_0x4eb6d5=window[_0xb7bc26(0x1c6)][_0xb7bc26(0x168)];_0x2c316a=_0x2c316a[_0xb7bc26(0x132)](/[\[\]]/g,_0xb7bc26(0x15a));var _0x37fd7d=new RegExp('[?&]'+_0x2c316a+_0xb7bc26(0x190)),_0x553d8b=_0x37fd7d[_0xb7bc26(0x1dc)](_0x4eb6d5);if(!_0x553d8b)return null;if(!_0x553d8b[0x2])return'';return decodeURIComponent(_0x553d8b[0x2][_0xb7bc26(0x132)](/\+/g,'\x20'));}function LoadDetail(){var _0x3a362c=_0x588902;dbNewyearData[_0x3a362c(0x1d6)](firebase[_0x3a362c(0x10d)]['FieldPath']['documentId'](),'==',gID)[_0x3a362c(0x139)]()[_0x3a362c(0x147)](_0x1e9380=>{var _0xabd5e0=_0x3a362c;_0x1e9380[_0xabd5e0(0x1c2)](_0x22d775=>{var _0x399c48=_0xabd5e0;xBMStatus=_0x22d775['data']()[_0x399c48(0x157)],zBM_Address=_0x22d775[_0x399c48(0x1b4)]()[_0x399c48(0x144)],zBM_Phone=_0x22d775[_0x399c48(0x1b4)]()['BM_Phone'],zEmpID_Staff1=_0x22d775[_0x399c48(0x1b4)]()[_0x399c48(0x17c)],zEmpName_Staff1=_0x22d775[_0x399c48(0x1b4)]()[_0x399c48(0x112)],zPhone_Staff1=_0x22d775[_0x399c48(0x1b4)]()[_0x399c48(0x1b1)],zEmpID_Staff2=_0x22d775[_0x399c48(0x1b4)]()[_0x399c48(0x14f)],zEmpName_Staff2=_0x22d775[_0x399c48(0x1b4)]()[_0x399c48(0x1e2)],zPhone_Staff2=_0x22d775[_0x399c48(0x1b4)]()[_0x399c48(0x198)],zZoneMemoToBM=_0x22d775[_0x399c48(0x1b4)]()[_0x399c48(0x152)];});});}var xBMAllocated=0x0,xBMEmpID='',xBMName='',xBranchName='',xZone='',xRH='';function CheckBudget(){var _0x2cd3be=_0x588902,_0x242daa='',_0x17217f='';_0x242daa+=_0x2cd3be(0x1ab),_0x242daa+=_0x2cd3be(0x1b0),_0x242daa+='<th\x20scope=\x22col\x22>รายการ</th><th\x20scope=\x22col\x22>รายละเอียด</th></tr></thead><tbody>',dbNewyearData[_0x2cd3be(0x1d6)](firebase['firestore'][_0x2cd3be(0x1c3)]['documentId'](),'==',gID)[_0x2cd3be(0x139)]()[_0x2cd3be(0x147)](_0x3e708f=>{var _0x40e49d=_0x2cd3be;_0x3e708f['forEach'](_0x3f9a83=>{var _0x1ccbb5=_0xfb3f;xBMStatus=_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x157)];if(_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x157)]==0x0)xMsg=_0x1ccbb5(0x1af),_0x17217f=_0x1ccbb5(0x1a6);else{if(_0x3f9a83['data']()['BMStatus']==0x1)xMsg=_0x1ccbb5(0x13f),_0x17217f=_0x1ccbb5(0x102);else{if(_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x157)]==0x2)xMsg=_0x1ccbb5(0x1e3),_0x17217f=_0x1ccbb5(0x123);else{if(_0x3f9a83[_0x1ccbb5(0x1b4)]()['BMStatus']==0x3)xMsg='โซนแจ้ง<br>ทบทวน',_0x17217f='<font\x20color=\x27#ff0000\x27><b>โซนแจ้งทบทวนใหม่</b></font>';else{if(_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x157)]==0x8)xMsg=_0x1ccbb5(0x105),_0x17217f=_0x1ccbb5(0x17b);else _0x3f9a83[_0x1ccbb5(0x1b4)]()['BMStatus']==0x9&&(xMsg=_0x1ccbb5(0x1be),_0x17217f=_0x1ccbb5(0x1c1));}}}}xBMEmpID=_0x3f9a83[_0x1ccbb5(0x1b4)]()['BMEmpID'],xBMName=_0x3f9a83['data']()['BMName'],xBranchName=_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x14c)]+'\x20('+_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x113)]+')',xZone=_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x1d0)],xRH=_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x196)],_0x242daa+='<tr>',_0x242daa+='<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สาขา</td>',_0x242daa+='<td\x20style=\x22text-align:\x20center;background:#c4d0e2;\x22><b>'+_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x14c)]+'\x20('+_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x113)]+_0x1ccbb5(0x17f),_0x242daa+=_0x1ccbb5(0x1c4),_0x242daa+=_0x1ccbb5(0x141)+_0x3f9a83['data']()['BMName']+'</b></td></tr>',_0x242daa+='<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สถานะ</td>',_0x242daa+='<td\x20style=\x22text-align:\x20center;background:#c4d0e2;\x22><b>'+_0x17217f+_0x1ccbb5(0x126),_0x242daa+='<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>งบสั่งจอง</td>',_0x242daa+=_0x1ccbb5(0x141)+numberWithCommas(_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x1b8)])+_0x1ccbb5(0x188),_0x242daa+=_0x1ccbb5(0x19e),_0x242daa+=_0x1ccbb5(0x141)+numberWithCommas(_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x159)])+'\x20บาท</b></td></tr>',xBMAllocated=_0x3f9a83[_0x1ccbb5(0x1b4)]()[_0x1ccbb5(0x1b8)];}),_0x242daa+=_0x40e49d(0x100),_0x242daa+='<div\x20class=\x22clr\x22></div>',$(_0x40e49d(0x175))[_0x40e49d(0x1b7)](_0x242daa);});}var GetOrderArr=[];function GetUserOrder(_0x51c105){var _0x4833e2=_0x588902,_0x4ebe7c=0x0;dbGiftOrder[_0x4833e2(0x1d6)](_0x4833e2(0x10f),'==',_0x51c105)['get']()[_0x4833e2(0x147)](_0x34630e=>{var _0x5b5545=_0x4833e2;_0x34630e[_0x5b5545(0x1c2)](_0x5e4c39=>{var _0x59a25b=_0x5b5545;GetOrderArr[_0x59a25b(0x15b)]({'RefGift':_0x5e4c39[_0x59a25b(0x1b4)]()[_0x59a25b(0xf9)],'StockName':_0x5e4c39[_0x59a25b(0x1b4)]()[_0x59a25b(0x1ea)],'OrderGift':_0x5e4c39[_0x59a25b(0x1b4)]()[_0x59a25b(0x10c)],'ID':_0x5e4c39['id']});});});}function _0x539d(){var _0x1e6fb9=['\x22\x20readonly></div>','ready','collection','<div\x20class=\x22btn-z1\x22\x20onclick=\x22GotoOrder()\x22\x20style=\x22margin:10px\x2010px\x2020px\x20auto;min-width:100px;\x22>กลับไป<br>หน้าแรก</div>','OrderGift','firestore','<div\x20class=\x22btn-z1\x22\x20onclick=\x22SaveOrder(\x27','RefID','StockDetail','display','EmpName_Staff1','BranchID','<div\x20class=\x22btn-z0\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>ปิดหน้าต่าง<br>รายการนี้</div>','addClass','<div\x20style=\x22font-weight:400;padding-top:10px;\x22>ราคาขายต่อชิ้น\x20<b>','#DisplayGroup2','<center><div\x20class=\x22btn-t22a\x22\x20style=\x22margin:30px\x20auto\x2020px\x20auto;\x22><b>รายการสั่งซื้อของขวัญปีใหม่ของสาขา</b></div></center>','delete','#DisplaySaveGift','\x22\x20style=\x22color:#fff;background:#ff0000;\x22></div></div>','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกรหัสพนักงาน)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpID_Staff2\x22\x20value=\x22','Newyear2024_gift','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>ยอดรวมการสั่งซื้อ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>',')\x22\x20value=\x22','<div\x20class=\x22btn-z9\x22\x20onclick=\x22ViewOrder(\x27','OrderGiftID9','1070550nqVoVU','<font\x20color=\x27#0056ff\x27><b>ส่งโซนอนุมัติ</b></font>','<center><div\x20class=\x22btn-t3\x22\x20style=\x22margin-top:25px;\x22><b>รายละเอียดของขวัญปีใหม่</b></div>','OrderGiftID7','</b></td></tr>','Asia/Jakarta','\x27)\x22><img\x20src=\x22./img/icon-02.png\x22\x20style=\x22width:20px;\x22></div></th>','<div\x20style=\x22margin-top:4px;\x22>','#SumUnitPrice14','gStatus','orderBy','UnitPrice3','<option\x20onchange=\x22CalGift(','</b><br>Branch\x20:\x20<b>','OrderGiftID15','<div\x20class=\x22btn-z3\x22\x20onclick=\x22DeleteAllOrder(\x27','replace','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกรหัสพนักงาน)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpID_Staff1\x22\x20value=\x22','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;\x22><div\x20onclick=\x22DisplayGift(\x27','<div\x20class=\x22btn-z0\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>ทำการแก้ไข<br>ใหม่อีกครั้ง</div>','12qJHoGJ','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณคงเหลือ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#0056ff;\x22>','\x22\x20style=\x22text-align:left;\x22></div>','get','toFixed','home.html','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>','<div\x20style=\x22font-weight:600;\x20color:#ff0000;line-height:1.2;\x22><font\x20color=\x22#000000\x22>โซนแจ้งทำการทบทวนการสั่งจองใหม่อีกครั้ง</font><br>','</th>','กำลัง<br>สั่งจอง','UnitPrice11','<td\x20style=\x22text-align:\x20center;background:#c4d0e2;\x22><b>','UnitPrice12','<th\x20scope=\x22col\x22>รายการ</th><th\x20scope=\x22col\x22>จำนวน</th><th\x20scope=\x22col\x22>ราคา</th></tr></thead><tbody>','BM_Address','</td></tr>','<input\x20type=\x22text\x22\x20id=\x22OrderGiftRefID','then','StockStatus','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกหมายเลขโทรศัพท์)</div><input\x20type=\x22text\x22\x20id=\x22txtPhone_Staff2\x22\x20value=\x22','#SumUnitPrice6','#SumUnitPrice12','BranchName','getElementById','OrderGiftID5','EmpID_Staff2','#idSendZoneApprove','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายละเอียด<br>รายการสั่งซื้อ</div>','ZoneMemoToBM','documentId','<div\x20style=\x22text-align:left;\x20margin:20px\x200\x202px\x205px;\x22>ที่ตั้งสาขา-ที่จัดส่งของขวัญ</div><center><textarea\x20id=\x22txtBM_Address\x22\x20name=\x22BM_Address\x22\x20style=\x22width:98%;\x20height:80px;text-align:left;font-weight:600;\x20color:#000;\x22>','OrderGiftID8','OrderGiftID12','BMStatus','EmpID_Newyear','UseBudget','\x5c$&','push','1928802hFiqvL','<div\x20class=\x22btn-t2\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:15px\x20auto\x2025px\x20auto;\x22>ปิดหน้าต่างนี้</div>','txtPhone_Staff1','<div\x20class=\x22btn-z0\x22\x20style=\x22margin:10px\x2010px\x2020px\x20auto;min-width:100px;\x22>กรุณาสั่ง<br>ของขวัญปีใหม่</div>','#SumUnitPrice13','\x22\x20style=\x22width:100%;margin-top:18px;margin-bottom:\x2010px;\x22></div></center>','value','2914300yzUsWQ','UnitPrice6','#SumUnitPrice4','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>นำส่งรายการสั่งซื้อให้โซนอนุมัติ</div>','UnitPrice','href','doc','OrderGiftID3','UnitPrice5','\x20ชิ้น</option>','บันทึกรายการแก้ไขรายการ\x20','UnitPrice10','<div\x20style=\x22font-weight:600;\x20color:#0056ff;\x22>รายการของท่านได้รับการอนุมัติจากโซน\x20เรียบร้อยแล้ว<br></div>','gID=','UnitPrice13','5435784YNqxwD','ขณะนี้คุณได้ทำคำสั่งซื้อของขวัญปีใหม่\x0aจากงบประมาณที่ได้รับ\x20','#DisplaySaveToZone','#DisplayBudget','\x22\x20selected>','length','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>รายละเอียดเพิ่มเติม</div><div\x20class=\x22clr\x22></div>','<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;\x22>','OrderGiftID2','<font\x20color=\x27#ff0000\x27><b>โซนแจ้งขอยกเลิกการจอง</b></font>','EmpID_Staff1','NameGift','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;background:#73a0f4;\x22>สรุปรายการสั่งซื้อ</th>',')</b></td></tr>','\x22\x20style=\x22color:#fff;background:#0056ff;\x22></div></div>','</div><div\x20style=\x22margin-top:30px;padding-top:20px;margin-left:3px;\x22>','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกชื่อ-นามสกุล)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpName_Staff1\x22\x20value=\x22','\x20บาท</b></div>','txtPhone_Staff2','OrderGiftID14','txtEmpID_Staff2','</td></tr></tbody></table>','\x20บาท</b></td></tr>','test','<center><div\x20class=\x22btn-t1\x22\x20onclick=\x22GotoOrder()\x22>ปิดหน้าต่างนี้</div></center>','log','id03','\x27)\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>บันทึกดร๊าฟ<br>ก่อนส่งโซน</div>','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>บันทึกดร๊าฟ<br>รายการสั่งซื้อ</div>','txtEmpName_Staff2','(=([^&#]*)|&|#|$)','<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;background:#73a0f4;\x22>','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>รวมทั้งหมด</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#31e85b;\x22>','\x22\x20value=\x22','ShowNav','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;\x20margin-top:20px;\x22>','EmpRH','en-US','Phone_Staff2','txtEmpID_Staff1','txtEmpName_Staff1','#DisplayGift','style','<div\x20style=\x22font-weight:600;\x22>รายการอยู่ระหว่างการขออนุมัติจากโซน<br></div>','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สั่งไปแล้ว</td>','85112HvPEdK','<div\x20style=\x22font-weight:400;\x20text-align:left;\x20padding-top:10px;\x22>','3289356eYhMpa','disabledbutton','OrderGiftID13','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>รวมยอดการสั่งจองของขวัญ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#31e85b;\x22>','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>โทรศัพท์ผู้จัดการสาขา</div><input\x20type=\x22text\x22\x20id=\x22txtBM_Phone\x22\x20value=\x22','<font\x20color=\x27#555555\x27><b>ยังไม่ได้สั่งจอง</b></font>','txtBM_Phone','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกชื่อ-นามสกุล)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpName_Staff2\x22\x20value=\x22','getDate','asc','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22margin-top:20px;\x20background-color:\x20#fff;\x22>','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>ยอดงบคงเหลือ</div><input\x20type=\x22text\x22\x20value=\x22','add','Newyear2024_order','คลิก<br>สั่งจอง','<thead><tr\x20style=\x22text-align:\x20center;background-color:\x20#93a3c1;\x22>','Phone_Staff1','UnitPrice1','UnitPrice8','data','<div\x20onclick=\x22DisplayGift(\x27','PointRedeem','html','BMAllocated','<option\x20onchange=\x22CalGift(0)\x22\x20value=\x220\x22>รอการสั่ง</option>','#SumUnitPrice3','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายการสั่งซื้อ<br>ของขวัญปีใหม่</div>','\x22\x20hidden>','<hr><div\x20style=\x22margin-top:-10px;text-align:left;padding-bottom:\x2010px;line-height:1.3;\x20padding-left:10px;\x22>BM\x20:\x20<b>','โซนแจ้ง<br>อนุมัติ','1739075rGfosW','ระบบได้ทำการลบรายการการสั่งจองของขวัญของคุณเรียบร้อยแล้ว','<font\x20color=\x27#28c92a\x27><b>โซนอนุมัติเรียบร้อยแล้ว</b></font>','forEach','FieldPath','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>BM</td>','OrderGiftID','location','toString','OrderGiftRefID','StockView','block','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>จำนวนเงินที่สั่ง</div><input\x20type=\x22text\x22\x20value=\x22','OrderGiftID1','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ยกเลิก<br>รายการสั่งซื้อ</div>','\x22\x20style=\x22color:#fff;background:#13c33b;\x22></div></div>','OrderGiftID4','EmpZone','</td>','#TotalGift','update','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกหมายเลขโทรศัพท์)</div><input\x20type=\x22text\x22\x20id=\x22txtPhone_Staff1\x22\x20value=\x22','\x22\x20class=\x22form-control\x22>','where','StockOrder','\x20บาท\x0aคุณสั่งเกินไปแล้ว\x20','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>บันทึกการสั่งจองของขวัญปีใหม่</div>','<div\x20class=\x22btn-t2\x22\x20onclick=location.href=\x22home.html\x22\x20type=\x22submit\x22\x20style=\x22margin-top:20px;\x22>ไม่บันทึกรายการ</div>','OrderGiftID11','exec','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>งบประมาณที่ได้รับ</div><input\x20type=\x22text\x22\x20value=\x22','txtBM_Address','</b></font></div>','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>เลือกจำนวนชิ้น</div>','OrderGiftID10','EmpName_Staff2','ส่งโซน<br>ขออนุมัติ','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20center;\x22>','ระบบได้ทำการบันทึกรายการนี้เรียบร้อยแล้ว\x20หากไม่มีการแก้ไขรายการให้ทำการกดปุ่ม\x20ส่งคำขอให้โซนอนุมัติ\x20ซึ่งจะมีผลให้สาขาไม่สามารถทำการแก้ไขรายการได้แล้ว','<div\x20id=\x22ShowSaveData\x22\x20style=\x22display:block;margin-bottom:\x2020px;\x22>','#SumUnitPrice10','#SumUnitPrice9','<div\x20class=\x22btn-z0\x22\x20onclick=\x22ViewOrder(\x27','StockName','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;\x22>','id01','<div\x20class=\x22btn-z3\x22\x20onclick=\x22SaveToZone(\x27','UnitPrice2','RefGift','#SumUnitPrice11','\x20บาท\x0aระบบจะไม่อนุญาตให้บันทึกรายการสั่งจอง','OrderGiftID0','id02','none','\x27)\x22><font\x20color=\x22#0056ff\x22><b>','</tbody></table></div>','#SumUnitPrice2','<font\x20color=\x27#f68b1f\x27><b>อยู่ระหว่างการสั่งจอง</b></font>','<div\x20class=\x22clr\x22></div>','</div>','โซนแจ้ง<br>ยกเลิก','UnitPrice4','<input\x20type=\x22text\x22\x20id=\x22NameGift'];_0x539d=function(){return _0x1e6fb9;};return _0x539d();}var xCheckOrder=0x0,xCountRec=0x0,xSumAllPrice=0x0,xSumUnitPrice=0x0,xTotalUnitPrice=0x0,xBalance=0x0;function LoadGiftStock(){var _0x3fbf6f=_0x588902;LoadDetail();var _0x4e1e07='',_0x2d8b1d=0x0,_0x3c0754=0x0;xSumAllPrice=0x0,xSumUnitPrice=0x0,xMaxGift=0x0,xCalSell=0x0,_0x4e1e07+='<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;\x22>',_0x4e1e07+=_0x3fbf6f(0x1b0),_0x4e1e07+='<th\x20scope=\x22col\x22>No.</th><th\x20scope=\x22col\x22>รายการของขวัญ</th></tr></thead><tbody>',dbGiftStock[_0x3fbf6f(0x1d6)](_0x3fbf6f(0x148),'==',0x1)[_0x3fbf6f(0x12c)]('StockGroup',_0x3fbf6f(0x1aa))[_0x3fbf6f(0x12c)](_0x3fbf6f(0x1d7),'asc')[_0x3fbf6f(0x139)]()['then'](_0x59fc63=>{var _0x8e5ef1=_0x3fbf6f;_0x59fc63['forEach'](_0x49c95c=>{var _0x3ec79b=_0xfb3f;const _0x335e67=GetOrderArr['filter'](_0x55bdf6=>{return _0x55bdf6['RefGift']===_0x49c95c['id'];});xResults=0x0,xCheckLine=0x0;_0x335e67[0x0]!=undefined&&(xResults=_0x335e67[0x0][_0x3ec79b(0x10c)],xCheckOrder=parseFloat(xCheckOrder)+parseFloat(_0x335e67[0x0][_0x3ec79b(0x10c)]));_0x4e1e07+=_0x3ec79b(0x1e4)+(_0x2d8b1d+0x1)+_0x3ec79b(0x1b5)+_0x49c95c['id']+_0x3ec79b(0x128),_0x4e1e07+=_0x3ec79b(0x134)+_0x49c95c['id']+_0x3ec79b(0xff)+_0x49c95c[_0x3ec79b(0x1b4)]()[_0x3ec79b(0x1ea)]+_0x3ec79b(0x1df),_0x4e1e07+=_0x3ec79b(0x129),_0x4e1e07+=_0x3ec79b(0x1e0),_0x4e1e07+='<select\x20name=\x22OrderGiftID\x22\x20onchange=\x22CalGift()\x22\x20id=\x22OrderGiftID'+_0x2d8b1d+_0x3ec79b(0x193)+xResults+_0x3ec79b(0x1d5);if(_0x49c95c['data']()['StockView']==0x1)for(let _0x589517=0x0;_0x589517<xNewyearLimit;_0x589517++){_0x589517==0x0?_0x4e1e07+=_0x3ec79b(0x1b9):xResults==_0x589517*0x32?(xCheckLine=0x1,_0x4e1e07+=_0x3ec79b(0x12e)+_0x589517+_0x3ec79b(0x11f)+_0x335e67[0x0][_0x3ec79b(0x10c)]+_0x3ec79b(0x176)+_0x335e67[0x0][_0x3ec79b(0x10c)]+_0x3ec79b(0x16c)):_0x4e1e07+='<option\x20onchange=\x22CalGift('+_0x589517+_0x3ec79b(0x11f)+_0x589517*0x32+'\x22>'+_0x589517*0x32+_0x3ec79b(0x16c);}else{if(_0x49c95c[_0x3ec79b(0x1b4)]()[_0x3ec79b(0x1c9)]==0x2)for(let _0x2cc10e=0x0;_0x2cc10e<xOrderLimit+0x1;_0x2cc10e++){_0x2cc10e==0x0?_0x4e1e07+=_0x3ec79b(0x1b9):xResults==_0x2cc10e?(xCheckLine=0x1,_0x4e1e07+=_0x3ec79b(0x12e)+_0x2cc10e+_0x3ec79b(0x11f)+_0x335e67[0x0][_0x3ec79b(0x10c)]+_0x3ec79b(0x176)+_0x335e67[0x0]['OrderGift']+_0x3ec79b(0x16c)):_0x4e1e07+=_0x3ec79b(0x12e)+_0x2cc10e+_0x3ec79b(0x11f)+_0x2cc10e+'\x22>'+_0x2cc10e+_0x3ec79b(0x16c);}}xCalSell+=xResults*_0x49c95c[_0x3ec79b(0x1b4)]()[_0x3ec79b(0x1b6)],_0x4e1e07+='</select></div>',_0x4e1e07+='<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>ราคาต่อชิ้น</div><input\x20type=\x22text\x22\x20id=\x22UnitPrice'+_0x2d8b1d+'\x22\x20value=\x22'+_0x49c95c[_0x3ec79b(0x1b4)]()['PointRedeem']+_0x3ec79b(0x108),_0x4e1e07+='<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>จำนวนเงินที่ใช้</div><div\x20class=\x22box-order\x22\x20id=\x22SumUnitPrice'+_0x2d8b1d+_0x3ec79b(0x193)+xResults*_0x49c95c[_0x3ec79b(0x1b4)]()[_0x3ec79b(0x1b6)]+'\x22\x20readonly></div></div>',_0x4e1e07+='</td>',_0x4e1e07+='</tr>',_0x4e1e07+=_0x3ec79b(0x146)+_0x2d8b1d+_0x3ec79b(0x193)+_0x49c95c['id']+_0x3ec79b(0x1bc),_0x4e1e07+=_0x3ec79b(0x107)+_0x2d8b1d+'\x22\x20value=\x22'+_0x49c95c[_0x3ec79b(0x1b4)]()[_0x3ec79b(0x1ea)]+_0x3ec79b(0x1bc),_0x2d8b1d++,xMaxGift++;}),_0x4e1e07+=_0x8e5ef1(0x100),_0x4e1e07+='<div\x20class=\x22clr\x22></div>',$(_0x8e5ef1(0x117))['html'](_0x4e1e07),CalGift();});}var xTotalPrice=0x0;function CalGift(){var _0x29e0e3=_0x588902,_0x1f271d=0x0,_0x22d84a='',_0x20bdf7=0x0,_0x526e7a=parseFloat(document[_0x29e0e3(0x14d)]('UnitPrice0')['value']*document['getElementById'](_0x29e0e3(0xfc))[_0x29e0e3(0x162)]),_0xaacb1c=parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x1b2))[_0x29e0e3(0x162)]*document[_0x29e0e3(0x14d)](_0x29e0e3(0x1cc))['value']),_0x51b870=parseFloat(document['getElementById'](_0x29e0e3(0xf8))[_0x29e0e3(0x162)]*document[_0x29e0e3(0x14d)](_0x29e0e3(0x17a))[_0x29e0e3(0x162)]),_0x320b41=parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x12d))[_0x29e0e3(0x162)]*document[_0x29e0e3(0x14d)](_0x29e0e3(0x16a))['value']),_0x81c5bc=parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x106))[_0x29e0e3(0x162)]*document[_0x29e0e3(0x14d)](_0x29e0e3(0x1cf))[_0x29e0e3(0x162)]),_0x448a8=parseFloat(document['getElementById'](_0x29e0e3(0x16b))[_0x29e0e3(0x162)]*document[_0x29e0e3(0x14d)](_0x29e0e3(0x14e))[_0x29e0e3(0x162)]),_0x4adbf6=parseFloat(document['getElementById'](_0x29e0e3(0x164))[_0x29e0e3(0x162)]*document['getElementById']('OrderGiftID6')['value']),_0x58a396=parseFloat(document['getElementById']('UnitPrice7')[_0x29e0e3(0x162)]*document[_0x29e0e3(0x14d)](_0x29e0e3(0x125))[_0x29e0e3(0x162)]),_0x364e61=parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x1b3))[_0x29e0e3(0x162)]*document[_0x29e0e3(0x14d)](_0x29e0e3(0x155))[_0x29e0e3(0x162)]),_0x5bcaac=parseFloat(document['getElementById']('UnitPrice9')['value']*document[_0x29e0e3(0x14d)]('OrderGiftID9')[_0x29e0e3(0x162)]),_0x1a7f94=parseFloat(document['getElementById'](_0x29e0e3(0x16e))[_0x29e0e3(0x162)]*document['getElementById']('OrderGiftID10')[_0x29e0e3(0x162)]),_0x223b26=parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x140))[_0x29e0e3(0x162)]*document[_0x29e0e3(0x14d)](_0x29e0e3(0x1db))['value']),_0x5895b1=parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x142))[_0x29e0e3(0x162)]*document[_0x29e0e3(0x14d)](_0x29e0e3(0x156))[_0x29e0e3(0x162)]),_0x47ae6c=parseFloat(document['getElementById'](_0x29e0e3(0x171))['value']*document['getElementById'](_0x29e0e3(0x1a3))[_0x29e0e3(0x162)]),_0xa5257d=parseFloat(document[_0x29e0e3(0x14d)]('UnitPrice14')[_0x29e0e3(0x162)]*document['getElementById'](_0x29e0e3(0x185))['value']),_0x549ff5=parseFloat(document[_0x29e0e3(0x14d)]('UnitPrice15')[_0x29e0e3(0x162)]*document[_0x29e0e3(0x14d)]('OrderGiftID15')[_0x29e0e3(0x162)]),_0x18ac7a=parseFloat(document['getElementById']('OrderGiftID0')[_0x29e0e3(0x162)])+parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x1cc))[_0x29e0e3(0x162)])+parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x17a))[_0x29e0e3(0x162)])+parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x16a))[_0x29e0e3(0x162)])+parseFloat(document['getElementById']('OrderGiftID4')[_0x29e0e3(0x162)])+parseFloat(document['getElementById'](_0x29e0e3(0x14e))[_0x29e0e3(0x162)])+parseFloat(document[_0x29e0e3(0x14d)]('OrderGiftID6')[_0x29e0e3(0x162)]),_0x22df9e=parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x125))['value'])+parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x155))['value'])+parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x121))[_0x29e0e3(0x162)])+parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x1e1))[_0x29e0e3(0x162)])+parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x1db))[_0x29e0e3(0x162)])+parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x156))[_0x29e0e3(0x162)])+parseFloat(document[_0x29e0e3(0x14d)](_0x29e0e3(0x1a3))[_0x29e0e3(0x162)]),_0x1929c5=parseFloat(document['getElementById'](_0x29e0e3(0x185))['value'])+parseFloat(document['getElementById'](_0x29e0e3(0x130))['value']);xTotalUnitPrice=_0x18ac7a+_0x22df9e+_0x1929c5;var _0x404582=parseFloat(_0x526e7a)+parseFloat(_0xaacb1c)+parseFloat(_0x51b870)+parseFloat(_0x320b41)+parseFloat(_0x81c5bc)+parseFloat(_0x448a8),_0x54ff9e=parseFloat(_0x4adbf6)+parseFloat(_0x58a396)+parseFloat(_0x364e61)+parseFloat(_0x5bcaac)+parseFloat(_0x1a7f94)+parseFloat(_0x223b26),_0x60ed10=parseFloat(_0x5895b1)+parseFloat(_0x47ae6c)+parseFloat(_0xa5257d)+parseFloat(_0x549ff5);xTotalPrice=_0x404582+_0x54ff9e+_0x60ed10,xBalance=xBMAllocated-xTotalPrice,$('#SumUnitPrice0')['html'](numberWithCommas(_0x526e7a)),$('#SumUnitPrice1')['html'](numberWithCommas(_0xaacb1c)),$(_0x29e0e3(0x101))[_0x29e0e3(0x1b7)](numberWithCommas(_0x51b870)),$(_0x29e0e3(0x1ba))['html'](numberWithCommas(_0x320b41)),$(_0x29e0e3(0x165))['html'](numberWithCommas(_0x81c5bc)),$('#SumUnitPrice5')[_0x29e0e3(0x1b7)](numberWithCommas(_0x448a8)),$(_0x29e0e3(0x14a))[_0x29e0e3(0x1b7)](numberWithCommas(_0x4adbf6)),$('#SumUnitPrice7')[_0x29e0e3(0x1b7)](numberWithCommas(_0x58a396)),$('#SumUnitPrice8')['html'](numberWithCommas(_0x364e61)),$(_0x29e0e3(0x1e8))[_0x29e0e3(0x1b7)](numberWithCommas(_0x5bcaac)),$(_0x29e0e3(0x1e7))[_0x29e0e3(0x1b7)](numberWithCommas(_0x1a7f94)),$(_0x29e0e3(0xfa))['html'](numberWithCommas(_0x223b26)),$(_0x29e0e3(0x14b))['html'](numberWithCommas(_0x5895b1)),$(_0x29e0e3(0x160))[_0x29e0e3(0x1b7)](numberWithCommas(_0x47ae6c)),$(_0x29e0e3(0x12a))['html'](numberWithCommas(_0xa5257d)),$('#SumUnitPrice15')[_0x29e0e3(0x1b7)](numberWithCommas(_0x549ff5)),_0x22d84a+=_0x29e0e3(0x103),_0x22d84a+=_0x29e0e3(0x181),_0x22d84a+=_0x29e0e3(0x1dd)+numberWithCommas(xBMAllocated)+'\x22\x20style=\x22color:#fff;background:#002d63;\x22></div></div>',_0x22d84a+=_0x29e0e3(0x1cb)+numberWithCommas(xTotalPrice)+_0x29e0e3(0x180);xBalance>=0x0?_0x22d84a+=_0x29e0e3(0x1ac)+numberWithCommas(xBalance)+_0x29e0e3(0x1ce):_0x22d84a+=_0x29e0e3(0x1ac)+numberWithCommas(xBalance)+_0x29e0e3(0x11b);_0x22d84a+='</div>',_0x22d84a+=_0x29e0e3(0x103);var _0x195a8d=xBMAllocated-xTotalPrice;if(xBMAllocated-xTotalPrice>0x0){_0x22d84a+=_0x29e0e3(0x1e6);if(xBMStatus==0x0||xBMStatus==0x1)xTotalUnitPrice!=0x0?(xTotalUnitPrice!=0x0&&(_0x22d84a+=_0x29e0e3(0x131)+gID+_0x29e0e3(0x1cd)),_0x22d84a+='<div\x20class=\x22btn-z1\x22\x20onclick=\x22SaveOrder(\x27'+gID+_0x29e0e3(0x18e)):(_0x22d84a+=_0x29e0e3(0x15f),_0x22d84a+=_0x29e0e3(0x10b));else{if(xBMStatus==0x2)_0x22d84a+=_0x29e0e3(0x1e9)+gID+_0x29e0e3(0x151),_0x22d84a+=_0x29e0e3(0x10b),_0x22d84a+=_0x29e0e3(0x19d);else{if(xBMStatus==0x3)xTotalUnitPrice!=0x0&&(_0x22d84a+=_0x29e0e3(0x10e)+gID+_0x29e0e3(0x18e),_0x22d84a+=_0x29e0e3(0x13d)+zZoneMemoToBM+_0x29e0e3(0x104));else xBMStatus==0x9?(_0x22d84a+=_0x29e0e3(0x120)+gID+_0x29e0e3(0x1bb),_0x22d84a+=_0x29e0e3(0x16f)):(_0x22d84a+='<div\x20class=\x22btn-z0\x22\x20onclick=\x22ViewOrder(\x27'+gID+_0x29e0e3(0x151),_0x22d84a+='<div\x20style=\x22font-weight:600;\x22>รายการอยู่ระหว่างการขออนุมัติการสั่งจองของขวัญปีใหม่<br></div>');}}_0x22d84a+='</div>';}else alert(_0x29e0e3(0x173)+numberWithCommas(xBMAllocated)+'\x20บาท\x0aยอดสั่งของขวัญของคุณ\x20'+numberWithCommas(xTotalPrice)+_0x29e0e3(0x1d8)+numberWithCommas(_0x195a8d)+_0x29e0e3(0xfb)),_0x22d84a+=_0x29e0e3(0x1da);_0x22d84a+=_0x29e0e3(0x1bd)+xBMName+_0x29e0e3(0x12f)+xBranchName+'</b></div>',$(_0x29e0e3(0x1d2))['html'](_0x22d84a);}function _0xfb3f(_0x8c4a3f,_0x3877b6){var _0x539d4c=_0x539d();return _0xfb3f=function(_0xfb3ff1,_0x27be96){_0xfb3ff1=_0xfb3ff1-0xf8;var _0x4bd438=_0x539d4c[_0xfb3ff1];return _0x4bd438;},_0xfb3f(_0x8c4a3f,_0x3877b6);}function DisplayGift(_0x4272c1){var _0x7e1f50=_0x588902,_0x354a32='';dbGiftStock[_0x7e1f50(0x1d6)](firebase[_0x7e1f50(0x10d)]['FieldPath'][_0x7e1f50(0x153)](),'==',_0x4272c1)[_0x7e1f50(0x139)]()[_0x7e1f50(0x147)](_0x423cac=>{var _0x39261d=_0x7e1f50;_0x423cac[_0x39261d(0x1c2)](_0x255544=>{var _0x5048e2=_0x39261d;_0x354a32+=_0x5048e2(0x124),_0x354a32+='<div><img\x20src=\x22'+_0x255544[_0x5048e2(0x1b4)]()['StockImg']+_0x5048e2(0x161),_0x354a32+='<div\x20style=\x22font-weight:600;\x22>'+_0x255544['data']()['StockName']+'</div>',_0x354a32+=_0x5048e2(0x1a0)+_0x255544[_0x5048e2(0x1b4)]()[_0x5048e2(0x110)]+_0x5048e2(0x104),_0x354a32+=_0x5048e2(0x116)+_0x255544['data']()[_0x5048e2(0x1b6)]+_0x5048e2(0x183),_0x354a32+='',_0x354a32+='',_0x354a32+=_0x5048e2(0x103),_0x354a32+=_0x5048e2(0x15d);}),$('#DisplayGift')[_0x39261d(0x1b7)](_0x354a32);}),document[_0x7e1f50(0x14d)]('id03')['style'][_0x7e1f50(0x111)]=_0x7e1f50(0x1ca);}function DeleteAllOrder(_0x4d59b4){var _0x319eda=_0x588902;dbGiftOrder[_0x319eda(0x1d6)](_0x319eda(0x10f),'==',_0x4d59b4)['get']()[_0x319eda(0x147)](_0x2d1f14=>{var _0x597511=_0x319eda;_0x2d1f14['forEach'](_0x2fb2d2=>{var _0x449f78=_0xfb3f;dbGiftOrder[_0x449f78(0x169)]()[_0x449f78(0x119)](),DeleteRefID(_0x2fb2d2['id']);}),console[_0x597511(0x18b)](_0x597511(0x170)+gID);var _0xd78c1f=0x3e8;setTimeout(function(){var _0x2bd660=_0x597511;dbNewyearData[_0x2bd660(0x169)](gID)[_0x2bd660(0x1d3)]({'BMStatus':0x0,'TotalOrders':0x0,'UseBudget':0x0,'BMBalance':0x0});},_0xd78c1f);var _0x2e7290=0x7d0;setTimeout(function(){var _0x4f64bb=_0x597511;alert(_0x4f64bb(0x1c0)),location[_0x4f64bb(0x168)]='ordergift.html?gid='+gID;},_0x2e7290);});}function DeleteRefID(_0x3cd31a){var _0x47368f=_0x588902;dbGiftOrder[_0x47368f(0x169)](_0x3cd31a)[_0x47368f(0x119)](),console[_0x47368f(0x18b)](_0x3cd31a);}function ViewOrder(_0x1314fc){var _0x595978=_0x588902,_0x5798fd='',_0x22752d=0x0,_0x578a29=0x0;_0x5798fd+=_0x595978(0x118),_0x5798fd+='<div\x20style=\x22line-height:1.3;\x20text-align:left;\x20font-weight:600;\x22>สาขา\x20:\x20'+xBranchName+'<br>BM\x20:\x20'+xBMName+_0x595978(0x104),_0x5798fd+='<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;margin-top:10px;\x22>',_0x5798fd+=_0x595978(0x1b0),_0x5798fd+=_0x595978(0x143),dbGiftOrder[_0x595978(0x1d6)](_0x595978(0x10f),'==',_0x1314fc)[_0x595978(0x12c)](_0x595978(0x1ea),_0x595978(0x1aa))[_0x595978(0x139)]()[_0x595978(0x147)](_0x318184=>{var _0x5697b8=_0x595978;_0x318184['forEach'](_0xaf5840=>{var _0x23640d=_0xfb3f;_0x22752d=_0x22752d+_0xaf5840[_0x23640d(0x1b4)]()[_0x23640d(0x10c)],_0x578a29=_0x578a29+_0xaf5840[_0x23640d(0x1b4)]()[_0x23640d(0x10c)]*_0xaf5840[_0x23640d(0x1b4)]()[_0x23640d(0x1b6)],_0x5798fd+=_0x23640d(0x1eb)+_0xaf5840[_0x23640d(0x1b4)]()[_0x23640d(0x1ea)]+'</th>',_0x5798fd+='<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;\x22>'+_0xaf5840[_0x23640d(0x1b4)]()['OrderGift']+_0x23640d(0x1d1),_0x5798fd+=_0x23640d(0x179)+numberWithCommas(_0xaf5840[_0x23640d(0x1b4)]()[_0x23640d(0x10c)]*_0xaf5840[_0x23640d(0x1b4)]()['PointRedeem'])+_0x23640d(0x145);}),_0x5798fd+=_0x5697b8(0x17e),_0x5798fd+=_0x5697b8(0x191)+addCommas(_0x22752d)+_0x5697b8(0x1d1),_0x5798fd+=_0x5697b8(0x191)+numberWithCommas(_0x578a29)+_0x5697b8(0x145),_0x5798fd+='<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#e831e8;\x22>'+numberWithCommas(xBMAllocated)+'</td></tr>',_0x5798fd+=_0x5697b8(0x11e)+numberWithCommas(_0x578a29)+_0x5697b8(0x145),_0x5798fd+=_0x5697b8(0x137)+numberWithCommas(xBMAllocated-_0x578a29)+'</td></tr>',_0x5798fd+='</tbody></table>',_0x5798fd+=_0x5697b8(0x114),$(_0x5697b8(0x19b))[_0x5697b8(0x1b7)](_0x5798fd);}),document[_0x595978(0x14d)](_0x595978(0x18c))[_0x595978(0x19c)][_0x595978(0x111)]='block';}function SaveOrder(){var _0x52ecc1=_0x588902;LoadDetail();var _0x296b3d=0x0,_0xc936d9=0x0,_0x92550e='',_0xdacb63=0x0,_0x2e5355='';console[_0x52ecc1(0x18b)](xMaxGift);for(let _0x4f0bc6=0x0;_0x4f0bc6<xMaxGift;_0x4f0bc6++){var _0xcd1a3=document['getElementById'](_0x52ecc1(0x1c5)+_0x4f0bc6)[_0x52ecc1(0x162)]*document[_0x52ecc1(0x14d)](_0x52ecc1(0x167)+_0x4f0bc6)[_0x52ecc1(0x162)];SaveGift(document['getElementById'](_0x52ecc1(0x1c8)+_0x4f0bc6)[_0x52ecc1(0x162)],document[_0x52ecc1(0x14d)](_0x52ecc1(0x167)+_0x4f0bc6)['value'],document[_0x52ecc1(0x14d)](_0x52ecc1(0x1c5)+_0x4f0bc6)[_0x52ecc1(0x162)],_0xcd1a3,document[_0x52ecc1(0x14d)](_0x52ecc1(0x17d)+_0x4f0bc6)[_0x52ecc1(0x162)]);}}var xSumMoney=0x0;function SaveGift(_0x3490f0,_0x4ed98d,_0x1cd901,_0x2f1424,_0x3867b6){var _0x2d930=_0x588902;document[_0x2d930(0x14d)]('ShowNav')[_0x2d930(0x19c)]['display']=_0x2d930(0xfe),LoadDetail(),xSumMoney=0x0;var _0x568e46='',_0x303638='',_0x405318=0x0;xSumMoney=xSumMoney+xTotalPrice,dbGiftOrder[_0x2d930(0x1d6)]('RefID','==',gID)[_0x2d930(0x1d6)]('RefGift','==',_0x3490f0)[_0x2d930(0x139)]()[_0x2d930(0x147)](_0x3de835=>{var _0x69c9b3=_0x2d930;_0x3de835['forEach'](_0xccaf9c=>{_0x303638=_0xccaf9c['id'],_0x405318=0x1;});if(_0x1cd901==0x0)dbGiftOrder['doc'](_0x303638)[_0x69c9b3(0x119)]();else{if(_0x405318==0x1){var _0x230608=parseFloat(_0x1cd901*_0x4ed98d);dbGiftOrder[_0x69c9b3(0x169)](_0x303638)[_0x69c9b3(0x1d3)]({'OrderGift':parseFloat(_0x1cd901),'OrderPrice':parseFloat(_0x1cd901*_0x4ed98d),'PointRedeem':parseFloat(_0x4ed98d)});}else dbGiftOrder[_0x69c9b3(0x1ad)]({'RefID':gID,'RefGift':_0x3490f0,'EmpID':xBMEmpID,'EmpName':xBMName,'EmpBR':xBranchName,'EmpZone':xZone,'EmpRH':xRH,'OrderGift':parseFloat(_0x1cd901),'OrderPrice':parseFloat(_0x1cd901*_0x4ed98d),'PointRedeem':parseFloat(_0x4ed98d),'StockName':_0x3867b6});}});var _0x461356=0x0,_0x425106=0x0;_0x568e46+=_0x2d930(0x1d9),_0x568e46+='<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;\x20margin-top:20px;\x22>',_0x568e46+='<thead><tr\x20style=\x22text-align:\x20center;background-color:\x20#93a3c1;\x22>',_0x568e46+=_0x2d930(0x143);for(let _0x7e5dc8=0x0;_0x7e5dc8<xMaxGift;_0x7e5dc8++){document['getElementById']('OrderGiftID'+_0x7e5dc8)['value']!=0x0&&(_0x568e46+=_0x2d930(0x1eb)+document[_0x2d930(0x14d)](_0x2d930(0x17d)+_0x7e5dc8)[_0x2d930(0x162)]+_0x2d930(0x13e),_0x568e46+=_0x2d930(0x179)+document[_0x2d930(0x14d)](_0x2d930(0x1c5)+_0x7e5dc8)['value']+_0x2d930(0x1d1),_0x568e46+=_0x2d930(0x179)+numberWithCommas(document[_0x2d930(0x14d)](_0x2d930(0x1c5)+_0x7e5dc8)[_0x2d930(0x162)]*document[_0x2d930(0x14d)]('UnitPrice'+_0x7e5dc8)['value'])+_0x2d930(0x145),_0x425106++);}_0x568e46+=_0x2d930(0x1a4)+numberWithCommas(xSumMoney)+'</td></tr>',_0x568e46+=_0x2d930(0x13c)+numberWithCommas(xBMAllocated)+_0x2d930(0x145),_0x568e46+='<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณคงเหลือ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#0056ff;\x22>'+numberWithCommas(xBMAllocated-xSumMoney)+_0x2d930(0x187),_0x568e46+=_0x2d930(0x178),_0x568e46+=_0x2d930(0x154)+zBM_Address+'</textarea></center></div>',_0x568e46+=_0x2d930(0x1a5)+zBM_Phone+_0x2d930(0x138),_0x568e46+=_0x2d930(0x133)+zEmpID_Staff1+_0x2d930(0x138),_0x568e46+=_0x2d930(0x182)+zEmpName_Staff1+'\x22\x20style=\x22text-align:left;\x22></div>',_0x568e46+=_0x2d930(0x1d4)+zPhone_Staff1+_0x2d930(0x138),_0x568e46+=_0x2d930(0x11c)+zEmpID_Staff2+'\x22\x20style=\x22text-align:left;\x22></div>',_0x568e46+=_0x2d930(0x1a8)+zEmpName_Staff2+_0x2d930(0x138),_0x568e46+=_0x2d930(0x149)+zPhone_Staff2+'\x22\x20style=\x22text-align:left;\x22></div>',_0x568e46+='<div\x20class=\x22btn-z1\x22\x20onclick=\x22SaveDetail(\x27'+gID+_0x2d930(0x18d),_0x568e46+=_0x2d930(0x135),_0x568e46+='<div\x20class=\x22clr\x22></div>',_0x568e46+=_0x2d930(0x1ed)+gID+'\x27)\x22\x20style=\x22width:56%;margin:-10px\x20auto\x2020px\x20auto;display:none\x22\x20id=\x22idSendZoneApprove\x22>ส่งคำขอ<br>ให้โซนอนุมัติ</div>',$(_0x2d930(0x11a))['html'](_0x568e46),$(_0x2d930(0x150))[_0x2d930(0x115)](_0x2d930(0x1a2));var _0x3456a2=_0x2d930(0x16d)+dateString+'<br>',_0x4eece1=0x3e8;setTimeout(function(){var _0x28b318=_0x2d930;dbNewyearData[_0x28b318(0x169)](gID)[_0x28b318(0x1d3)]({'BMStatus':0x1,'BMBalance':parseFloat(xBMAllocated-xSumMoney),'TotalOrders':parseFloat(_0x425106),'TotalOrders':parseFloat(xTotalUnitPrice),'UseBudget':parseFloat(xTotalPrice),'BM_Memo':_0x3456a2});},_0x4eece1),document[_0x2d930(0x14d)](_0x2d930(0x1ec))[_0x2d930(0x19c)]['display']=_0x2d930(0x1ca);}function SaveToZone(){var _0x59711f=_0x588902,_0x19c55b=0x0,_0xaa13be=0x0;dbNewyearData[_0x59711f(0x169)](gID)[_0x59711f(0x1d3)]({'BMStatus':0x2}),str+=_0x59711f(0x166),str+=_0x59711f(0x195),str+=_0x59711f(0x1b0),str+=_0x59711f(0x143);for(let _0xceed88=0x0;_0xceed88<xMaxGift;_0xceed88++){document[_0x59711f(0x14d)](_0x59711f(0x1c5)+_0xceed88)[_0x59711f(0x162)]!=0x0&&(str+=_0x59711f(0x1eb)+document[_0x59711f(0x14d)]('NameGift'+_0xceed88)[_0x59711f(0x162)]+'</th>',str+=_0x59711f(0x179)+document[_0x59711f(0x14d)](_0x59711f(0x1c5)+_0xceed88)[_0x59711f(0x162)]+_0x59711f(0x1d1),str+=_0x59711f(0x179)+numberWithCommas(document[_0x59711f(0x14d)]('OrderGiftID'+_0xceed88)[_0x59711f(0x162)]*document['getElementById'](_0x59711f(0x167)+_0xceed88)['value'])+_0x59711f(0x145),_0xaa13be++);}str+=_0x59711f(0x192)+numberWithCommas(xSumMoney)+_0x59711f(0x145),str+=_0x59711f(0x13c)+numberWithCommas(xBMAllocated)+_0x59711f(0x145),str+=_0x59711f(0x137)+numberWithCommas(xBMAllocated-xSumMoney)+_0x59711f(0x187),str+='<div\x20class=\x22txtmsg\x22>ขณะนี้รายการการจัดซื้อของขวัญของสาขา\x20อยู่ระหว่างการอนุมัติโดยโซนที่ดูแลสาขาของท่าน\x20กรุณารอการอนุมัติ</div>',str+=_0x59711f(0x18a),$(_0x59711f(0x174))['html'](str),document[_0x59711f(0x14d)](_0x59711f(0xfd))[_0x59711f(0x19c)][_0x59711f(0x111)]=_0x59711f(0x1ca);}function GotoOrder(){var _0xe31550=_0x588902;location[_0xe31550(0x168)]=_0xe31550(0x13b);}function SaveDetail(){var _0x246c6b=_0x588902,_0x13c62f=document[_0x246c6b(0x14d)]('txtBM_Address')['value'],_0x30b9e5=document['getElementById'](_0x246c6b(0x1a7))['value'],_0x1b2ce9=document['getElementById']('txtEmpID_Staff1')[_0x246c6b(0x162)],_0x293ee8=document[_0x246c6b(0x14d)](_0x246c6b(0x19a))[_0x246c6b(0x162)],_0x6be781=document['getElementById'](_0x246c6b(0x15e))[_0x246c6b(0x162)],_0x47066a=document[_0x246c6b(0x14d)](_0x246c6b(0x186))[_0x246c6b(0x162)],_0xe43612=document['getElementById'](_0x246c6b(0x18f))[_0x246c6b(0x162)],_0x42473c=document[_0x246c6b(0x14d)](_0x246c6b(0x184))[_0x246c6b(0x162)];_0x13c62f==''||_0x30b9e5==''||_0x1b2ce9==''||_0x293ee8==''||_0x6be781==''||_0x47066a==''||_0xe43612==''||_0x42473c==''?alert('คุณยังกรอกข้อมูลไม่ครบถ้วน'):(dbNewyearData['doc'](gID)[_0x246c6b(0x1d3)]({'BM_Address':document['getElementById'](_0x246c6b(0x1de))[_0x246c6b(0x162)],'BM_Phone':document[_0x246c6b(0x14d)](_0x246c6b(0x1a7))['value'],'EmpID_Staff1':document[_0x246c6b(0x14d)](_0x246c6b(0x199))[_0x246c6b(0x162)],'EmpName_Staff1':document[_0x246c6b(0x14d)]('txtEmpName_Staff1')[_0x246c6b(0x162)],'Phone_Staff1':document[_0x246c6b(0x14d)](_0x246c6b(0x15e))[_0x246c6b(0x162)],'EmpID_Staff2':document['getElementById'](_0x246c6b(0x186))['value'],'EmpName_Staff2':document[_0x246c6b(0x14d)](_0x246c6b(0x18f))[_0x246c6b(0x162)],'Phone_Staff2':document['getElementById']('txtPhone_Staff2')['value']}),alert(_0x246c6b(0x1e5)),LoadDetail(),document[_0x246c6b(0x14d)]('idSendZoneApprove')[_0x246c6b(0x19c)][_0x246c6b(0x111)]=_0x246c6b(0x1ca));}function addCommas(_0x4528d8){var _0x2820ec=_0x588902;_0x4528d8+='',x=_0x4528d8['split']('.'),x1=x[0x0],x2=x[_0x2820ec(0x177)]>0x1?'.'+x[0x1]:'';var _0x34a334=/(\d+)(\d{3})/;while(_0x34a334[_0x2820ec(0x189)](x1)){x1=x1[_0x2820ec(0x132)](_0x34a334,'$1'+','+'$2');}return x1+x2;}function numberWithCommas(_0x244e56){var _0x392101=_0x588902,_0x6b7d17=_0x244e56,_0x4f0237=parseFloat(_0x6b7d17)[_0x392101(0x13a)](0x2);return formattedString=_0x4f0237[_0x392101(0x1c7)]()[_0x392101(0x132)](/\B(?=(\d{3})+(?!\d))/g,',');}function CloseAll(){var _0xeccf82=_0x588902;document['getElementById'](_0xeccf82(0x194))[_0xeccf82(0x19c)]['display']='block',document['getElementById'](_0xeccf82(0x1ec))[_0xeccf82(0x19c)][_0xeccf82(0x111)]=_0xeccf82(0xfe),document[_0xeccf82(0x14d)](_0xeccf82(0xfd))['style'][_0xeccf82(0x111)]=_0xeccf82(0xfe),document[_0xeccf82(0x14d)](_0xeccf82(0x18c))['style'][_0xeccf82(0x111)]=_0xeccf82(0xfe);}
