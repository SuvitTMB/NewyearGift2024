var _0x526741=_0x330e;(function(_0x24f762,_0x15fced){var _0x2862e2=_0x330e,_0x122b1c=_0x24f762();while(!![]){try{var _0x335cfb=-parseInt(_0x2862e2(0x153))/0x1+parseInt(_0x2862e2(0x8e))/0x2*(-parseInt(_0x2862e2(0x10f))/0x3)+parseInt(_0x2862e2(0x12e))/0x4*(-parseInt(_0x2862e2(0x109))/0x5)+-parseInt(_0x2862e2(0xd3))/0x6*(-parseInt(_0x2862e2(0x12b))/0x7)+-parseInt(_0x2862e2(0x8d))/0x8*(-parseInt(_0x2862e2(0x108))/0x9)+-parseInt(_0x2862e2(0xc9))/0xa+parseInt(_0x2862e2(0xef))/0xb;if(_0x335cfb===_0x15fced)break;else _0x122b1c['push'](_0x122b1c['shift']());}catch(_0x3f5a6e){_0x122b1c['push'](_0x122b1c['shift']());}}}(_0x1733,0x7854d));var dateString=new Date()[_0x526741(0x16c)]('en-US',{'timeZone':_0x526741(0x141)}),today=new Date(),dd=String(today[_0x526741(0x94)]())[_0x526741(0x15e)](0x2,'0'),mm=String(today[_0x526741(0x127)]()+0x1)[_0x526741(0x15e)](0x2,'0'),yyyy=today[_0x526741(0x9c)]()+0x21f,gID,gStatus,xMaxGift=0x0,xNewyearLimit=0x16,xOrderLimit=0x64,xBMStatus=0x0,xSendZoneApprove=0x0,zBM_Address='',zBM_Phone='',zEmpID_Staff1='',zEmpName_Staff1='',zPhone_Staff1='',zEmpID_Staff2='',zEmpName_Staff2='',zPhone_Staff2='',zZoneMemoToBM='';$(document)[_0x526741(0x15a)](function(){var _0x422674=_0x526741;sessionStorage['getItem'](_0x422674(0x15d))==null&&(location['href']=_0x422674(0x97)),gID=getParameterByName('gid'),gStatus=getParameterByName('gStatus'),Connect_DB(),dbNewyearData=firebase[_0x422674(0x112)]()[_0x422674(0xf3)]('Newyear2024_data'),dbGiftStock=firebase[_0x422674(0x112)]()[_0x422674(0xf3)]('Newyear2024_gift'),dbGiftOrder=firebase[_0x422674(0x112)]()[_0x422674(0xf3)](_0x422674(0x11a)),CheckBudget(),GetUserOrder(gID),LoadGiftStock();});function getParameterByName(_0x365f2d,_0xdc183e){var _0x1cbba9=_0x526741;str='';if(!_0xdc183e)_0xdc183e=window[_0x1cbba9(0xdc)][_0x1cbba9(0xfc)];_0x365f2d=_0x365f2d[_0x1cbba9(0xce)](/[\[\]]/g,_0x1cbba9(0x16e));var _0x406636=new RegExp(_0x1cbba9(0x7f)+_0x365f2d+_0x1cbba9(0xeb)),_0x301e80=_0x406636[_0x1cbba9(0x8b)](_0xdc183e);if(!_0x301e80)return null;if(!_0x301e80[0x2])return'';return decodeURIComponent(_0x301e80[0x2][_0x1cbba9(0xce)](/\+/g,'\x20'));}function LoadDetail(){var _0x175f37=_0x526741;dbNewyearData[_0x175f37(0x96)](firebase[_0x175f37(0x112)]['FieldPath'][_0x175f37(0x9f)](),'==',gID)[_0x175f37(0xe5)]()[_0x175f37(0x14d)](_0x4151b2=>{_0x4151b2['forEach'](_0x55ebe9=>{var _0x2e9878=_0x330e;xBMStatus=_0x55ebe9[_0x2e9878(0x15b)]()[_0x2e9878(0x13d)],zBM_Address=_0x55ebe9[_0x2e9878(0x15b)]()[_0x2e9878(0x167)],zBM_Phone=_0x55ebe9[_0x2e9878(0x15b)]()[_0x2e9878(0xdd)],zEmpID_Staff1=_0x55ebe9[_0x2e9878(0x15b)]()['EmpID_Staff1'],zEmpName_Staff1=_0x55ebe9[_0x2e9878(0x15b)]()['EmpName_Staff1'],zPhone_Staff1=_0x55ebe9['data']()[_0x2e9878(0x160)],zEmpID_Staff2=_0x55ebe9['data']()['EmpID_Staff2'],zEmpName_Staff2=_0x55ebe9['data']()[_0x2e9878(0x8a)],zPhone_Staff2=_0x55ebe9[_0x2e9878(0x15b)]()['Phone_Staff2'],zZoneMemoToBM=_0x55ebe9[_0x2e9878(0x15b)]()[_0x2e9878(0xf1)];});});}var xBMAllocated=0x0,xBMEmpID='',xBMName='',xBranchName='',xZone='',xRH='';function CheckBudget(){var _0x12952b=_0x526741,_0x3c18fa='',_0x5adfc7='';_0x3c18fa+=_0x12952b(0x6d),_0x3c18fa+=_0x12952b(0x135),_0x3c18fa+=_0x12952b(0xf6),dbNewyearData[_0x12952b(0x96)](firebase[_0x12952b(0x112)][_0x12952b(0xe6)]['documentId'](),'==',gID)[_0x12952b(0xe5)]()[_0x12952b(0x14d)](_0x57819e=>{var _0x1f7638=_0x12952b;_0x57819e[_0x1f7638(0x146)](_0x6e7b5f=>{var _0x179c5d=_0x1f7638;xBMStatus=_0x6e7b5f['data']()[_0x179c5d(0x13d)];if(_0x6e7b5f[_0x179c5d(0x15b)]()['BMStatus']==0x0)xMsg='คลิก<br>สั่งจอง',_0x5adfc7=_0x179c5d(0x10a);else{if(_0x6e7b5f[_0x179c5d(0x15b)]()['BMStatus']==0x1)xMsg=_0x179c5d(0x11b),_0x5adfc7=_0x179c5d(0x75);else{if(_0x6e7b5f[_0x179c5d(0x15b)]()[_0x179c5d(0x13d)]==0x2)xMsg=_0x179c5d(0x6a),_0x5adfc7=_0x179c5d(0xb1);else{if(_0x6e7b5f['data']()[_0x179c5d(0x13d)]==0x3)xMsg=_0x179c5d(0x130),_0x5adfc7='<font\x20color=\x27#ff0000\x27><b>โซนแจ้งทบทวนใหม่</b></font>';else{if(_0x6e7b5f[_0x179c5d(0x15b)]()['BMStatus']==0x8)xMsg='โซนแจ้ง<br>ยกเลิก',_0x5adfc7=_0x179c5d(0xbf);else _0x6e7b5f[_0x179c5d(0x15b)]()[_0x179c5d(0x13d)]==0x9&&(xMsg=_0x179c5d(0x10c),_0x5adfc7=_0x179c5d(0xaf));}}}}xBMEmpID=_0x6e7b5f[_0x179c5d(0x15b)]()[_0x179c5d(0x9a)],xBMName=_0x6e7b5f['data']()[_0x179c5d(0x134)],xBranchName=_0x6e7b5f[_0x179c5d(0x15b)]()[_0x179c5d(0xa9)]+'\x20('+_0x6e7b5f[_0x179c5d(0x15b)]()[_0x179c5d(0xba)]+')',xZone=_0x6e7b5f[_0x179c5d(0x15b)]()[_0x179c5d(0x156)],xRH=_0x6e7b5f[_0x179c5d(0x15b)]()[_0x179c5d(0x110)],_0x3c18fa+='<tr>',_0x3c18fa+='<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สาขา</td>',_0x3c18fa+=_0x179c5d(0x10d)+_0x6e7b5f['data']()[_0x179c5d(0xa9)]+'\x20('+_0x6e7b5f[_0x179c5d(0x15b)]()[_0x179c5d(0xba)]+_0x179c5d(0x142),_0x3c18fa+=_0x179c5d(0xd9),_0x3c18fa+='<td\x20style=\x22text-align:\x20center;background:#c4d0e2;\x22><b>'+_0x6e7b5f[_0x179c5d(0x15b)]()[_0x179c5d(0x134)]+'</b></td></tr>',_0x3c18fa+=_0x179c5d(0x8f),_0x3c18fa+='<td\x20style=\x22text-align:\x20center;background:#c4d0e2;\x22><b>'+_0x5adfc7+_0x179c5d(0x83),_0x3c18fa+=_0x179c5d(0xb7),_0x3c18fa+=_0x179c5d(0x10d)+numberWithCommas(_0x6e7b5f[_0x179c5d(0x15b)]()[_0x179c5d(0xb0)])+_0x179c5d(0xde),_0x3c18fa+='<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สั่งไปแล้ว</td>',_0x3c18fa+='<td\x20style=\x22text-align:\x20center;background:#c4d0e2;\x22><b>'+numberWithCommas(_0x6e7b5f[_0x179c5d(0x15b)]()[_0x179c5d(0x133)])+'\x20บาท</b></td></tr>',xBMAllocated=_0x6e7b5f[_0x179c5d(0x15b)]()[_0x179c5d(0xb0)];}),_0x3c18fa+='</tbody></table></div>',_0x3c18fa+='<div\x20class=\x22clr\x22></div>',$(_0x1f7638(0x163))[_0x1f7638(0xd2)](_0x3c18fa);});}var GetOrderArr=[];function GetUserOrder(_0x2e3f90){var _0x4be138=_0x526741,_0x2afb09=0x0;dbGiftOrder[_0x4be138(0x96)](_0x4be138(0xf7),'==',_0x2e3f90)[_0x4be138(0xe5)]()[_0x4be138(0x14d)](_0x287618=>{var _0x545751=_0x4be138;_0x287618[_0x545751(0x146)](_0x3a4062=>{var _0x1e9730=_0x545751;GetOrderArr[_0x1e9730(0x6b)]({'RefGift':_0x3a4062['data']()['RefGift'],'StockName':_0x3a4062['data']()[_0x1e9730(0x123)],'OrderGift':_0x3a4062[_0x1e9730(0x15b)]()['OrderGift'],'ID':_0x3a4062['id']});});});}var xCheckOrder=0x0,xCountRec=0x0,xSumAllPrice=0x0,xSumUnitPrice=0x0,xTotalUnitPrice=0x0,xBalance=0x0;function _0x330e(_0x833ef0,_0x4a6082){var _0x17331e=_0x1733();return _0x330e=function(_0x330e3f,_0x361b6d){_0x330e3f=_0x330e3f-0x68;var _0x29bc82=_0x17331e[_0x330e3f];return _0x29bc82;},_0x330e(_0x833ef0,_0x4a6082);}function _0x1733(){var _0x174f85=['<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;background:#73a0f4;\x22>','\x22\x20value=\x22','\x22\x20readonly></div></div>','\x27)\x22><img\x20src=\x22./img/icon-02.png\x22\x20style=\x22width:20px;\x22></div></th>','OrderGiftID10','id03','<div\x20style=\x22font-weight:400;\x20text-align:left;\x20padding-top:10px;\x22>','<div\x20class=\x22btn-z0\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>ทำการแก้ไข<br>ใหม่อีกครั้ง</div>','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>บันทึกการสั่งจองของขวัญปีใหม่</div>','5640010gEgkcy','#DisplayGift','StockGroup','OrderGiftID14','update','replace','txtPhone_Staff2','\x22\x20readonly></div>','txtPhone_Staff1','html','6pbKJYS','<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;\x22>','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>รวมทั้งหมด</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#31e85b;\x22>','<div\x20class=\x22btn-t2\x22\x20onclick=location.href=\x22home.html\x22\x20type=\x22submit\x22\x20style=\x22margin-top:20px;\x22>ไม่บันทึกรายการ</div>','#SumUnitPrice7','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>จำนวนเงินที่สั่ง</div><input\x20type=\x22text\x22\x20value=\x22','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>BM</td>','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>จำนวนเงินที่ใช้</div><div\x20class=\x22box-order\x22\x20id=\x22SumUnitPrice','txtEmpName_Staff2','location','BM_Phone','\x20บาท</b></td></tr>','\x22\x20style=\x22color:#fff;background:#13c33b;\x22></div></div>','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายการสั่งซื้อ<br>ของขวัญปีใหม่</div>','UnitPrice15','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;\x22><div\x20onclick=\x22DisplayGift(\x27','</td>','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>','get','FieldPath','#SumUnitPrice2','UnitPrice12','add','orderBy','(=([^&#]*)|&|#|$)','<th\x20scope=\x22col\x22>รายการ</th><th\x20scope=\x22col\x22>จำนวน</th><th\x20scope=\x22col\x22>ราคา</th></tr></thead><tbody>','id02','<div\x20class=\x22btn-z0\x22\x20style=\x22margin:10px\x2010px\x2020px\x20auto;min-width:100px;\x22>กรุณาสั่ง<br>ของขวัญปีใหม่</div>','8786932XmGwFB','<div\x20class=\x22txtmsg\x22>ขณะนี้รายการการจัดซื้อของขวัญของสาขา\x20อยู่ระหว่างการอนุมัติโดยโซนที่ดูแลสาขาของท่าน\x20กรุณารอการอนุมัติ</div>','ZoneMemoToBM','#SumUnitPrice10','collection','#SumUnitPrice3',')\x22\x20value=\x22','<th\x20scope=\x22col\x22>รายการ</th><th\x20scope=\x22col\x22>รายละเอียด</th></tr></thead><tbody>','RefID','#SumUnitPrice14','OrderGiftID7','</div><div\x20style=\x22margin-top:30px;padding-top:20px;margin-left:3px;\x22>','UnitPrice8','href','UnitPrice16','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกหมายเลขโทรศัพท์)</div><input\x20type=\x22text\x22\x20id=\x22txtPhone_Staff2\x22\x20value=\x22','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>เลือกจำนวนชิ้น</div>','OrderGiftID5','display','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>โทรศัพท์ผู้จัดการสาขา</div><input\x20type=\x22text\x22\x20id=\x22txtBM_Phone\x22\x20value=\x22','OrderGiftRefID','</tbody></table>','</b></div>','\x20บาท\x0aคุณสั่งเกินไปแล้ว\x20','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;\x22>','612vvElHO','64690JJDUJS','<font\x20color=\x27#555555\x27><b>ยังไม่ได้สั่งจอง</b></font>','\x27)\x22><font\x20color=\x22#0056ff\x22><b>','โซนแจ้ง<br>อนุมัติ','<td\x20style=\x22text-align:\x20center;background:#c4d0e2;\x22><b>','OrderGiftID17','116799NYCifp','EmpRH','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกรหัสพนักงาน)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpID_Staff1\x22\x20value=\x22','firestore','UnitPrice17','UnitPrice18','\x22\x20style=\x22text-align:left;\x22></div>','\x22\x20style=\x22color:#fff;background:#002d63;\x22></div></div>','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>บันทึกดร๊าฟ<br>รายการสั่งซื้อ</div>','\x20บาท</b></div>','</div>','Newyear2024_order','กำลัง<br>สั่งจอง','</tbody></table></div>','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20center;\x22>','PointRedeem','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>ยอดรวมการสั่งซื้อ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>','delete','<select\x20name=\x22OrderGiftID\x22\x20onchange=\x22CalGift()\x22\x20id=\x22OrderGiftID','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;\x20margin-top:20px;\x22>','StockName','บันทึกรายการแก้ไขรายการ\x20','<div\x20class=\x22clr\x22></div>','OrderGiftID2','getMonth','#SumUnitPrice5','idSendZoneApprove','<div\x20id=\x22ShowSaveData\x22\x20style=\x22display:block;margin-bottom:\x2020px;\x22>','4153177radKYm','UnitPrice9','#SumUnitPrice0','4acimeg','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>นำส่งรายการสั่งซื้อให้โซนอนุมัติ</div>','โซนแจ้ง<br>ทบทวน','OrderGiftID','value','UseBudget','BMName','<thead><tr\x20style=\x22text-align:\x20center;background-color:\x20#93a3c1;\x22>','ระบบได้ทำการลบรายการการสั่งจองของขวัญของคุณเรียบร้อยแล้ว','<div\x20style=\x22font-weight:600;\x20color:#ff0000;line-height:1.2;\x22><font\x20color=\x22#000000\x22>โซนแจ้งทำการทบทวนการสั่งจองใหม่อีกครั้ง</font><br>','id01','\x27)\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>บันทึกดร๊าฟ<br>ก่อนส่งโซน</div>','txtEmpName_Staff1','#SumUnitPrice17','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;\x22>','BMStatus','</td></tr></tbody></table>','#SumUnitPrice6','UnitPrice','Asia/Jakarta',')</b></td></tr>','\x22\x20style=\x22color:#fff;background:#0056ff;\x22></div></div>','UnitPrice6','#DisplaySaveToZone','forEach','NameGift','asc','OrderGiftID0','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกชื่อ-นามสกุล)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpName_Staff2\x22\x20value=\x22','StockOrder','UnitPrice1','then','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;background:#73a0f4;\x22>สรุปรายการสั่งซื้อ</th>','<br>','#SumUnitPrice16','home.html','UnitPrice11','574915qWgBsp','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายละเอียด<br>รายการสั่งซื้อ</div>','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>งบประมาณที่ได้รับ</div><input\x20type=\x22text\x22\x20value=\x22','EmpZone','log','<div><img\x20src=\x22','\x22\x20selected>','ready','data','<div\x20style=\x22font-weight:400;padding-top:10px;\x22>ราคาขายต่อชิ้น\x20<b>','EmpID_Newyear','padStart','txtBM_Address','Phone_Staff1','#SumUnitPrice13','#idSendZoneApprove','#DisplayBudget','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกรหัสพนักงาน)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpID_Staff2\x22\x20value=\x22','UnitPrice10','style','BM_Address','<div\x20style=\x22font-weight:600;\x22>รายการอยู่ระหว่างการขออนุมัติจากโซน<br></div>','txtEmpID_Staff1','\x20บาท\x0aระบบจะไม่อนุญาตให้บันทึกรายการสั่งจอง','RefGift','toLocaleString','<div\x20class=\x22btn-z1\x22\x20onclick=\x22SaveOrder(\x27','\x5c$&','<div\x20style=\x22line-height:1.3;\x20text-align:left;\x20font-weight:600;\x22>สาขา\x20:\x20','คุณยังกรอกข้อมูลไม่ครบถ้วน','<div\x20class=\x22btn-z3\x22\x20onclick=\x22SaveToZone(\x27','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;margin-top:10px;\x22>','</b><br>Branch\x20:\x20<b>','#SumUnitPrice11','ส่งโซน<br>ขออนุมัติ','push','getElementById','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22margin-top:20px;\x20background-color:\x20#fff;\x22>','UnitPrice4','OrderGiftID15','OrderGiftID11','\x22\x20hidden>','<center><div\x20class=\x22btn-t1\x22\x20onclick=\x22GotoOrder()\x22>ปิดหน้าต่างนี้</div></center>','OrderGiftID18','<div\x20class=\x22btn-t2\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:15px\x20auto\x2025px\x20auto;\x22>ปิดหน้าต่างนี้</div>','<font\x20color=\x27#f68b1f\x27><b>อยู่ระหว่างการสั่งจอง</b></font>','</b></font></div>','UnitPrice5','OrderGiftID12','OrderGiftID4','split','#SumUnitPrice15','<div\x20class=\x22btn-z9\x22\x20onclick=\x22ViewOrder(\x27','</tr>','#SumUnitPrice1','[?&]','<div\x20class=\x22btn-z1\x22\x20onclick=\x22SaveDetail(\x27','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกหมายเลขโทรศัพท์)</div><input\x20type=\x22text\x22\x20id=\x22txtPhone_Staff1\x22\x20value=\x22','toString','</b></td></tr>','OrderGiftID13','</th>','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>ราคาต่อชิ้น</div><input\x20type=\x22text\x22\x20id=\x22UnitPrice','UnitPrice7','txtEmpID_Staff2','OrderGiftID1','EmpName_Staff2','exec','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>ยอดงบคงเหลือ</div><input\x20type=\x22text\x22\x20value=\x22','48040qTESod','8DEazPT','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สถานะ</td>','</td></tr>','OrderGiftID16','<div\x20class=\x22btn-z1\x22\x20onclick=\x22GotoOrder()\x22\x20style=\x22margin:10px\x2010px\x2020px\x20auto;min-width:100px;\x22>กลับไป<br>หน้าแรก</div>','<div\x20style=\x22margin-top:4px;\x22>','getDate','\x22\x20style=\x22width:100%;margin-top:18px;margin-bottom:\x2010px;\x22></div></center>','where','index.html','<option\x20onchange=\x22CalGift(','\x20บาท\x0aยอดสั่งของขวัญของคุณ\x20','BMEmpID','#SumUnitPrice8','getFullYear','\x20ชิ้น</option>','\x27)\x22\x20style=\x22width:56%;margin:-10px\x20auto\x2020px\x20auto;display:none\x22\x20id=\x22idSendZoneApprove\x22>ส่งคำขอ<br>ให้โซนอนุมัติ</div>','documentId','doc','<div\x20class=\x22btn-z0\x22\x20onclick=\x22ViewOrder(\x27','StockStatus','StockDetail','none','<option\x20onchange=\x22CalGift(0)\x22\x20value=\x220\x22>รอการสั่ง</option>','<div\x20style=\x22font-weight:600;\x20color:#0056ff;\x22>รายการของท่านได้รับการอนุมัติจากโซน\x20เรียบร้อยแล้ว<br></div>','StockView','OrderGiftID6','BranchName','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>รายละเอียดเพิ่มเติม</div><div\x20class=\x22clr\x22></div>','OrderGift','UnitPrice13','block','<br>BM\x20:\x20','<font\x20color=\x27#28c92a\x27><b>โซนอนุมัติเรียบร้อยแล้ว</b></font>','BMAllocated','<font\x20color=\x27#0056ff\x27><b>ส่งโซนอนุมัติ</b></font>','ShowNav','UnitPrice3','UnitPrice14','OrderGiftID8','txtBM_Phone','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>งบสั่งจอง</td>','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณคงเหลือ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#0056ff;\x22>','length','BranchID','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ยกเลิก<br>รายการสั่งซื้อ</div>','disabledbutton','#SumUnitPrice4','OrderGiftID3','<font\x20color=\x27#ff0000\x27><b>โซนแจ้งขอยกเลิกการจอง</b></font>'];_0x1733=function(){return _0x174f85;};return _0x1733();}function LoadGiftStock(){var _0x387712=_0x526741;LoadDetail();var _0x44c2f0='',_0x8914c5=0x0,_0x4aa028=0x0;xSumAllPrice=0x0,xSumUnitPrice=0x0,xMaxGift=0x0,xCalSell=0x0,_0x44c2f0+=_0x387712(0x13c),_0x44c2f0+=_0x387712(0x135),_0x44c2f0+='<th\x20scope=\x22col\x22>No.</th><th\x20scope=\x22col\x22>รายการของขวัญ</th></tr></thead><tbody>',dbGiftStock[_0x387712(0x96)](_0x387712(0xa2),'==',0x1)[_0x387712(0xea)](_0x387712(0xcb),'asc')[_0x387712(0xea)](_0x387712(0x14b),_0x387712(0x148))['get']()[_0x387712(0x14d)](_0x5df5d9=>{var _0x13d010=_0x387712;_0x5df5d9[_0x13d010(0x146)](_0x476aad=>{var _0x18d8c3=_0x13d010;const _0xd56dd5=GetOrderArr['filter'](_0x18f772=>{var _0x93ad56=_0x330e;return _0x18f772[_0x93ad56(0x16b)]===_0x476aad['id'];});xResults=0x0,xCheckLine=0x0;_0xd56dd5[0x0]!=undefined&&(xResults=_0xd56dd5[0x0][_0x18d8c3(0xab)],xCheckOrder=parseFloat(xCheckOrder)+parseFloat(_0xd56dd5[0x0]['OrderGift']));_0x44c2f0+=_0x18d8c3(0x11d)+(_0x8914c5+0x1)+'<div\x20onclick=\x22DisplayGift(\x27'+_0x476aad['id']+_0x18d8c3(0xc3),_0x44c2f0+=_0x18d8c3(0xe2)+_0x476aad['id']+_0x18d8c3(0x10b)+_0x476aad[_0x18d8c3(0x15b)]()[_0x18d8c3(0x123)]+_0x18d8c3(0x76),_0x44c2f0+=_0x18d8c3(0x93),_0x44c2f0+=_0x18d8c3(0xff),_0x44c2f0+=_0x18d8c3(0x121)+_0x8914c5+_0x18d8c3(0xc1)+xResults+'\x22\x20class=\x22form-control\x22>';if(_0x476aad['data']()[_0x18d8c3(0xa7)]==0x1)for(let _0x308fd4=0x0;_0x308fd4<xNewyearLimit;_0x308fd4++){_0x308fd4==0x0?_0x44c2f0+='<option\x20onchange=\x22CalGift(0)\x22\x20value=\x220\x22>รอการสั่ง</option>':xResults==_0x308fd4*0x32?(xCheckLine=0x1,_0x44c2f0+=_0x18d8c3(0x98)+_0x308fd4+_0x18d8c3(0xf5)+_0xd56dd5[0x0][_0x18d8c3(0xab)]+'\x22\x20selected>'+_0xd56dd5[0x0][_0x18d8c3(0xab)]+'\x20ชิ้น</option>'):_0x44c2f0+='<option\x20onchange=\x22CalGift('+_0x308fd4+')\x22\x20value=\x22'+_0x308fd4*0x32+'\x22>'+_0x308fd4*0x32+_0x18d8c3(0x9d);}else{if(_0x476aad[_0x18d8c3(0x15b)]()['StockView']==0x2)for(let _0x222d54=0x0;_0x222d54<xOrderLimit+0x1;_0x222d54++){_0x222d54==0x0?_0x44c2f0+=_0x18d8c3(0xa5):xResults==_0x222d54?(xCheckLine=0x1,_0x44c2f0+='<option\x20onchange=\x22CalGift('+_0x222d54+_0x18d8c3(0xf5)+_0xd56dd5[0x0][_0x18d8c3(0xab)]+_0x18d8c3(0x159)+_0xd56dd5[0x0][_0x18d8c3(0xab)]+'\x20ชิ้น</option>'):_0x44c2f0+=_0x18d8c3(0x98)+_0x222d54+_0x18d8c3(0xf5)+_0x222d54+'\x22>'+_0x222d54+'\x20ชิ้น</option>';}}xCalSell+=xResults*_0x476aad[_0x18d8c3(0x15b)]()[_0x18d8c3(0x11e)],_0x44c2f0+='</select></div>',_0x44c2f0+=_0x18d8c3(0x86)+_0x8914c5+'\x22\x20value=\x22'+_0x476aad['data']()[_0x18d8c3(0x11e)]+_0x18d8c3(0xd0),_0x44c2f0+=_0x18d8c3(0xda)+_0x8914c5+_0x18d8c3(0xc1)+xResults*_0x476aad[_0x18d8c3(0x15b)]()[_0x18d8c3(0x11e)]+_0x18d8c3(0xc2),_0x44c2f0+='</td>',_0x44c2f0+=_0x18d8c3(0x7d),_0x44c2f0+='<input\x20type=\x22text\x22\x20id=\x22OrderGiftRefID'+_0x8914c5+'\x22\x20value=\x22'+_0x476aad['id']+_0x18d8c3(0x71),_0x44c2f0+='<input\x20type=\x22text\x22\x20id=\x22NameGift'+_0x8914c5+_0x18d8c3(0xc1)+_0x476aad[_0x18d8c3(0x15b)]()[_0x18d8c3(0x123)]+_0x18d8c3(0x71),_0x8914c5++,xMaxGift++;}),_0x44c2f0+=_0x13d010(0x11c),_0x44c2f0+=_0x13d010(0x125),$('#DisplayGroup2')[_0x13d010(0xd2)](_0x44c2f0),CalGift();});}var xTotalPrice=0x0;function CalGift(){var _0x440584=_0x526741,_0x113cf0=0x0,_0x4c024f='',_0x321d3b=0x0,_0x19ecd5=parseFloat(document['getElementById']('UnitPrice0')[_0x440584(0x132)]*document[_0x440584(0x6c)](_0x440584(0x149))[_0x440584(0x132)]),_0x21babb=parseFloat(document['getElementById'](_0x440584(0x14c))['value']*document[_0x440584(0x6c)]('OrderGiftID1')[_0x440584(0x132)]),_0x4149f7=parseFloat(document[_0x440584(0x6c)]('UnitPrice2')['value']*document[_0x440584(0x6c)](_0x440584(0x126))[_0x440584(0x132)]),_0x48a5a8=parseFloat(document['getElementById'](_0x440584(0xb3))[_0x440584(0x132)]*document[_0x440584(0x6c)](_0x440584(0xbe))[_0x440584(0x132)]),_0x26ff2c=parseFloat(document[_0x440584(0x6c)](_0x440584(0x6e))[_0x440584(0x132)]*document[_0x440584(0x6c)]('OrderGiftID4')['value']),_0x4e8560=parseFloat(document[_0x440584(0x6c)](_0x440584(0x77))['value']*document['getElementById'](_0x440584(0x100))[_0x440584(0x132)]),_0x11139c=parseFloat(document[_0x440584(0x6c)](_0x440584(0x144))['value']*document[_0x440584(0x6c)](_0x440584(0xa8))[_0x440584(0x132)]),_0x462afb=parseFloat(document[_0x440584(0x6c)](_0x440584(0x87))[_0x440584(0x132)]*document['getElementById']('OrderGiftID7')['value']),_0x1a9962=parseFloat(document[_0x440584(0x6c)](_0x440584(0xfb))[_0x440584(0x132)]*document[_0x440584(0x6c)](_0x440584(0xb5))['value']),_0x3d795a=parseFloat(document[_0x440584(0x6c)](_0x440584(0x12c))[_0x440584(0x132)]*document[_0x440584(0x6c)]('OrderGiftID9')[_0x440584(0x132)]),_0x296065=parseFloat(document[_0x440584(0x6c)](_0x440584(0x165))[_0x440584(0x132)]*document[_0x440584(0x6c)](_0x440584(0xc4))[_0x440584(0x132)]),_0x23a9ec=parseFloat(document[_0x440584(0x6c)](_0x440584(0x152))['value']*document[_0x440584(0x6c)](_0x440584(0x70))[_0x440584(0x132)]),_0x22bbe9=parseFloat(document[_0x440584(0x6c)](_0x440584(0xe8))[_0x440584(0x132)]*document[_0x440584(0x6c)](_0x440584(0x78))[_0x440584(0x132)]),_0x567b40=parseFloat(document['getElementById'](_0x440584(0xac))['value']*document[_0x440584(0x6c)](_0x440584(0x84))['value']),_0x1b9e26=parseFloat(document['getElementById'](_0x440584(0xb4))[_0x440584(0x132)]*document[_0x440584(0x6c)]('OrderGiftID14')[_0x440584(0x132)]),_0x4803dc=parseFloat(document[_0x440584(0x6c)](_0x440584(0xe1))[_0x440584(0x132)]*document[_0x440584(0x6c)](_0x440584(0x6f))[_0x440584(0x132)]),_0x59e12a=parseFloat(document['getElementById'](_0x440584(0xfd))[_0x440584(0x132)]*document[_0x440584(0x6c)](_0x440584(0x91))[_0x440584(0x132)]),_0xbee343=parseFloat(document[_0x440584(0x6c)](_0x440584(0x113))['value']*document[_0x440584(0x6c)](_0x440584(0x10e))['value']),_0x27f581=parseFloat(document['getElementById'](_0x440584(0x114))[_0x440584(0x132)]*document[_0x440584(0x6c)](_0x440584(0x73))[_0x440584(0x132)]),_0x45862d=parseFloat(document[_0x440584(0x6c)](_0x440584(0x149))['value'])+parseFloat(document[_0x440584(0x6c)](_0x440584(0x89))['value'])+parseFloat(document[_0x440584(0x6c)](_0x440584(0x126))[_0x440584(0x132)])+parseFloat(document[_0x440584(0x6c)](_0x440584(0xbe))[_0x440584(0x132)])+parseFloat(document[_0x440584(0x6c)](_0x440584(0x79))['value'])+parseFloat(document[_0x440584(0x6c)](_0x440584(0x100))[_0x440584(0x132)])+parseFloat(document[_0x440584(0x6c)](_0x440584(0xa8))[_0x440584(0x132)]),_0x5965de=parseFloat(document[_0x440584(0x6c)](_0x440584(0xf9))[_0x440584(0x132)])+parseFloat(document[_0x440584(0x6c)](_0x440584(0xb5))[_0x440584(0x132)])+parseFloat(document[_0x440584(0x6c)]('OrderGiftID9')[_0x440584(0x132)])+parseFloat(document[_0x440584(0x6c)]('OrderGiftID10')[_0x440584(0x132)])+parseFloat(document['getElementById'](_0x440584(0x70))[_0x440584(0x132)])+parseFloat(document[_0x440584(0x6c)](_0x440584(0x78))[_0x440584(0x132)])+parseFloat(document[_0x440584(0x6c)]('OrderGiftID13')[_0x440584(0x132)]),_0x28befc=parseFloat(document[_0x440584(0x6c)](_0x440584(0xcc))[_0x440584(0x132)])+parseFloat(document[_0x440584(0x6c)](_0x440584(0x6f))['value'])+parseFloat(document[_0x440584(0x6c)](_0x440584(0x91))[_0x440584(0x132)])+parseFloat(document['getElementById'](_0x440584(0x10e))['value'])+parseFloat(document['getElementById'](_0x440584(0x73))[_0x440584(0x132)]);xTotalUnitPrice=_0x45862d+_0x5965de+_0x28befc;var _0x54f800=parseFloat(_0x19ecd5)+parseFloat(_0x21babb)+parseFloat(_0x4149f7)+parseFloat(_0x48a5a8)+parseFloat(_0x26ff2c)+parseFloat(_0x4e8560),_0x1a526c=parseFloat(_0x11139c)+parseFloat(_0x462afb)+parseFloat(_0x1a9962)+parseFloat(_0x3d795a)+parseFloat(_0x296065)+parseFloat(_0x23a9ec),_0x50d64c=parseFloat(_0x22bbe9)+parseFloat(_0x567b40)+parseFloat(_0x1b9e26)+parseFloat(_0x4803dc)+parseFloat(_0x59e12a)+parseFloat(_0xbee343)+parseFloat(_0x27f581);xTotalPrice=_0x54f800+_0x1a526c+_0x50d64c,xBalance=xBMAllocated-xTotalPrice,$(_0x440584(0x12d))['html'](numberWithCommas(_0x19ecd5)),$(_0x440584(0x7e))[_0x440584(0xd2)](numberWithCommas(_0x21babb)),$(_0x440584(0xe7))[_0x440584(0xd2)](numberWithCommas(_0x4149f7)),$(_0x440584(0xf4))[_0x440584(0xd2)](numberWithCommas(_0x48a5a8)),$(_0x440584(0xbd))[_0x440584(0xd2)](numberWithCommas(_0x26ff2c)),$(_0x440584(0x128))[_0x440584(0xd2)](numberWithCommas(_0x4e8560)),$(_0x440584(0x13f))[_0x440584(0xd2)](numberWithCommas(_0x11139c)),$(_0x440584(0xd7))[_0x440584(0xd2)](numberWithCommas(_0x462afb)),$(_0x440584(0x9b))[_0x440584(0xd2)](numberWithCommas(_0x1a9962)),$('#SumUnitPrice9')[_0x440584(0xd2)](numberWithCommas(_0x3d795a)),$(_0x440584(0xf2))[_0x440584(0xd2)](numberWithCommas(_0x296065)),$(_0x440584(0x69))[_0x440584(0xd2)](numberWithCommas(_0x23a9ec)),$('#SumUnitPrice12')['html'](numberWithCommas(_0x22bbe9)),$(_0x440584(0x161))[_0x440584(0xd2)](numberWithCommas(_0x567b40)),$(_0x440584(0xf8))[_0x440584(0xd2)](numberWithCommas(_0x1b9e26)),$(_0x440584(0x7b))[_0x440584(0xd2)](numberWithCommas(_0x4803dc)),$(_0x440584(0x150))['html'](numberWithCommas(_0x59e12a)),$(_0x440584(0x13b))[_0x440584(0xd2)](numberWithCommas(_0xbee343)),$('#SumUnitPrice18')['html'](numberWithCommas(_0x27f581)),_0x4c024f+=_0x440584(0x125),_0x4c024f+=_0x440584(0xfa),_0x4c024f+=_0x440584(0x155)+numberWithCommas(xBMAllocated)+_0x440584(0x116),_0x4c024f+=_0x440584(0xd8)+numberWithCommas(xTotalPrice)+_0x440584(0x143);xBalance>=0x0?_0x4c024f+=_0x440584(0x8c)+numberWithCommas(xBalance)+_0x440584(0xdf):_0x4c024f+=_0x440584(0x8c)+numberWithCommas(xBalance)+'\x22\x20style=\x22color:#fff;background:#ff0000;\x22></div></div>';_0x4c024f+=_0x440584(0x119),_0x4c024f+=_0x440584(0x125);var _0xc030fc=xBMAllocated-xTotalPrice;if(xBMAllocated-xTotalPrice>0x0){_0x4c024f+=_0x440584(0x12a);if(xBMStatus==0x0||xBMStatus==0x1)xTotalUnitPrice!=0x0?(xTotalUnitPrice!=0x0&&(_0x4c024f+='<div\x20class=\x22btn-z3\x22\x20onclick=\x22DeleteAllOrder(\x27'+gID+_0x440584(0xbb)),_0x4c024f+=_0x440584(0x16d)+gID+'\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>บันทึกดร๊าฟ<br>รายการสั่งซื้อ</div>'):(_0x4c024f+=_0x440584(0xee),_0x4c024f+=_0x440584(0x92));else{if(xBMStatus==0x2)_0x4c024f+=_0x440584(0xa1)+gID+_0x440584(0x154),_0x4c024f+=_0x440584(0x92),_0x4c024f+=_0x440584(0x168);else{if(xBMStatus==0x3)xTotalUnitPrice!=0x0&&(_0x4c024f+=_0x440584(0x16d)+gID+_0x440584(0x117),_0x4c024f+=_0x440584(0x137)+zZoneMemoToBM+'</div>');else xBMStatus==0x9?(_0x4c024f+=_0x440584(0x7c)+gID+_0x440584(0xe0),_0x4c024f+=_0x440584(0xa6)):(_0x4c024f+=_0x440584(0xa1)+gID+_0x440584(0x154),_0x4c024f+='<div\x20style=\x22font-weight:600;\x22>รายการอยู่ระหว่างการขออนุมัติการสั่งจองของขวัญปีใหม่<br></div>');}}_0x4c024f+=_0x440584(0x119);}else alert('ขณะนี้คุณได้ทำคำสั่งซื้อของขวัญปีใหม่\x0aจากงบประมาณที่ได้รับ\x20'+numberWithCommas(xBMAllocated)+_0x440584(0x99)+numberWithCommas(xTotalPrice)+_0x440584(0x106)+numberWithCommas(_0xc030fc)+_0x440584(0x16a)),_0x4c024f+=_0x440584(0xd6);_0x4c024f+='<hr><div\x20style=\x22margin-top:-10px;text-align:left;padding-bottom:\x2010px;line-height:1.3;\x20padding-left:10px;\x22>BM\x20:\x20<b>'+xBMName+_0x440584(0x68)+xBranchName+_0x440584(0x105),$('#TotalGift')[_0x440584(0xd2)](_0x4c024f);}function DisplayGift(_0x5d73dc){var _0x430f2d=_0x526741,_0x4157b1='';dbGiftStock[_0x430f2d(0x96)](firebase[_0x430f2d(0x112)][_0x430f2d(0xe6)][_0x430f2d(0x9f)](),'==',_0x5d73dc)[_0x430f2d(0xe5)]()[_0x430f2d(0x14d)](_0x40edc9=>{var _0x5cce81=_0x430f2d;_0x40edc9[_0x5cce81(0x146)](_0x16bbeb=>{var _0x14fb32=_0x5cce81;_0x4157b1+='<center><div\x20class=\x22btn-t3\x22\x20style=\x22margin-top:25px;\x22><b>รายละเอียดของขวัญปีใหม่</b></div>',_0x4157b1+=_0x14fb32(0x158)+_0x16bbeb[_0x14fb32(0x15b)]()['StockImg']+_0x14fb32(0x95),_0x4157b1+='<div\x20style=\x22font-weight:600;\x22>'+_0x16bbeb[_0x14fb32(0x15b)]()[_0x14fb32(0x123)]+_0x14fb32(0x119),_0x4157b1+=_0x14fb32(0xc6)+_0x16bbeb[_0x14fb32(0x15b)]()[_0x14fb32(0xa3)]+_0x14fb32(0x119),_0x4157b1+=_0x14fb32(0x15c)+_0x16bbeb[_0x14fb32(0x15b)]()['PointRedeem']+_0x14fb32(0x118),_0x4157b1+='',_0x4157b1+='',_0x4157b1+=_0x14fb32(0x125),_0x4157b1+=_0x14fb32(0x74);}),$(_0x5cce81(0xca))[_0x5cce81(0xd2)](_0x4157b1);}),document['getElementById'](_0x430f2d(0xc5))['style'][_0x430f2d(0x101)]=_0x430f2d(0xad);}function DeleteAllOrder(_0x16032f){var _0x299892=_0x526741;dbGiftOrder['where'](_0x299892(0xf7),'==',_0x16032f)[_0x299892(0xe5)]()['then'](_0x7880f3=>{var _0x23d2f3=_0x299892;_0x7880f3[_0x23d2f3(0x146)](_0x5aa574=>{var _0xf0ca59=_0x23d2f3;dbGiftOrder[_0xf0ca59(0xa0)]()[_0xf0ca59(0x120)](),DeleteRefID(_0x5aa574['id']);}),console[_0x23d2f3(0x157)]('gID='+gID);var _0x25deeb=0x3e8;setTimeout(function(){var _0x2de3ca=_0x23d2f3;dbNewyearData[_0x2de3ca(0xa0)](gID)[_0x2de3ca(0xcd)]({'BMStatus':0x0,'TotalOrders':0x0,'UseBudget':0x0,'BMBalance':0x0});},_0x25deeb);var _0x57a705=0x7d0;setTimeout(function(){var _0x4078df=_0x23d2f3;alert(_0x4078df(0x136)),location[_0x4078df(0xfc)]='ordergift.html?gid='+gID;},_0x57a705);});}function DeleteRefID(_0x3f747b){var _0x5965d6=_0x526741;dbGiftOrder[_0x5965d6(0xa0)](_0x3f747b)[_0x5965d6(0x120)](),console[_0x5965d6(0x157)](_0x3f747b);}function ViewOrder(_0xd53eed){var _0x2fbd0f=_0x526741,_0x5358e1='',_0x4e7338=0x0,_0x15fd43=0x0;_0x5358e1+='<center><div\x20class=\x22btn-t22a\x22\x20style=\x22margin:30px\x20auto\x2020px\x20auto;\x22><b>รายการสั่งซื้อของขวัญปีใหม่ของสาขา</b></div></center>',_0x5358e1+=_0x2fbd0f(0x16f)+xBranchName+_0x2fbd0f(0xae)+xBMName+_0x2fbd0f(0x119),_0x5358e1+=_0x2fbd0f(0x172),_0x5358e1+=_0x2fbd0f(0x135),_0x5358e1+=_0x2fbd0f(0xec),dbGiftOrder['where']('RefID','==',_0xd53eed)['orderBy'](_0x2fbd0f(0x123),_0x2fbd0f(0x148))[_0x2fbd0f(0xe5)]()[_0x2fbd0f(0x14d)](_0x3420c0=>{var _0x37d9e7=_0x2fbd0f;_0x3420c0['forEach'](_0x12e500=>{var _0x4555a0=_0x330e;_0x4e7338=_0x4e7338+_0x12e500[_0x4555a0(0x15b)]()['OrderGift'],_0x15fd43=_0x15fd43+_0x12e500[_0x4555a0(0x15b)]()[_0x4555a0(0xab)]*_0x12e500[_0x4555a0(0x15b)]()[_0x4555a0(0x11e)],_0x5358e1+='<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;\x22>'+_0x12e500['data']()[_0x4555a0(0x123)]+_0x4555a0(0x85),_0x5358e1+=_0x4555a0(0xd4)+_0x12e500[_0x4555a0(0x15b)]()[_0x4555a0(0xab)]+_0x4555a0(0xe3),_0x5358e1+='<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;\x22>'+numberWithCommas(_0x12e500[_0x4555a0(0x15b)]()['OrderGift']*_0x12e500['data']()[_0x4555a0(0x11e)])+_0x4555a0(0x90);}),_0x5358e1+=_0x37d9e7(0x14e),_0x5358e1+=_0x37d9e7(0xc0)+addCommas(_0x4e7338)+_0x37d9e7(0xe3),_0x5358e1+='<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;background:#73a0f4;\x22>'+numberWithCommas(_0x15fd43)+_0x37d9e7(0x90),_0x5358e1+='<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#e831e8;\x22>'+numberWithCommas(xBMAllocated)+_0x37d9e7(0x90),_0x5358e1+=_0x37d9e7(0x11f)+numberWithCommas(_0x15fd43)+_0x37d9e7(0x90),_0x5358e1+=_0x37d9e7(0xb8)+numberWithCommas(xBMAllocated-_0x15fd43)+_0x37d9e7(0x90),_0x5358e1+=_0x37d9e7(0x104),_0x5358e1+='<div\x20class=\x22btn-z0\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>ปิดหน้าต่าง<br>รายการนี้</div>',$(_0x37d9e7(0xca))[_0x37d9e7(0xd2)](_0x5358e1);}),document[_0x2fbd0f(0x6c)](_0x2fbd0f(0xc5))[_0x2fbd0f(0x166)][_0x2fbd0f(0x101)]=_0x2fbd0f(0xad);}function SaveOrder(){var _0x3fc884=_0x526741;LoadDetail();var _0x256598=0x0,_0x44ac10=0x0,_0x31671c='',_0x57f10b=0x0,_0x14d7ff='';console['log'](xMaxGift);for(let _0x1944cd=0x0;_0x1944cd<xMaxGift;_0x1944cd++){var _0x5f4666=document[_0x3fc884(0x6c)](_0x3fc884(0x131)+_0x1944cd)[_0x3fc884(0x132)]*document['getElementById'](_0x3fc884(0x140)+_0x1944cd)[_0x3fc884(0x132)];SaveGift(document['getElementById'](_0x3fc884(0x103)+_0x1944cd)[_0x3fc884(0x132)],document[_0x3fc884(0x6c)](_0x3fc884(0x140)+_0x1944cd)[_0x3fc884(0x132)],document[_0x3fc884(0x6c)]('OrderGiftID'+_0x1944cd)['value'],_0x5f4666,document[_0x3fc884(0x6c)]('NameGift'+_0x1944cd)[_0x3fc884(0x132)]);}}var xSumMoney=0x0;function SaveGift(_0x39aa34,_0x155d3a,_0x116161,_0xe7d048,_0x50356e){var _0x455d9d=_0x526741;document[_0x455d9d(0x6c)](_0x455d9d(0xb2))['style'][_0x455d9d(0x101)]=_0x455d9d(0xa4),LoadDetail(),xSumMoney=0x0;var _0x1434dd='',_0x365c11='',_0x1e7a25=0x0;xSumMoney=xSumMoney+xTotalPrice,dbGiftOrder[_0x455d9d(0x96)](_0x455d9d(0xf7),'==',gID)['where']('RefGift','==',_0x39aa34)['get']()[_0x455d9d(0x14d)](_0x1270ec=>{var _0x38316d=_0x455d9d;_0x1270ec['forEach'](_0x1a4894=>{_0x365c11=_0x1a4894['id'],_0x1e7a25=0x1;});if(_0x116161==0x0)dbGiftOrder[_0x38316d(0xa0)](_0x365c11)[_0x38316d(0x120)]();else{if(_0x1e7a25==0x1){var _0x131012=parseFloat(_0x116161*_0x155d3a);dbGiftOrder['doc'](_0x365c11)[_0x38316d(0xcd)]({'OrderGift':parseFloat(_0x116161),'OrderPrice':parseFloat(_0x116161*_0x155d3a),'PointRedeem':parseFloat(_0x155d3a)});}else dbGiftOrder[_0x38316d(0xe9)]({'RefID':gID,'RefGift':_0x39aa34,'EmpID':xBMEmpID,'EmpName':xBMName,'EmpBR':xBranchName,'EmpZone':xZone,'EmpRH':xRH,'OrderGift':parseFloat(_0x116161),'OrderPrice':parseFloat(_0x116161*_0x155d3a),'PointRedeem':parseFloat(_0x155d3a),'StockName':_0x50356e});}});var _0x2e537e=0x0,_0x284deb=0x0;_0x1434dd+=_0x455d9d(0xc8),_0x1434dd+=_0x455d9d(0x122),_0x1434dd+=_0x455d9d(0x135),_0x1434dd+=_0x455d9d(0xec);for(let _0x96a0c1=0x0;_0x96a0c1<xMaxGift;_0x96a0c1++){document[_0x455d9d(0x6c)]('OrderGiftID'+_0x96a0c1)[_0x455d9d(0x132)]!=0x0&&(_0x1434dd+=_0x455d9d(0x107)+document[_0x455d9d(0x6c)]('NameGift'+_0x96a0c1)['value']+_0x455d9d(0x85),_0x1434dd+=_0x455d9d(0xd4)+document[_0x455d9d(0x6c)](_0x455d9d(0x131)+_0x96a0c1)[_0x455d9d(0x132)]+'</td>',_0x1434dd+='<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;\x22>'+numberWithCommas(document[_0x455d9d(0x6c)]('OrderGiftID'+_0x96a0c1)[_0x455d9d(0x132)]*document[_0x455d9d(0x6c)](_0x455d9d(0x140)+_0x96a0c1)[_0x455d9d(0x132)])+_0x455d9d(0x90),_0x284deb++);}_0x1434dd+='<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>รวมยอดการสั่งจองของขวัญ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#31e85b;\x22>'+numberWithCommas(xSumMoney)+_0x455d9d(0x90),_0x1434dd+=_0x455d9d(0xe4)+numberWithCommas(xBMAllocated)+_0x455d9d(0x90),_0x1434dd+=_0x455d9d(0xb8)+numberWithCommas(xBMAllocated-xSumMoney)+_0x455d9d(0x13e),_0x1434dd+=_0x455d9d(0xaa),_0x1434dd+='<div\x20style=\x22text-align:left;\x20margin:20px\x200\x202px\x205px;\x22>ที่ตั้งสาขา-ที่จัดส่งของขวัญ</div><center><textarea\x20id=\x22txtBM_Address\x22\x20name=\x22BM_Address\x22\x20style=\x22width:98%;\x20height:80px;text-align:left;font-weight:600;\x20color:#000;\x22>'+zBM_Address+'</textarea></center></div>',_0x1434dd+=_0x455d9d(0x102)+zBM_Phone+_0x455d9d(0x115),_0x1434dd+=_0x455d9d(0x111)+zEmpID_Staff1+_0x455d9d(0x115),_0x1434dd+='<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกชื่อ-นามสกุล)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpName_Staff1\x22\x20value=\x22'+zEmpName_Staff1+_0x455d9d(0x115),_0x1434dd+=_0x455d9d(0x81)+zPhone_Staff1+_0x455d9d(0x115),_0x1434dd+=_0x455d9d(0x164)+zEmpID_Staff2+_0x455d9d(0x115),_0x1434dd+=_0x455d9d(0x14a)+zEmpName_Staff2+_0x455d9d(0x115),_0x1434dd+=_0x455d9d(0xfe)+zPhone_Staff2+'\x22\x20style=\x22text-align:left;\x22></div>',_0x1434dd+=_0x455d9d(0x80)+gID+_0x455d9d(0x139),_0x1434dd+=_0x455d9d(0xc7),_0x1434dd+=_0x455d9d(0x125),_0x1434dd+=_0x455d9d(0x171)+gID+_0x455d9d(0x9e),$('#DisplaySaveGift')[_0x455d9d(0xd2)](_0x1434dd),$(_0x455d9d(0x162))['addClass'](_0x455d9d(0xbc));var _0x52e3c7=_0x455d9d(0x124)+dateString+_0x455d9d(0x14f),_0x2ee12c=0x3e8;setTimeout(function(){var _0x6ed9db=_0x455d9d;dbNewyearData[_0x6ed9db(0xa0)](gID)[_0x6ed9db(0xcd)]({'BMStatus':0x1,'BMBalance':parseFloat(xBMAllocated-xSumMoney),'TotalOrders':parseFloat(_0x284deb),'TotalOrders':parseFloat(xTotalUnitPrice),'UseBudget':parseFloat(xTotalPrice),'BM_Memo':_0x52e3c7});},_0x2ee12c),document[_0x455d9d(0x6c)]('id01')['style']['display']='block';}function SaveToZone(){var _0x3f55ad=_0x526741,_0x581c34=0x0,_0x6c6741=0x0;dbNewyearData[_0x3f55ad(0xa0)](gID)[_0x3f55ad(0xcd)]({'BMStatus':0x2}),str+=_0x3f55ad(0x12f),str+=_0x3f55ad(0x122),str+=_0x3f55ad(0x135),str+=_0x3f55ad(0xec);for(let _0x56b48f=0x0;_0x56b48f<xMaxGift;_0x56b48f++){document[_0x3f55ad(0x6c)](_0x3f55ad(0x131)+_0x56b48f)[_0x3f55ad(0x132)]!=0x0&&(str+=_0x3f55ad(0x107)+document[_0x3f55ad(0x6c)](_0x3f55ad(0x147)+_0x56b48f)[_0x3f55ad(0x132)]+'</th>',str+=_0x3f55ad(0xd4)+document[_0x3f55ad(0x6c)](_0x3f55ad(0x131)+_0x56b48f)[_0x3f55ad(0x132)]+_0x3f55ad(0xe3),str+=_0x3f55ad(0xd4)+numberWithCommas(document[_0x3f55ad(0x6c)](_0x3f55ad(0x131)+_0x56b48f)[_0x3f55ad(0x132)]*document[_0x3f55ad(0x6c)]('UnitPrice'+_0x56b48f)[_0x3f55ad(0x132)])+_0x3f55ad(0x90),_0x6c6741++);}str+=_0x3f55ad(0xd5)+numberWithCommas(xSumMoney)+_0x3f55ad(0x90),str+=_0x3f55ad(0xe4)+numberWithCommas(xBMAllocated)+_0x3f55ad(0x90),str+=_0x3f55ad(0xb8)+numberWithCommas(xBMAllocated-xSumMoney)+_0x3f55ad(0x13e),str+=_0x3f55ad(0xf0),str+=_0x3f55ad(0x72),$(_0x3f55ad(0x145))['html'](str),document[_0x3f55ad(0x6c)]('id02')[_0x3f55ad(0x166)]['display']=_0x3f55ad(0xad);}function GotoOrder(){var _0x3d80c7=_0x526741;location[_0x3d80c7(0xfc)]=_0x3d80c7(0x151);}function SaveDetail(){var _0x591e1f=_0x526741,_0x395ccf=document[_0x591e1f(0x6c)]('txtBM_Address')[_0x591e1f(0x132)],_0x3fa1f6=document['getElementById'](_0x591e1f(0xb6))['value'],_0x57ea72=document['getElementById'](_0x591e1f(0x169))[_0x591e1f(0x132)],_0x465697=document[_0x591e1f(0x6c)]('txtEmpName_Staff1')[_0x591e1f(0x132)],_0x406703=document['getElementById'](_0x591e1f(0xd1))[_0x591e1f(0x132)],_0x522f7d=document[_0x591e1f(0x6c)]('txtEmpID_Staff2')[_0x591e1f(0x132)],_0x426d2a=document[_0x591e1f(0x6c)]('txtEmpName_Staff2')[_0x591e1f(0x132)],_0x50a434=document[_0x591e1f(0x6c)](_0x591e1f(0xcf))[_0x591e1f(0x132)];_0x395ccf==''||_0x3fa1f6==''||_0x57ea72==''||_0x465697==''||_0x406703==''||_0x522f7d==''||_0x426d2a==''||_0x50a434==''?alert(_0x591e1f(0x170)):(dbNewyearData['doc'](gID)['update']({'BM_Address':document[_0x591e1f(0x6c)](_0x591e1f(0x15f))[_0x591e1f(0x132)],'BM_Phone':document[_0x591e1f(0x6c)](_0x591e1f(0xb6))['value'],'EmpID_Staff1':document['getElementById'](_0x591e1f(0x169))[_0x591e1f(0x132)],'EmpName_Staff1':document[_0x591e1f(0x6c)](_0x591e1f(0x13a))['value'],'Phone_Staff1':document[_0x591e1f(0x6c)]('txtPhone_Staff1')[_0x591e1f(0x132)],'EmpID_Staff2':document[_0x591e1f(0x6c)](_0x591e1f(0x88))[_0x591e1f(0x132)],'EmpName_Staff2':document['getElementById'](_0x591e1f(0xdb))[_0x591e1f(0x132)],'Phone_Staff2':document['getElementById'](_0x591e1f(0xcf))['value']}),alert('ระบบได้ทำการบันทึกรายการนี้เรียบร้อยแล้ว\x20หากไม่มีการแก้ไขรายการให้ทำการกดปุ่ม\x20ส่งคำขอให้โซนอนุมัติ\x20ซึ่งจะมีผลให้สาขาไม่สามารถทำการแก้ไขรายการได้แล้ว'),LoadDetail(),document[_0x591e1f(0x6c)](_0x591e1f(0x129))[_0x591e1f(0x166)][_0x591e1f(0x101)]=_0x591e1f(0xad));}function addCommas(_0xf5d028){var _0x122bf0=_0x526741;_0xf5d028+='',x=_0xf5d028[_0x122bf0(0x7a)]('.'),x1=x[0x0],x2=x[_0x122bf0(0xb9)]>0x1?'.'+x[0x1]:'';var _0x26ec6d=/(\d+)(\d{3})/;while(_0x26ec6d['test'](x1)){x1=x1['replace'](_0x26ec6d,'$1'+','+'$2');}return x1+x2;}function numberWithCommas(_0x53537f){var _0x1eeb05=_0x526741,_0x128948=_0x53537f,_0x4259f9=parseFloat(_0x128948)['toFixed'](0x2);return formattedString=_0x4259f9[_0x1eeb05(0x82)]()['replace'](/\B(?=(\d{3})+(?!\d))/g,',');}function CloseAll(){var _0x229e04=_0x526741;document[_0x229e04(0x6c)](_0x229e04(0xb2))[_0x229e04(0x166)][_0x229e04(0x101)]=_0x229e04(0xad),document[_0x229e04(0x6c)](_0x229e04(0x138))[_0x229e04(0x166)][_0x229e04(0x101)]=_0x229e04(0xa4),document[_0x229e04(0x6c)](_0x229e04(0xed))['style'][_0x229e04(0x101)]=_0x229e04(0xa4),document[_0x229e04(0x6c)]('id03')['style'][_0x229e04(0x101)]='none';}
