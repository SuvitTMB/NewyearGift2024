var _0x1291ce=_0x1293;(function(_0x4923a2,_0x1f0f9e){var _0x161841=_0x1293,_0x2a939c=_0x4923a2();while(!![]){try{var _0x40f5a5=-parseInt(_0x161841(0x1fe))/0x1*(parseInt(_0x161841(0x1a1))/0x2)+-parseInt(_0x161841(0x248))/0x3+-parseInt(_0x161841(0x1d5))/0x4*(-parseInt(_0x161841(0x17a))/0x5)+-parseInt(_0x161841(0x22c))/0x6+parseInt(_0x161841(0x252))/0x7+-parseInt(_0x161841(0x1ea))/0x8+parseInt(_0x161841(0x188))/0x9;if(_0x40f5a5===_0x1f0f9e)break;else _0x2a939c['push'](_0x2a939c['shift']());}catch(_0x1d822a){_0x2a939c['push'](_0x2a939c['shift']());}}}(_0x99bf,0x3e246));function _0x99bf(){var _0x2c94a5=['\x20บาท\x0aยอดสั่งของขวัญของคุณ\x20','index.html','\x22\x20style=\x22color:#fff;background:#ff0000;\x22></div></div>','<thead><tr\x20style=\x22text-align:\x20center;background-color:\x20#93a3c1;\x22>','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>โทรศัพท์ผู้จัดการสาขา</div><input\x20type=\x22text\x22\x20id=\x22txtBM_Phone\x22\x20value=\x22','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;background:#73a0f4;\x22>สรุปรายการสั่งซื้อ</th>','length','<div\x20onclick=\x22DisplayGift(\x27','idSendZoneApprove','\x22\x20selected>','<div\x20style=\x22font-weight:600;\x20color:#ff0000;line-height:1.2;\x22><font\x20color=\x22#000000\x22>โซนแจ้งทำการทบทวนการสั่งจองใหม่อีกครั้ง</font><br>','\x22\x20style=\x22text-align:left;\x22></div>','txtEmpID_Staff2','collection','\x27)\x22><font\x20color=\x22#0056ff\x22><b>','toFixed','Newyear2024_data','#SumUnitPrice12','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกรหัสพนักงาน)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpID_Staff2\x22\x20value=\x22','#DisplayGift','คุณยังกรอกข้อมูลไม่ครบถ้วน','<div\x20class=\x22btn-z1\x22\x20onclick=\x22GotoOrder()\x22\x20style=\x22margin:10px\x2010px\x2020px\x20auto;min-width:100px;\x22>กลับไป<br>หน้าแรก</div>',')\x22\x20value=\x22','NameGift','<font\x20color=\x27#555555\x27><b>ยังไม่ได้สั่งจอง</b></font>','<hr><div\x20style=\x22margin-top:-10px;text-align:left;padding-bottom:\x2010px;line-height:1.3;\x20padding-left:10px;\x22>BM\x20:\x20<b>','push','txtEmpName_Staff1','orderBy','BMName','OrderGiftID10','getDate','id03','2342034YyIZLe','\x22\x20style=\x22width:100%;margin-top:18px;margin-bottom:\x2010px;\x22></div></center>','</td></tr>','exec','StockGroup','BM_Address','\x20บาท\x0aคุณสั่งเกินไปแล้ว\x20','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>บันทึกการสั่งจองของขวัญปีใหม่</div>','<option\x20onchange=\x22CalGift(','href','disabledbutton','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>ราคาต่อชิ้น</div><input\x20type=\x22text\x22\x20id=\x22UnitPrice','<div\x20class=\x22btn-z1\x22\x20onclick=\x22SaveOrder(\x27','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;\x22>','PointRedeem','\x22\x20style=\x22color:#fff;background:#0056ff;\x22></div></div>','StockDetail','\x27)\x22\x20style=\x22width:56%;margin:-10px\x20auto\x2020px\x20auto;display:none\x22\x20id=\x22idSendZoneApprove\x22>ส่งคำขอ<br>ให้โซนอนุมัติ</div>','[?&]','UnitPrice5','<div\x20class=\x22btn-z3\x22\x20onclick=\x22DeleteAllOrder(\x27','<div\x20class=\x22btn-z0\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>ทำการแก้ไข<br>ใหม่อีกครั้ง</div>','firestore','html','</b><br>Branch\x20:\x20<b>','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>รวมยอดการสั่งจองของขวัญ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#31e85b;\x22>','asc','UnitPrice8','1290717IruqrD','EmpZone','</b></td></tr>','<div\x20class=\x22btn-z1\x22\x20onclick=\x22SaveDetail(\x27','#SumUnitPrice13','UnitPrice15','<div\x20class=\x22btn-z0\x22\x20style=\x22margin:10px\x2010px\x2020px\x20auto;min-width:100px;\x22>กรุณาสั่ง<br>ของขวัญปีใหม่</div>','filter','<div\x20style=\x22font-weight:600;\x20color:#0056ff;\x22>รายการของท่านได้รับการอนุมัติจากโซน\x20เรียบร้อยแล้ว<br></div>','</div><div\x20style=\x22margin-top:30px;padding-top:20px;margin-left:3px;\x22>','2990491BKDxAH','BranchName','#SumUnitPrice6','id01','ระบบได้ทำการลบรายการการสั่งจองของขวัญของคุณเรียบร้อยแล้ว','Newyear2024_order','style','<div\x20style=\x22font-weight:600;\x22>รายการอยู่ระหว่างการขออนุมัติจากโซน<br></div>','EmpName_Staff1','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายละเอียด<br>รายการสั่งซื้อ</div>','\x22\x20readonly></div></div>','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สถานะ</td>','<option\x20onchange=\x22CalGift(0)\x22\x20value=\x220\x22>รอการสั่ง</option>','UnitPrice13','UnitPrice4','<th\x20scope=\x22col\x22>รายการ</th><th\x20scope=\x22col\x22>รายละเอียด</th></tr></thead><tbody>','OrderGiftID11','<div\x20class=\x22btn-z0\x22\x20onclick=\x22ViewOrder(\x27','OrderGiftRefID','Newyear2024_gift','<div\x20class=\x22clr\x22></div>','\x22\x20style=\x22color:#fff;background:#002d63;\x22></div></div>','data','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกชื่อ-นามสกุล)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpName_Staff1\x22\x20value=\x22','1925255DuuYCL','StockName','id02','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>ยอดงบคงเหลือ</div><input\x20type=\x22text\x22\x20value=\x22','\x22\x20class=\x22form-control\x22>','UnitPrice1','คลิก<br>สั่งจอง','block','update','OrderGift','Asia/Jakarta','#SumUnitPrice10','#DisplayGroup2','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>ยอดรวมการสั่งซื้อ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>','6303006PTYGBr','<br>','</b></div>','documentId','none','<div><img\x20src=\x22','<center><div\x20class=\x22btn-t22a\x22\x20style=\x22margin:30px\x20auto\x2020px\x20auto;\x22><b>รายการสั่งซื้อของขวัญปีใหม่ของสาขา</b></div></center>','BMStatus','</tbody></table></div>','<font\x20color=\x27#0056ff\x27><b>ส่งโซนอนุมัติ</b></font>','</th>','โซนแจ้ง<br>ทบทวน','StockImg','</td></tr></tbody></table>','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>จำนวนเงินที่สั่ง</div><input\x20type=\x22text\x22\x20value=\x22','<td\x20style=\x22text-align:\x20center;background:#c4d0e2;\x22><b>','txtEmpID_Staff1','OrderGiftID1','UnitPrice7','<div\x20class=\x22btn-z3\x22\x20onclick=\x22SaveToZone(\x27','#SumUnitPrice15','RefGift','</b></font></div>','EmpID_Newyear','UseBudget','42134GbJkcR','get','#SumUnitPrice11','<tr>','OrderGiftID7','replace','\x22\x20value=\x22','OrderGiftID2','txtPhone_Staff2','<th\x20scope=\x22col\x22>No.</th><th\x20scope=\x22col\x22>รายการของขวัญ</th></tr></thead><tbody>','</div>','OrderGiftID12','</select></div>','getItem','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกหมายเลขโทรศัพท์)</div><input\x20type=\x22text\x22\x20id=\x22txtPhone_Staff1\x22\x20value=\x22','UnitPrice12','OrderGiftID3','EmpID_Staff1','\x22\x20style=\x22color:#fff;background:#13c33b;\x22></div></div>','UnitPrice','forEach','Phone_Staff1','<div\x20class=\x22btn-z9\x22\x20onclick=\x22ViewOrder(\x27','\x27)\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>บันทึกดร๊าฟ<br>ก่อนส่งโซน</div>','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกหมายเลขโทรศัพท์)</div><input\x20type=\x22text\x22\x20id=\x22txtPhone_Staff2\x22\x20value=\x22','OrderGiftID4','#SumUnitPrice4','#DisplaySaveToZone','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22margin-top:20px;\x20background-color:\x20#fff;\x22>','#SumUnitPrice2','txtBM_Phone','home.html','value','doc','OrderGiftID','\x22\x20readonly></div>','#SumUnitPrice7','#DisplaySaveGift','\x20ชิ้น</option>','FieldPath','<div\x20id=\x22ShowSaveData\x22\x20style=\x22display:block;margin-bottom:\x2020px;\x22>','UnitPrice14','RefID','กำลัง<br>สั่งจอง','OrderGiftID9','<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;\x22>','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณคงเหลือ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#0056ff;\x22>','BMEmpID','StockStatus','then','\x5c$&','gStatus','4aoBLhy','OrderGiftID5','<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;background:#73a0f4;\x22>','padStart','\x20บาท\x0aระบบจะไม่อนุญาตให้บันทึกรายการสั่งจอง','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;margin-top:10px;\x22>','(=([^&#]*)|&|#|$)','split','BranchID','display','toString','<th\x20scope=\x22col\x22>รายการ</th><th\x20scope=\x22col\x22>จำนวน</th><th\x20scope=\x22col\x22>ราคา</th></tr></thead><tbody>','#SumUnitPrice8','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>เลือกจำนวนชิ้น</div>','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>รวมทั้งหมด</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#31e85b;\x22>','\x20บาท</b></td></tr>','<div\x20class=\x22btn-t2\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:15px\x20auto\x2025px\x20auto;\x22>ปิดหน้าต่างนี้</div>','<font\x20color=\x27#28c92a\x27><b>โซนอนุมัติเรียบร้อยแล้ว</b></font>','txtPhone_Staff1','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>BM</td>','gid','1308920SoJxDF','<div\x20style=\x22text-align:left;\x20margin:20px\x200\x202px\x205px;\x22>ที่ตั้งสาขา-ที่จัดส่งของขวัญ</div><center><textarea\x20id=\x22txtBM_Address\x22\x20name=\x22BM_Address\x22\x20style=\x22width:98%;\x20height:80px;text-align:left;font-weight:600;\x20color:#000;\x22>','test','OrderGiftID14','where','UnitPrice9','</td>','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>นำส่งรายการสั่งซื้อให้โซนอนุมัติ</div>','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>จำนวนเงินที่ใช้</div><div\x20class=\x22box-order\x22\x20id=\x22SumUnitPrice','getElementById','<div\x20class=\x22txtmsg\x22>ขณะนี้รายการการจัดซื้อของขวัญของสาขา\x20อยู่ระหว่างการอนุมัติโดยโซนที่ดูแลสาขาของท่าน\x20กรุณารอการอนุมัติ</div>','txtBM_Address','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>','delete','EmpID_Staff2','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;\x22>','<div\x20class=\x22btn-t2\x22\x20onclick=location.href=\x22home.html\x22\x20type=\x22submit\x22\x20style=\x22margin-top:20px;\x22>ไม่บันทึกรายการ</div>','OrderGiftID15','StockView','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>บันทึกดร๊าฟ<br>รายการสั่งซื้อ</div>','13TieEZy','UnitPrice2','#SumUnitPrice1','\x22\x20hidden>','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สั่งไปแล้ว</td>','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;\x20margin-top:20px;\x22>','UnitPrice11','BMAllocated','UnitPrice0','getMonth','getFullYear','OrderGiftID6','<div\x20style=\x22font-weight:600;\x22>รายการอยู่ระหว่างการขออนุมัติการสั่งจองของขวัญปีใหม่<br></div>'];_0x99bf=function(){return _0x2c94a5;};return _0x99bf();}var dateString=new Date()['toLocaleString']('en-US',{'timeZone':_0x1291ce(0x184)}),today=new Date(),dd=String(today[_0x1291ce(0x22a)]())[_0x1291ce(0x1d8)](0x2,'0'),mm=String(today[_0x1291ce(0x207)]()+0x1)[_0x1291ce(0x1d8)](0x2,'0'),yyyy=today[_0x1291ce(0x208)]()+0x21f,gID,gStatus,xMaxGift=0x0,xNewyearLimit=0x16,xOrderLimit=0x64,xBMStatus=0x0,xSendZoneApprove=0x0,zBM_Address='',zBM_Phone='',zEmpID_Staff1='',zEmpName_Staff1='',zPhone_Staff1='',zEmpID_Staff2='',zEmpName_Staff2='',zPhone_Staff2='',zZoneMemoToBM='';$(document)['ready'](function(){var _0x308100=_0x1291ce;sessionStorage[_0x308100(0x1ae)](_0x308100(0x19f))==null&&(location[_0x308100(0x235)]=_0x308100(0x20c)),gID=getParameterByName(_0x308100(0x1e9)),gStatus=getParameterByName(_0x308100(0x1d4)),Connect_DB(),dbNewyearData=firebase[_0x308100(0x242)]()[_0x308100(0x218)](_0x308100(0x21b)),dbGiftStock=firebase['firestore']()['collection'](_0x308100(0x175)),dbGiftOrder=firebase[_0x308100(0x242)]()['collection'](_0x308100(0x257)),CheckBudget(),GetUserOrder(gID),LoadGiftStock();});function getParameterByName(_0x5d3c96,_0x2f4a84){var _0x48b688=_0x1291ce;str='';if(!_0x2f4a84)_0x2f4a84=window['location']['href'];_0x5d3c96=_0x5d3c96[_0x48b688(0x1a6)](/[\[\]]/g,_0x48b688(0x1d3));var _0x44848c=new RegExp(_0x48b688(0x23e)+_0x5d3c96+_0x48b688(0x1db)),_0x2bca52=_0x44848c[_0x48b688(0x22f)](_0x2f4a84);if(!_0x2bca52)return null;if(!_0x2bca52[0x2])return'';return decodeURIComponent(_0x2bca52[0x2][_0x48b688(0x1a6)](/\+/g,'\x20'));}function LoadDetail(){var _0x1b51e5=_0x1291ce;dbNewyearData[_0x1b51e5(0x1ee)](firebase[_0x1b51e5(0x242)][_0x1b51e5(0x1c8)]['documentId'](),'==',gID)['get']()['then'](_0x52714a=>{var _0x3cd3a7=_0x1b51e5;_0x52714a[_0x3cd3a7(0x1b5)](_0x5ab0fd=>{var _0x53fdb5=_0x3cd3a7;xBMStatus=_0x5ab0fd[_0x53fdb5(0x178)]()['BMStatus'],zBM_Address=_0x5ab0fd['data']()[_0x53fdb5(0x231)],zBM_Phone=_0x5ab0fd[_0x53fdb5(0x178)]()['BM_Phone'],zEmpID_Staff1=_0x5ab0fd[_0x53fdb5(0x178)]()[_0x53fdb5(0x1b2)],zEmpName_Staff1=_0x5ab0fd['data']()[_0x53fdb5(0x25a)],zPhone_Staff1=_0x5ab0fd['data']()[_0x53fdb5(0x1b6)],zEmpID_Staff2=_0x5ab0fd[_0x53fdb5(0x178)]()[_0x53fdb5(0x1f8)],zEmpName_Staff2=_0x5ab0fd[_0x53fdb5(0x178)]()['EmpName_Staff2'],zPhone_Staff2=_0x5ab0fd[_0x53fdb5(0x178)]()['Phone_Staff2'],zZoneMemoToBM=_0x5ab0fd[_0x53fdb5(0x178)]()['ZoneMemoToBM'];});});}var xBMAllocated=0x0,xBMEmpID='',xBMName='',xBranchName='',xZone='',xRH='';function CheckBudget(){var _0x117a05=_0x1291ce,_0x2e87e0='',_0x2c9969='';_0x2e87e0+=_0x117a05(0x1bd),_0x2e87e0+=_0x117a05(0x20e),_0x2e87e0+=_0x117a05(0x171),dbNewyearData[_0x117a05(0x1ee)](firebase[_0x117a05(0x242)][_0x117a05(0x1c8)][_0x117a05(0x18b)](),'==',gID)[_0x117a05(0x1a2)]()[_0x117a05(0x1d2)](_0x452741=>{var _0x284a66=_0x117a05;_0x452741[_0x284a66(0x1b5)](_0x722304=>{var _0x22597c=_0x284a66;xBMStatus=_0x722304[_0x22597c(0x178)]()[_0x22597c(0x18f)];if(_0x722304[_0x22597c(0x178)]()[_0x22597c(0x18f)]==0x0)xMsg=_0x22597c(0x180),_0x2c9969=_0x22597c(0x223);else{if(_0x722304['data']()[_0x22597c(0x18f)]==0x1)xMsg=_0x22597c(0x1cc),_0x2c9969='<font\x20color=\x27#f68b1f\x27><b>อยู่ระหว่างการสั่งจอง</b></font>';else{if(_0x722304[_0x22597c(0x178)]()[_0x22597c(0x18f)]==0x2)xMsg='ส่งโซน<br>ขออนุมัติ',_0x2c9969=_0x22597c(0x191);else{if(_0x722304['data']()['BMStatus']==0x3)xMsg=_0x22597c(0x193),_0x2c9969='<font\x20color=\x27#ff0000\x27><b>โซนแจ้งทบทวนใหม่</b></font>';else{if(_0x722304[_0x22597c(0x178)]()[_0x22597c(0x18f)]==0x8)xMsg='โซนแจ้ง<br>ยกเลิก',_0x2c9969='<font\x20color=\x27#ff0000\x27><b>โซนแจ้งขอยกเลิกการจอง</b></font>';else _0x722304[_0x22597c(0x178)]()[_0x22597c(0x18f)]==0x9&&(xMsg='โซนแจ้ง<br>อนุมัติ',_0x2c9969=_0x22597c(0x1e6));}}}}xBMEmpID=_0x722304['data']()[_0x22597c(0x1d0)],xBMName=_0x722304['data']()[_0x22597c(0x228)],xBranchName=_0x722304['data']()[_0x22597c(0x253)]+'\x20('+_0x722304[_0x22597c(0x178)]()[_0x22597c(0x1dd)]+')',xZone=_0x722304['data']()[_0x22597c(0x249)],xRH=_0x722304[_0x22597c(0x178)]()['EmpRH'],_0x2e87e0+=_0x22597c(0x1a4),_0x2e87e0+='<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สาขา</td>',_0x2e87e0+=_0x22597c(0x197)+_0x722304[_0x22597c(0x178)]()[_0x22597c(0x253)]+'\x20('+_0x722304[_0x22597c(0x178)]()[_0x22597c(0x1dd)]+')</b></td></tr>',_0x2e87e0+=_0x22597c(0x1e8),_0x2e87e0+=_0x22597c(0x197)+_0x722304['data']()[_0x22597c(0x228)]+_0x22597c(0x24a),_0x2e87e0+=_0x22597c(0x25d),_0x2e87e0+=_0x22597c(0x197)+_0x2c9969+_0x22597c(0x24a),_0x2e87e0+='<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>งบสั่งจอง</td>',_0x2e87e0+=_0x22597c(0x197)+numberWithCommas(_0x722304[_0x22597c(0x178)]()[_0x22597c(0x205)])+_0x22597c(0x1e4),_0x2e87e0+=_0x22597c(0x202),_0x2e87e0+=_0x22597c(0x197)+numberWithCommas(_0x722304['data']()[_0x22597c(0x1a0)])+_0x22597c(0x1e4),xBMAllocated=_0x722304[_0x22597c(0x178)]()[_0x22597c(0x205)];}),_0x2e87e0+='</tbody></table></div>',_0x2e87e0+=_0x284a66(0x176),$('#DisplayBudget')[_0x284a66(0x243)](_0x2e87e0);});}var GetOrderArr=[];function GetUserOrder(_0x4673ad){var _0x2e6b48=_0x1291ce,_0x3e0cec=0x0;dbGiftOrder[_0x2e6b48(0x1ee)](_0x2e6b48(0x1cb),'==',_0x4673ad)[_0x2e6b48(0x1a2)]()[_0x2e6b48(0x1d2)](_0x4b09a2=>{var _0x27b243=_0x2e6b48;_0x4b09a2[_0x27b243(0x1b5)](_0x56c495=>{var _0xa636fe=_0x27b243;GetOrderArr[_0xa636fe(0x225)]({'RefGift':_0x56c495[_0xa636fe(0x178)]()[_0xa636fe(0x19d)],'StockName':_0x56c495[_0xa636fe(0x178)]()[_0xa636fe(0x17b)],'OrderGift':_0x56c495[_0xa636fe(0x178)]()[_0xa636fe(0x183)],'ID':_0x56c495['id']});});});}var xCheckOrder=0x0,xCountRec=0x0,xSumAllPrice=0x0,xSumUnitPrice=0x0,xTotalUnitPrice=0x0,xBalance=0x0;function LoadGiftStock(){var _0x5346b4=_0x1291ce;LoadDetail();var _0x21b67f='',_0x51e799=0x0,_0x558eb7=0x0;xSumAllPrice=0x0,xSumUnitPrice=0x0,xMaxGift=0x0,xCalSell=0x0,_0x21b67f+=_0x5346b4(0x1f9),_0x21b67f+='<thead><tr\x20style=\x22text-align:\x20center;background-color:\x20#93a3c1;\x22>',_0x21b67f+=_0x5346b4(0x1aa),dbGiftStock['where'](_0x5346b4(0x1d1),'==',0x1)[_0x5346b4(0x227)](_0x5346b4(0x230),_0x5346b4(0x246))[_0x5346b4(0x1a2)]()[_0x5346b4(0x1d2)](_0x41bebc=>{var _0x1716dd=_0x5346b4;_0x41bebc['forEach'](_0x57fd5c=>{var _0x1f33f9=_0x1293;const _0x5c093c=GetOrderArr[_0x1f33f9(0x24f)](_0xad2d8c=>{var _0x9650d5=_0x1f33f9;return _0xad2d8c[_0x9650d5(0x19d)]===_0x57fd5c['id'];});xResults=0x0,xCheckLine=0x0;_0x5c093c[0x0]!=undefined&&(xResults=_0x5c093c[0x0][_0x1f33f9(0x183)],xCheckOrder=parseFloat(xCheckOrder)+parseFloat(_0x5c093c[0x0][_0x1f33f9(0x183)]));_0x21b67f+='<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20center;\x22>'+(_0x51e799+0x1)+_0x1f33f9(0x212)+_0x57fd5c['id']+'\x27)\x22><img\x20src=\x22./img/icon-02.png\x22\x20style=\x22width:20px;\x22></div></th>',_0x21b67f+='<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;\x22><div\x20onclick=\x22DisplayGift(\x27'+_0x57fd5c['id']+_0x1f33f9(0x219)+_0x57fd5c[_0x1f33f9(0x178)]()[_0x1f33f9(0x17b)]+_0x1f33f9(0x19e),_0x21b67f+='<div\x20style=\x22margin-top:4px;\x22>',_0x21b67f+=_0x1f33f9(0x1e2),_0x21b67f+='<select\x20name=\x22OrderGiftID\x22\x20onchange=\x22CalGift()\x22\x20id=\x22OrderGiftID'+_0x51e799+_0x1f33f9(0x1a7)+xResults+_0x1f33f9(0x17e);if(_0x57fd5c['data']()[_0x1f33f9(0x1fc)]==0x1)for(let _0x66560c=0x0;_0x66560c<xNewyearLimit;_0x66560c++){_0x66560c==0x0?_0x21b67f+=_0x1f33f9(0x25e):xResults==_0x66560c*0x32?(xCheckLine=0x1,_0x21b67f+=_0x1f33f9(0x234)+_0x66560c+')\x22\x20value=\x22'+_0x5c093c[0x0][_0x1f33f9(0x183)]+_0x1f33f9(0x214)+_0x5c093c[0x0][_0x1f33f9(0x183)]+_0x1f33f9(0x1c7)):_0x21b67f+=_0x1f33f9(0x234)+_0x66560c+_0x1f33f9(0x221)+_0x66560c*0x32+'\x22>'+_0x66560c*0x32+_0x1f33f9(0x1c7);}else{if(_0x57fd5c[_0x1f33f9(0x178)]()['StockView']==0x2)for(let _0x22ef4d=0x0;_0x22ef4d<xOrderLimit+0x1;_0x22ef4d++){_0x22ef4d==0x0?_0x21b67f+='<option\x20onchange=\x22CalGift(0)\x22\x20value=\x220\x22>รอการสั่ง</option>':xResults==_0x22ef4d?(xCheckLine=0x1,_0x21b67f+=_0x1f33f9(0x234)+_0x22ef4d+_0x1f33f9(0x221)+_0x5c093c[0x0]['OrderGift']+_0x1f33f9(0x214)+_0x5c093c[0x0][_0x1f33f9(0x183)]+_0x1f33f9(0x1c7)):_0x21b67f+=_0x1f33f9(0x234)+_0x22ef4d+_0x1f33f9(0x221)+_0x22ef4d+'\x22>'+_0x22ef4d+'\x20ชิ้น</option>';}}xCalSell+=xResults*_0x57fd5c[_0x1f33f9(0x178)]()['PointRedeem'],_0x21b67f+=_0x1f33f9(0x1ad),_0x21b67f+=_0x1f33f9(0x237)+_0x51e799+_0x1f33f9(0x1a7)+_0x57fd5c[_0x1f33f9(0x178)]()[_0x1f33f9(0x23a)]+_0x1f33f9(0x1c4),_0x21b67f+=_0x1f33f9(0x1f2)+_0x51e799+_0x1f33f9(0x1a7)+xResults*_0x57fd5c[_0x1f33f9(0x178)]()[_0x1f33f9(0x23a)]+_0x1f33f9(0x25c),_0x21b67f+=_0x1f33f9(0x1f0),_0x21b67f+='</tr>',_0x21b67f+='<input\x20type=\x22text\x22\x20id=\x22OrderGiftRefID'+_0x51e799+_0x1f33f9(0x1a7)+_0x57fd5c['id']+_0x1f33f9(0x201),_0x21b67f+='<input\x20type=\x22text\x22\x20id=\x22NameGift'+_0x51e799+'\x22\x20value=\x22'+_0x57fd5c[_0x1f33f9(0x178)]()['StockName']+'\x22\x20hidden>',_0x51e799++,xMaxGift++;}),_0x21b67f+=_0x1716dd(0x190),_0x21b67f+=_0x1716dd(0x176),$(_0x1716dd(0x186))[_0x1716dd(0x243)](_0x21b67f),CalGift();});}var xTotalPrice=0x0;function CalGift(){var _0x387472=_0x1291ce,_0x291d56=0x0,_0x37b9fd='',_0x4d1328=0x0,_0x172ed9=parseFloat(document[_0x387472(0x1f3)](_0x387472(0x206))[_0x387472(0x1c1)]*document[_0x387472(0x1f3)]('OrderGiftID0')[_0x387472(0x1c1)]),_0x4f2317=parseFloat(document['getElementById'](_0x387472(0x17f))['value']*document[_0x387472(0x1f3)]('OrderGiftID1')[_0x387472(0x1c1)]),_0x2c558a=parseFloat(document[_0x387472(0x1f3)](_0x387472(0x1ff))[_0x387472(0x1c1)]*document[_0x387472(0x1f3)](_0x387472(0x1a8))[_0x387472(0x1c1)]),_0x5b94bc=parseFloat(document[_0x387472(0x1f3)]('UnitPrice3')['value']*document['getElementById'](_0x387472(0x1b1))[_0x387472(0x1c1)]),_0xd7e255=parseFloat(document[_0x387472(0x1f3)](_0x387472(0x260))['value']*document['getElementById'](_0x387472(0x1ba))['value']),_0x6b189c=parseFloat(document[_0x387472(0x1f3)](_0x387472(0x23f))[_0x387472(0x1c1)]*document[_0x387472(0x1f3)]('OrderGiftID5')[_0x387472(0x1c1)]),_0x1f9ae=parseFloat(document['getElementById']('UnitPrice6')[_0x387472(0x1c1)]*document['getElementById'](_0x387472(0x209))[_0x387472(0x1c1)]),_0x5c21a9=parseFloat(document[_0x387472(0x1f3)](_0x387472(0x19a))[_0x387472(0x1c1)]*document['getElementById'](_0x387472(0x1a5))[_0x387472(0x1c1)]),_0x222d50=parseFloat(document[_0x387472(0x1f3)](_0x387472(0x247))['value']*document[_0x387472(0x1f3)]('OrderGiftID8')[_0x387472(0x1c1)]),_0xe3c8a5=parseFloat(document[_0x387472(0x1f3)](_0x387472(0x1ef))[_0x387472(0x1c1)]*document[_0x387472(0x1f3)](_0x387472(0x1cd))[_0x387472(0x1c1)]),_0x525670=parseFloat(document['getElementById']('UnitPrice10')['value']*document[_0x387472(0x1f3)](_0x387472(0x229))[_0x387472(0x1c1)]),_0x541f5d=parseFloat(document['getElementById'](_0x387472(0x204))[_0x387472(0x1c1)]*document[_0x387472(0x1f3)](_0x387472(0x172))[_0x387472(0x1c1)]),_0x3ab47d=parseFloat(document[_0x387472(0x1f3)](_0x387472(0x1b0))[_0x387472(0x1c1)]*document[_0x387472(0x1f3)](_0x387472(0x1ac))[_0x387472(0x1c1)]),_0x372ef9=parseFloat(document[_0x387472(0x1f3)](_0x387472(0x25f))[_0x387472(0x1c1)]*document[_0x387472(0x1f3)]('OrderGiftID13')[_0x387472(0x1c1)]),_0x138f88=parseFloat(document[_0x387472(0x1f3)](_0x387472(0x1ca))[_0x387472(0x1c1)]*document[_0x387472(0x1f3)]('OrderGiftID14')['value']),_0x62b617=parseFloat(document[_0x387472(0x1f3)](_0x387472(0x24d))[_0x387472(0x1c1)]*document[_0x387472(0x1f3)](_0x387472(0x1fb))['value']),_0x3c86ed=parseFloat(document[_0x387472(0x1f3)]('OrderGiftID0')[_0x387472(0x1c1)])+parseFloat(document[_0x387472(0x1f3)](_0x387472(0x199))[_0x387472(0x1c1)])+parseFloat(document[_0x387472(0x1f3)](_0x387472(0x1a8))[_0x387472(0x1c1)])+parseFloat(document[_0x387472(0x1f3)](_0x387472(0x1b1))['value'])+parseFloat(document[_0x387472(0x1f3)](_0x387472(0x1ba))['value'])+parseFloat(document[_0x387472(0x1f3)](_0x387472(0x1d6))[_0x387472(0x1c1)])+parseFloat(document[_0x387472(0x1f3)]('OrderGiftID6')[_0x387472(0x1c1)]),_0x26aaaa=parseFloat(document[_0x387472(0x1f3)](_0x387472(0x1a5))[_0x387472(0x1c1)])+parseFloat(document[_0x387472(0x1f3)]('OrderGiftID8')[_0x387472(0x1c1)])+parseFloat(document[_0x387472(0x1f3)](_0x387472(0x1cd))[_0x387472(0x1c1)])+parseFloat(document['getElementById'](_0x387472(0x229))[_0x387472(0x1c1)])+parseFloat(document['getElementById'](_0x387472(0x172))[_0x387472(0x1c1)])+parseFloat(document['getElementById'](_0x387472(0x1ac))[_0x387472(0x1c1)])+parseFloat(document['getElementById']('OrderGiftID13')['value']),_0x1ced7f=parseFloat(document['getElementById'](_0x387472(0x1ed))[_0x387472(0x1c1)])+parseFloat(document[_0x387472(0x1f3)](_0x387472(0x1fb))[_0x387472(0x1c1)]);xTotalUnitPrice=_0x3c86ed+_0x26aaaa+_0x1ced7f;var _0x16226d=parseFloat(_0x172ed9)+parseFloat(_0x4f2317)+parseFloat(_0x2c558a)+parseFloat(_0x5b94bc)+parseFloat(_0xd7e255)+parseFloat(_0x6b189c),_0xd39633=parseFloat(_0x1f9ae)+parseFloat(_0x5c21a9)+parseFloat(_0x222d50)+parseFloat(_0xe3c8a5)+parseFloat(_0x525670)+parseFloat(_0x541f5d),_0x661f3a=parseFloat(_0x3ab47d)+parseFloat(_0x372ef9)+parseFloat(_0x138f88)+parseFloat(_0x62b617);xTotalPrice=_0x16226d+_0xd39633+_0x661f3a,xBalance=xBMAllocated-xTotalPrice,$('#SumUnitPrice0')[_0x387472(0x243)](numberWithCommas(_0x172ed9)),$(_0x387472(0x200))['html'](numberWithCommas(_0x4f2317)),$(_0x387472(0x1be))['html'](numberWithCommas(_0x2c558a)),$('#SumUnitPrice3')[_0x387472(0x243)](numberWithCommas(_0x5b94bc)),$(_0x387472(0x1bb))[_0x387472(0x243)](numberWithCommas(_0xd7e255)),$('#SumUnitPrice5')[_0x387472(0x243)](numberWithCommas(_0x6b189c)),$(_0x387472(0x254))['html'](numberWithCommas(_0x1f9ae)),$(_0x387472(0x1c5))[_0x387472(0x243)](numberWithCommas(_0x5c21a9)),$(_0x387472(0x1e1))['html'](numberWithCommas(_0x222d50)),$('#SumUnitPrice9')[_0x387472(0x243)](numberWithCommas(_0xe3c8a5)),$(_0x387472(0x185))['html'](numberWithCommas(_0x525670)),$(_0x387472(0x1a3))[_0x387472(0x243)](numberWithCommas(_0x541f5d)),$(_0x387472(0x21c))[_0x387472(0x243)](numberWithCommas(_0x3ab47d)),$(_0x387472(0x24c))[_0x387472(0x243)](numberWithCommas(_0x372ef9)),$('#SumUnitPrice14')['html'](numberWithCommas(_0x138f88)),$(_0x387472(0x19c))[_0x387472(0x243)](numberWithCommas(_0x62b617)),_0x37b9fd+=_0x387472(0x176),_0x37b9fd+=_0x387472(0x251),_0x37b9fd+='<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>งบประมาณที่ได้รับ</div><input\x20type=\x22text\x22\x20value=\x22'+numberWithCommas(xBMAllocated)+_0x387472(0x177),_0x37b9fd+=_0x387472(0x196)+numberWithCommas(xTotalPrice)+_0x387472(0x23b);xBalance>=0x0?_0x37b9fd+='<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>ยอดงบคงเหลือ</div><input\x20type=\x22text\x22\x20value=\x22'+numberWithCommas(xBalance)+_0x387472(0x1b3):_0x37b9fd+=_0x387472(0x17d)+numberWithCommas(xBalance)+_0x387472(0x20d);_0x37b9fd+=_0x387472(0x1ab),_0x37b9fd+=_0x387472(0x176);var _0x5ef777=xBMAllocated-xTotalPrice;if(xBMAllocated-xTotalPrice>0x0){_0x37b9fd+=_0x387472(0x1c9);if(xBMStatus==0x0||xBMStatus==0x1)xTotalUnitPrice!=0x0?(xTotalUnitPrice!=0x0&&(_0x37b9fd+=_0x387472(0x240)+gID+'\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ยกเลิก<br>รายการสั่งซื้อ</div>'),_0x37b9fd+=_0x387472(0x238)+gID+_0x387472(0x1fd)):(_0x37b9fd+=_0x387472(0x24e),_0x37b9fd+=_0x387472(0x220));else{if(xBMStatus==0x2)_0x37b9fd+=_0x387472(0x173)+gID+'\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายละเอียด<br>รายการสั่งซื้อ</div>',_0x37b9fd+=_0x387472(0x220),_0x37b9fd+=_0x387472(0x259);else{if(xBMStatus==0x3)xTotalUnitPrice!=0x0&&(_0x37b9fd+=_0x387472(0x238)+gID+'\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>บันทึกดร๊าฟ<br>รายการสั่งซื้อ</div>',_0x37b9fd+=_0x387472(0x215)+zZoneMemoToBM+'</div>');else xBMStatus==0x9?(_0x37b9fd+=_0x387472(0x1b7)+gID+'\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายการสั่งซื้อ<br>ของขวัญปีใหม่</div>',_0x37b9fd+=_0x387472(0x250)):(_0x37b9fd+=_0x387472(0x173)+gID+_0x387472(0x25b),_0x37b9fd+=_0x387472(0x20a));}}_0x37b9fd+=_0x387472(0x1ab);}else alert('ขณะนี้คุณได้ทำคำสั่งซื้อของขวัญปีใหม่\x0aจากงบประมาณที่ได้รับ\x20'+numberWithCommas(xBMAllocated)+_0x387472(0x20b)+numberWithCommas(xTotalPrice)+_0x387472(0x232)+numberWithCommas(_0x5ef777)+_0x387472(0x1d9)),_0x37b9fd+=_0x387472(0x1fa);_0x37b9fd+=_0x387472(0x224)+xBMName+_0x387472(0x244)+xBranchName+_0x387472(0x18a),$('#TotalGift')['html'](_0x37b9fd);}function DisplayGift(_0x3f767e){var _0x4066de=_0x1291ce,_0x5706b5='';dbGiftStock[_0x4066de(0x1ee)](firebase[_0x4066de(0x242)][_0x4066de(0x1c8)][_0x4066de(0x18b)](),'==',_0x3f767e)[_0x4066de(0x1a2)]()[_0x4066de(0x1d2)](_0x10e0fa=>{var _0x3c3eaa=_0x4066de;_0x10e0fa[_0x3c3eaa(0x1b5)](_0x332e33=>{var _0xf1156f=_0x3c3eaa;_0x5706b5+='<center><div\x20class=\x22btn-t3\x22\x20style=\x22margin-top:25px;\x22><b>รายละเอียดของขวัญปีใหม่</b></div>',_0x5706b5+=_0xf1156f(0x18d)+_0x332e33[_0xf1156f(0x178)]()[_0xf1156f(0x194)]+_0xf1156f(0x22d),_0x5706b5+='<div\x20style=\x22font-weight:600;\x22>'+_0x332e33[_0xf1156f(0x178)]()['StockName']+_0xf1156f(0x1ab),_0x5706b5+='<div\x20style=\x22font-weight:400;\x20text-align:left;\x20padding-top:10px;\x22>'+_0x332e33[_0xf1156f(0x178)]()[_0xf1156f(0x23c)]+_0xf1156f(0x1ab),_0x5706b5+='<div\x20style=\x22font-weight:400;padding-top:10px;\x22>ราคาขายต่อชิ้น\x20<b>'+_0x332e33['data']()[_0xf1156f(0x23a)]+'\x20บาท</b></div>',_0x5706b5+='',_0x5706b5+='',_0x5706b5+=_0xf1156f(0x176),_0x5706b5+=_0xf1156f(0x1e5);}),$(_0x3c3eaa(0x21e))[_0x3c3eaa(0x243)](_0x5706b5);}),document[_0x4066de(0x1f3)](_0x4066de(0x22b))[_0x4066de(0x258)][_0x4066de(0x1de)]='block';}function DeleteAllOrder(_0x305b94){var _0x38346e=_0x1291ce;dbGiftOrder[_0x38346e(0x1ee)](_0x38346e(0x1cb),'==',_0x305b94)[_0x38346e(0x1a2)]()[_0x38346e(0x1d2)](_0x22a379=>{var _0x5c3393=_0x38346e;_0x22a379[_0x5c3393(0x1b5)](_0x337b83=>{var _0x2dfd39=_0x5c3393;dbGiftOrder[_0x2dfd39(0x1c2)]()[_0x2dfd39(0x1f7)](),DeleteRefID(_0x337b83['id']);}),console['log']('gID='+gID);var _0x53545c=0x3e8;setTimeout(function(){var _0x419c57=_0x5c3393;dbNewyearData[_0x419c57(0x1c2)](gID)[_0x419c57(0x182)]({'BMStatus':0x0,'TotalOrders':0x0,'UseBudget':0x0,'BMBalance':0x0});},_0x53545c);var _0x27f7ff=0x7d0;setTimeout(function(){var _0xa210aa=_0x5c3393;alert(_0xa210aa(0x256)),location[_0xa210aa(0x235)]='ordergift.html?gid='+gID;},_0x27f7ff);});}function DeleteRefID(_0x5cbbfa){var _0x42550a=_0x1291ce;dbGiftOrder[_0x42550a(0x1c2)](_0x5cbbfa)['delete'](),console['log'](_0x5cbbfa);}function ViewOrder(_0x339045){var _0x244de7=_0x1291ce,_0x582d06='',_0x3507e7=0x0,_0x124bcf=0x0;_0x582d06+=_0x244de7(0x18e),_0x582d06+='<div\x20style=\x22line-height:1.3;\x20text-align:left;\x20font-weight:600;\x22>สาขา\x20:\x20'+xBranchName+'<br>BM\x20:\x20'+xBMName+_0x244de7(0x1ab),_0x582d06+=_0x244de7(0x1da),_0x582d06+=_0x244de7(0x20e),_0x582d06+=_0x244de7(0x1e0),dbGiftOrder[_0x244de7(0x1ee)](_0x244de7(0x1cb),'==',_0x339045)['orderBy'](_0x244de7(0x17b),_0x244de7(0x246))['get']()[_0x244de7(0x1d2)](_0x29d0ab=>{var _0x396f37=_0x244de7;_0x29d0ab[_0x396f37(0x1b5)](_0x2a421c=>{var _0x57d2fe=_0x396f37;_0x3507e7=_0x3507e7+_0x2a421c['data']()[_0x57d2fe(0x183)],_0x124bcf=_0x124bcf+_0x2a421c[_0x57d2fe(0x178)]()[_0x57d2fe(0x183)]*_0x2a421c[_0x57d2fe(0x178)]()[_0x57d2fe(0x23a)],_0x582d06+=_0x57d2fe(0x239)+_0x2a421c[_0x57d2fe(0x178)]()['StockName']+'</th>',_0x582d06+=_0x57d2fe(0x1ce)+_0x2a421c['data']()[_0x57d2fe(0x183)]+'</td>',_0x582d06+=_0x57d2fe(0x1ce)+numberWithCommas(_0x2a421c[_0x57d2fe(0x178)]()['OrderGift']*_0x2a421c[_0x57d2fe(0x178)]()['PointRedeem'])+_0x57d2fe(0x22e);}),_0x582d06+=_0x396f37(0x210),_0x582d06+='<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;background:#73a0f4;\x22>'+addCommas(_0x3507e7)+_0x396f37(0x1f0),_0x582d06+=_0x396f37(0x1d7)+numberWithCommas(_0x124bcf)+_0x396f37(0x22e),_0x582d06+='<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#e831e8;\x22>'+numberWithCommas(xBMAllocated)+'</td></tr>',_0x582d06+=_0x396f37(0x187)+numberWithCommas(_0x124bcf)+_0x396f37(0x22e),_0x582d06+='<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณคงเหลือ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#0056ff;\x22>'+numberWithCommas(xBMAllocated-_0x124bcf)+'</td></tr>',_0x582d06+='</tbody></table>',_0x582d06+='<div\x20class=\x22btn-z0\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>ปิดหน้าต่าง<br>รายการนี้</div>',$('#DisplayGift')[_0x396f37(0x243)](_0x582d06);}),document[_0x244de7(0x1f3)](_0x244de7(0x22b))[_0x244de7(0x258)]['display']=_0x244de7(0x181);}function SaveOrder(){var _0xdbc354=_0x1291ce;LoadDetail();var _0xcc756e=0x0,_0x38ce11=0x0,_0x365ab9='',_0x190d5e=0x0,_0x1b830b='';console['log'](xMaxGift);for(let _0x557bd1=0x0;_0x557bd1<xMaxGift;_0x557bd1++){var _0x25e6b8=document['getElementById'](_0xdbc354(0x1c3)+_0x557bd1)[_0xdbc354(0x1c1)]*document['getElementById'](_0xdbc354(0x1b4)+_0x557bd1)['value'];SaveGift(document[_0xdbc354(0x1f3)](_0xdbc354(0x174)+_0x557bd1)[_0xdbc354(0x1c1)],document[_0xdbc354(0x1f3)]('UnitPrice'+_0x557bd1)['value'],document['getElementById'](_0xdbc354(0x1c3)+_0x557bd1)[_0xdbc354(0x1c1)],_0x25e6b8,document['getElementById'](_0xdbc354(0x222)+_0x557bd1)[_0xdbc354(0x1c1)]);}}var xSumMoney=0x0;function SaveGift(_0x5e5712,_0x297e43,_0x36dd75,_0x25068c,_0x19e632){var _0x3c83f6=_0x1291ce;document[_0x3c83f6(0x1f3)]('ShowNav')[_0x3c83f6(0x258)][_0x3c83f6(0x1de)]=_0x3c83f6(0x18c),LoadDetail(),xSumMoney=0x0;var _0x5f451f='',_0x2c7c00='',_0x2dd8f4=0x0;xSumMoney=xSumMoney+xTotalPrice,dbGiftOrder[_0x3c83f6(0x1ee)]('RefID','==',gID)[_0x3c83f6(0x1ee)]('RefGift','==',_0x5e5712)[_0x3c83f6(0x1a2)]()[_0x3c83f6(0x1d2)](_0xdc6e75=>{var _0x2a5694=_0x3c83f6;_0xdc6e75[_0x2a5694(0x1b5)](_0x13d42f=>{_0x2c7c00=_0x13d42f['id'],_0x2dd8f4=0x1;});if(_0x36dd75==0x0)dbGiftOrder[_0x2a5694(0x1c2)](_0x2c7c00)[_0x2a5694(0x1f7)]();else{if(_0x2dd8f4==0x1){var _0x2f5fd4=parseFloat(_0x36dd75*_0x297e43);dbGiftOrder[_0x2a5694(0x1c2)](_0x2c7c00)[_0x2a5694(0x182)]({'OrderGift':parseFloat(_0x36dd75),'OrderPrice':parseFloat(_0x36dd75*_0x297e43),'PointRedeem':parseFloat(_0x297e43)});}else dbGiftOrder['add']({'RefID':gID,'RefGift':_0x5e5712,'EmpID':xBMEmpID,'EmpName':xBMName,'EmpBR':xBranchName,'EmpZone':xZone,'EmpRH':xRH,'OrderGift':parseFloat(_0x36dd75),'OrderPrice':parseFloat(_0x36dd75*_0x297e43),'PointRedeem':parseFloat(_0x297e43),'StockName':_0x19e632});}});var _0x141706=0x0,_0x4d8c66=0x0;_0x5f451f+=_0x3c83f6(0x233),_0x5f451f+=_0x3c83f6(0x203),_0x5f451f+=_0x3c83f6(0x20e),_0x5f451f+='<th\x20scope=\x22col\x22>รายการ</th><th\x20scope=\x22col\x22>จำนวน</th><th\x20scope=\x22col\x22>ราคา</th></tr></thead><tbody>';for(let _0x14ca3f=0x0;_0x14ca3f<xMaxGift;_0x14ca3f++){document[_0x3c83f6(0x1f3)](_0x3c83f6(0x1c3)+_0x14ca3f)[_0x3c83f6(0x1c1)]!=0x0&&(_0x5f451f+=_0x3c83f6(0x239)+document['getElementById'](_0x3c83f6(0x222)+_0x14ca3f)[_0x3c83f6(0x1c1)]+_0x3c83f6(0x192),_0x5f451f+=_0x3c83f6(0x1ce)+document[_0x3c83f6(0x1f3)](_0x3c83f6(0x1c3)+_0x14ca3f)[_0x3c83f6(0x1c1)]+_0x3c83f6(0x1f0),_0x5f451f+=_0x3c83f6(0x1ce)+numberWithCommas(document[_0x3c83f6(0x1f3)]('OrderGiftID'+_0x14ca3f)[_0x3c83f6(0x1c1)]*document['getElementById'](_0x3c83f6(0x1b4)+_0x14ca3f)[_0x3c83f6(0x1c1)])+_0x3c83f6(0x22e),_0x4d8c66++);}_0x5f451f+=_0x3c83f6(0x245)+numberWithCommas(xSumMoney)+_0x3c83f6(0x22e),_0x5f451f+=_0x3c83f6(0x1f6)+numberWithCommas(xBMAllocated)+_0x3c83f6(0x22e),_0x5f451f+=_0x3c83f6(0x1cf)+numberWithCommas(xBMAllocated-xSumMoney)+'</td></tr></tbody></table>',_0x5f451f+='<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>รายละเอียดเพิ่มเติม</div><div\x20class=\x22clr\x22></div>',_0x5f451f+=_0x3c83f6(0x1eb)+zBM_Address+'</textarea></center></div>',_0x5f451f+=_0x3c83f6(0x20f)+zBM_Phone+'\x22\x20style=\x22text-align:left;\x22></div>',_0x5f451f+='<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกรหัสพนักงาน)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpID_Staff1\x22\x20value=\x22'+zEmpID_Staff1+_0x3c83f6(0x216),_0x5f451f+=_0x3c83f6(0x179)+zEmpName_Staff1+_0x3c83f6(0x216),_0x5f451f+=_0x3c83f6(0x1af)+zPhone_Staff1+'\x22\x20style=\x22text-align:left;\x22></div>',_0x5f451f+=_0x3c83f6(0x21d)+zEmpID_Staff2+_0x3c83f6(0x216),_0x5f451f+='<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกชื่อ-นามสกุล)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpName_Staff2\x22\x20value=\x22'+zEmpName_Staff2+_0x3c83f6(0x216),_0x5f451f+=_0x3c83f6(0x1b9)+zPhone_Staff2+_0x3c83f6(0x216),_0x5f451f+=_0x3c83f6(0x24b)+gID+_0x3c83f6(0x1b8),_0x5f451f+=_0x3c83f6(0x241),_0x5f451f+='<div\x20class=\x22clr\x22></div>',_0x5f451f+=_0x3c83f6(0x19b)+gID+_0x3c83f6(0x23d),$(_0x3c83f6(0x1c6))['html'](_0x5f451f),$('#idSendZoneApprove')['addClass'](_0x3c83f6(0x236));var _0x421f5d='บันทึกรายการแก้ไขรายการ\x20'+dateString+_0x3c83f6(0x189),_0x169740=0x3e8;setTimeout(function(){var _0x208321=_0x3c83f6;dbNewyearData[_0x208321(0x1c2)](gID)[_0x208321(0x182)]({'BMStatus':0x1,'BMBalance':parseFloat(xBMAllocated-xSumMoney),'TotalOrders':parseFloat(_0x4d8c66),'TotalOrders':parseFloat(xTotalUnitPrice),'UseBudget':parseFloat(xTotalPrice),'BM_Memo':_0x421f5d});},_0x169740),document[_0x3c83f6(0x1f3)](_0x3c83f6(0x255))[_0x3c83f6(0x258)][_0x3c83f6(0x1de)]=_0x3c83f6(0x181);}function SaveToZone(){var _0x3d178a=_0x1291ce,_0x404d8d=0x0,_0x48822f=0x0;dbNewyearData['doc'](gID)[_0x3d178a(0x182)]({'BMStatus':0x2}),str+=_0x3d178a(0x1f1),str+=_0x3d178a(0x203),str+=_0x3d178a(0x20e),str+=_0x3d178a(0x1e0);for(let _0x47145e=0x0;_0x47145e<xMaxGift;_0x47145e++){document['getElementById'](_0x3d178a(0x1c3)+_0x47145e)[_0x3d178a(0x1c1)]!=0x0&&(str+=_0x3d178a(0x239)+document['getElementById'](_0x3d178a(0x222)+_0x47145e)['value']+'</th>',str+=_0x3d178a(0x1ce)+document[_0x3d178a(0x1f3)](_0x3d178a(0x1c3)+_0x47145e)[_0x3d178a(0x1c1)]+'</td>',str+=_0x3d178a(0x1ce)+numberWithCommas(document['getElementById'](_0x3d178a(0x1c3)+_0x47145e)[_0x3d178a(0x1c1)]*document[_0x3d178a(0x1f3)](_0x3d178a(0x1b4)+_0x47145e)[_0x3d178a(0x1c1)])+_0x3d178a(0x22e),_0x48822f++);}str+=_0x3d178a(0x1e3)+numberWithCommas(xSumMoney)+_0x3d178a(0x22e),str+='<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>'+numberWithCommas(xBMAllocated)+_0x3d178a(0x22e),str+=_0x3d178a(0x1cf)+numberWithCommas(xBMAllocated-xSumMoney)+_0x3d178a(0x195),str+=_0x3d178a(0x1f4),str+='<center><div\x20class=\x22btn-t1\x22\x20onclick=\x22GotoOrder()\x22>ปิดหน้าต่างนี้</div></center>',$(_0x3d178a(0x1bc))[_0x3d178a(0x243)](str),document['getElementById'](_0x3d178a(0x17c))[_0x3d178a(0x258)]['display']='block';}function GotoOrder(){var _0x9f37ed=_0x1291ce;location[_0x9f37ed(0x235)]=_0x9f37ed(0x1c0);}function _0x1293(_0x1669b3,_0xf43985){var _0x99bf5e=_0x99bf();return _0x1293=function(_0x12936c,_0x4e9a21){_0x12936c=_0x12936c-0x171;var _0x3db3a1=_0x99bf5e[_0x12936c];return _0x3db3a1;},_0x1293(_0x1669b3,_0xf43985);}function SaveDetail(){var _0x583500=_0x1291ce,_0x4c7672=document[_0x583500(0x1f3)](_0x583500(0x1f5))[_0x583500(0x1c1)],_0x1f10ac=document['getElementById'](_0x583500(0x1bf))[_0x583500(0x1c1)],_0x462eee=document['getElementById'](_0x583500(0x198))[_0x583500(0x1c1)],_0x5a7d43=document['getElementById']('txtEmpName_Staff1')['value'],_0x566e55=document['getElementById'](_0x583500(0x1e7))[_0x583500(0x1c1)],_0x48a2ef=document[_0x583500(0x1f3)](_0x583500(0x217))[_0x583500(0x1c1)],_0x1ba3a=document[_0x583500(0x1f3)]('txtEmpName_Staff2')[_0x583500(0x1c1)],_0x2e15a9=document[_0x583500(0x1f3)]('txtPhone_Staff2')[_0x583500(0x1c1)];_0x4c7672==''||_0x1f10ac==''||_0x462eee==''||_0x5a7d43==''||_0x566e55==''||_0x48a2ef==''||_0x1ba3a==''||_0x2e15a9==''?alert(_0x583500(0x21f)):(dbNewyearData['doc'](gID)[_0x583500(0x182)]({'BM_Address':document[_0x583500(0x1f3)](_0x583500(0x1f5))[_0x583500(0x1c1)],'BM_Phone':document[_0x583500(0x1f3)](_0x583500(0x1bf))[_0x583500(0x1c1)],'EmpID_Staff1':document[_0x583500(0x1f3)]('txtEmpID_Staff1')[_0x583500(0x1c1)],'EmpName_Staff1':document[_0x583500(0x1f3)](_0x583500(0x226))['value'],'Phone_Staff1':document['getElementById'](_0x583500(0x1e7))[_0x583500(0x1c1)],'EmpID_Staff2':document['getElementById']('txtEmpID_Staff2')[_0x583500(0x1c1)],'EmpName_Staff2':document[_0x583500(0x1f3)]('txtEmpName_Staff2')['value'],'Phone_Staff2':document[_0x583500(0x1f3)](_0x583500(0x1a9))[_0x583500(0x1c1)]}),alert('ระบบได้ทำการบันทึกรายการนี้เรียบร้อยแล้ว\x20หากไม่มีการแก้ไขรายการให้ทำการกดปุ่ม\x20ส่งคำขอให้โซนอนุมัติ\x20ซึ่งจะมีผลให้สาขาไม่สามารถทำการแก้ไขรายการได้แล้ว'),LoadDetail(),document[_0x583500(0x1f3)](_0x583500(0x213))['style'][_0x583500(0x1de)]='block');}function addCommas(_0x20822f){var _0x44f5a8=_0x1291ce;_0x20822f+='',x=_0x20822f[_0x44f5a8(0x1dc)]('.'),x1=x[0x0],x2=x[_0x44f5a8(0x211)]>0x1?'.'+x[0x1]:'';var _0x3c09ee=/(\d+)(\d{3})/;while(_0x3c09ee[_0x44f5a8(0x1ec)](x1)){x1=x1['replace'](_0x3c09ee,'$1'+','+'$2');}return x1+x2;}function numberWithCommas(_0x19b6a0){var _0x1ab60d=_0x1291ce,_0x4472ce=_0x19b6a0,_0x5a13b0=parseFloat(_0x4472ce)[_0x1ab60d(0x21a)](0x2);return formattedString=_0x5a13b0[_0x1ab60d(0x1df)]()[_0x1ab60d(0x1a6)](/\B(?=(\d{3})+(?!\d))/g,',');}function CloseAll(){var _0x5f05b5=_0x1291ce;document['getElementById']('ShowNav')[_0x5f05b5(0x258)][_0x5f05b5(0x1de)]='block',document[_0x5f05b5(0x1f3)]('id01')[_0x5f05b5(0x258)][_0x5f05b5(0x1de)]=_0x5f05b5(0x18c),document[_0x5f05b5(0x1f3)](_0x5f05b5(0x17c))[_0x5f05b5(0x258)]['display']=_0x5f05b5(0x18c),document[_0x5f05b5(0x1f3)](_0x5f05b5(0x22b))[_0x5f05b5(0x258)]['display']=_0x5f05b5(0x18c);}
